<!DOCTYPE html><!--5Swj18oapgqGqSZX8fol6--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/a68d47cca58670f5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/a339dcc3b98340b3.js"/><script src="/_next/static/chunks/bfffc7ec77d3b06a.js" async=""></script><script src="/_next/static/chunks/b9cfbaaba1fd82be.js" async=""></script><script src="/_next/static/chunks/c540f39c8777f86f.js" async=""></script><script src="/_next/static/chunks/turbopack-a8b0537048952335.js" async=""></script><script src="/_next/static/chunks/4cc5a908347f559b.js" async=""></script><script src="/_next/static/chunks/26ca110782d86623.js" async=""></script><script src="/_next/static/chunks/81f0f13d25d49d65.js" async=""></script><script src="/_next/static/chunks/c23263069b7f7ba3.js" async=""></script><script src="/_next/static/chunks/2425b678dfc0c3cf.js" async=""></script><title>Security Score - Sentinel Docs</title><meta name="description" content="Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard."/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="min-h-screen antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><nav class="sticky top-0 z-50 w-full border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-16"><div class="flex items-center gap-8"><a class="flex items-center gap-2.5 group" href="/"><div class="w-8 h-8 rounded-lg bg-gradient-to-br from-sentinel-400 to-sentinel-600 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield text-white"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><span class="font-bold text-lg tracking-tight">Sentinel</span></a><div class="hidden md:flex items-center gap-6"><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors flex items-center gap-1.5" href="/docs/getting-started"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Docs</a><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors" href="/docs/api-reference">API</a></div></div><div class="flex items-center gap-3"><div class="hidden sm:block"><button class="flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm text-gray-500 dark:text-gray-400 w-64"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><span class="flex-1 text-left">Search docs...</span><kbd class="hidden sm:flex items-center gap-0.5 text-[10px] font-mono text-gray-400 dark:text-gray-500 bg-gray-200 dark:bg-gray-800 px-1.5 py-0.5 rounded"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-command"><path d="M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"></path></svg> K</kbd></button></div><div class="w-9 h-9"></div><a href="https://github.com/MUKE-coder/sentinel" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github text-gray-600 dark:text-gray-400"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></nav><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><button class="lg:hidden mb-4 p-2 rounded-lg border border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-900"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><div class="flex gap-10"><aside class="hidden lg:block w-64 flex-shrink-0"><div class="sticky top-20 overflow-y-auto max-h-[calc(100vh-5rem)] pb-10 pr-4"><nav class="space-y-6"><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Getting Started</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/getting-started">Introduction</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/configuration">Configuration</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Security</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/waf">WAF</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/rate-limiting">Rate Limiting</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/auth-shield">Auth Shield</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/security-headers">Security Headers</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Intelligence</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/threat-intelligence">Threat Intelligence</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/anomaly-detection">Anomaly Detection</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors bg-sentinel-50 dark:bg-sentinel-950/50 text-sentinel-600 dark:text-sentinel-400 font-medium" href="/docs/security-score">Security Score</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Monitoring</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/the-dashboard">Dashboard</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/performance">Performance</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/alerting">Alerting</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Data</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/audit-logging">Audit Logging</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/ai-analysis">AI Analysis</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/compliance-reports">Compliance Reports</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Reference</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/api-reference">API Reference</a></li></ul></div></nav></div></aside><main class="min-w-0 flex-1 prose-docs"><h1>Security Score</h1><p>The Security Score is a weighted composite metric (0-100) that measures your application&#x27;s overall security posture at a glance. It aggregates five dimensions of your Sentinel configuration and runtime behavior into a single number, graded from <strong>A</strong> (90-100) to <strong>F</strong> (below 60). The score updates automatically in the background and surfaces actionable recommendations to improve your defenses.</p><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Always Active</p><div class="text-sm text-gray-700 dark:text-gray-300">The score engine runs automatically once Sentinel is mounted. There is no separate configuration to enable it. It uses the main <code>Config</code> you pass to<!-- --> <code>sentinel.Mount</code> to evaluate which features are active and how well they are configured.</div></div></div></div><h2 id="dimensions">Score Dimensions</h2><p>The overall score is a weighted sum of five sub-scores. Each dimension evaluates a different aspect of your security posture:</p><table><thead><tr><th>Dimension</th><th>Weight</th><th>What It Measures</th></tr></thead><tbody><tr><td><strong>Threat Activity</strong></td><td>30%</td><td>How many threats were detected in the last 24 hours and how severe they are. Fewer and lower-severity threats yield a higher score. A bonus is applied when your block rate exceeds 90%.</td></tr><tr><td><strong>Auth Security</strong></td><td>20%</td><td>Whether you have changed the default dashboard password and secret key, and whether Auth Shield is enabled. Using defaults penalizes this sub-score.</td></tr><tr><td><strong>Response Posture</strong></td><td>20%</td><td>The ratio of blocked threats to total threats. A 100% block rate yields a perfect sub-score. If the WAF is in log-only mode, unblocked threats lower this dimension.</td></tr><tr><td><strong>Header Compliance</strong></td><td>15%</td><td>How many recommended security headers are configured: <code>X-Frame-Options</code>,<!-- --> <code>Referrer-Policy</code>, <code>Content-Security-Policy</code>, and<!-- --> <code>Strict-Transport-Security</code>. <code>X-Content-Type-Options</code> is always set by default.</td></tr><tr><td><strong>Rate Limiting</strong></td><td>15%</td><td>Whether rate limiting is enabled and how comprehensively it is configured: per-IP, per-user, and per-route limits each contribute to this sub-score.</td></tr></tbody></table><h2 id="how-it-works">How It&#x27;s Computed</h2><p>Sentinel launches a background goroutine when <code>Mount</code> is called. The<!-- --> <code>ScoreEngine</code> computes the score immediately on startup and then recomputes it every 5 minutes. Each cycle performs the following steps:</p><ol><li><strong>Query threat stats</strong> — The engine calls <code>GetThreatStats</code> on the storage layer with a 24-hour window to retrieve counts by severity and block status.</li><li><strong>Evaluate each dimension</strong> — Five dedicated functions compute a sub-score (0-100) for each dimension using the threat stats and the current <code>Config</code>.</li><li><strong>Weighted aggregation</strong> — Sub-scores are multiplied by their weights and summed to produce the overall score.</li><li><strong>Grade assignment</strong> — The overall score is mapped to a letter grade.</li><li><strong>Recommendation generation</strong> — The engine inspects each sub-score and the config to produce actionable recommendations for any weak areas.</li><li><strong>Persist</strong> — The result is saved to storage via<!-- --> <code>SaveSecurityScore</code> so the dashboard and API can read it without recomputing.</li></ol><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">intelligence/security_score.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ComputeScore calculates the security score based on current state.</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">ScoreEngine</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">ComputeScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SecurityScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(72, 118, 214)">error</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    stats</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">store</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">GetThreatStats</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">24</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Hour</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(12, 150, 155)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> err</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    threatScore   </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">computeThreatActivityScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">stats</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// weight: 30%</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    authScore     </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">computeAuthSecurityScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// weight: 20%</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">    responseScore </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">computeResponsePostureScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">stats</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// weight: 20%</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    headerScore   </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">computeHeaderComplianceScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// weight: 15%</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">    rateLimitScore </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">computeRateLimitCoverageScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// weight: 15%</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">    overall </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">int</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">float64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">threatScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token number" style="color:rgb(170, 9, 130)">0.30</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">float64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">authScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token number" style="color:rgb(170, 9, 130)">0.20</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">float64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">responseScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token number" style="color:rgb(170, 9, 130)">0.20</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">float64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">headerScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token number" style="color:rgb(170, 9, 130)">0.15</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">+</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">float64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">rateLimitScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token number" style="color:rgb(170, 9, 130)">0.15</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">    grade </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">scoreToGrade</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">overall</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">    recommendations </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">generateRecommendations</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">        threatScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> authScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> responseScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain">        headerScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> rateLimitScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">    score </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SecurityScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">        Overall</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> overall</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain">        Grade</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   grade</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ... sub-scores, computed_at, recommendations</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">32</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">33</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">34</span><span class="token plain">    e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">store</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">SaveSecurityScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> score</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">35</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> score</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">36</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Grading Scale</h3><table><thead><tr><th>Score Range</th><th>Grade</th><th>Interpretation</th></tr></thead><tbody><tr><td>90 - 100</td><td><strong>A</strong></td><td>Excellent. All major features enabled and well-configured.</td></tr><tr><td>80 - 89</td><td><strong>B</strong></td><td>Good. Minor improvements available.</td></tr><tr><td>70 - 79</td><td><strong>C</strong></td><td>Fair. Some important features are missing or misconfigured.</td></tr><tr><td>60 - 69</td><td><strong>D</strong></td><td>Poor. Significant gaps in your security posture.</td></tr><tr><td>0 - 59</td><td><strong>F</strong></td><td>Failing. Critical features are disabled or defaults are unchanged.</td></tr></tbody></table><h2 id="sub-score-details">Sub-Score Details</h2><h3>Threat Activity (30%)</h3><p>Starts at 100 and deducts points for each threat detected in the last 24 hours. Deductions scale by severity: critical threats cost 20 points each, high costs 10, medium costs 5, and low costs 2. A bonus of +10 is applied when over 90% of threats are blocked, or +5 when over 50% are blocked. With no threats in the window, the sub-score is a perfect 100.</p><h3>Auth Security (20%)</h3><p>Starts at a base of 50. Changing the default dashboard password from<!-- --> <code>&quot;sentinel&quot;</code> adds 20 points. Changing the default secret key adds another 20. Enabling Auth Shield adds 10. A fully configured authentication setup scores 100.</p><h3>Response Posture (20%)</h3><p>Measures the percentage of threats that were actively blocked. If all detected threats are blocked (WAF in block mode), the sub-score is 100. If no threats have been detected, the baseline score is 80. Running the WAF in log-only mode typically lowers this dimension because threats are recorded but not blocked.</p><h3>Header Compliance (15%)</h3><p>Counts how many of the five recommended security headers are configured:<!-- --> <code>X-Content-Type-Options</code> (always on), <code>X-Frame-Options</code>,<!-- --> <code>Referrer-Policy</code>, <code>Content-Security-Policy</code>, and<!-- --> <code>Strict-Transport-Security</code>. Each configured header contributes equally. If security headers are explicitly disabled, the sub-score is 0.</p><h3>Rate Limiting (15%)</h3><p>Awards a base of 30 points for having rate limiting enabled. Additional points come from configuring per-IP limits (+30), per-user limits (+20), and per-route limits (+20). Disabling rate limiting entirely results in a sub-score of 0.</p><div class="my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500"><path d="M21.801 10A10 10 0 1 1 17 3.335"></path><path d="m9 11 3 3L22 4"></path></svg><div><p class="font-semibold text-sm mb-1 text-green-800 dark:text-green-300">Maximizing Your Score</p><div class="text-sm text-gray-700 dark:text-gray-300">To reach an A grade: enable WAF in block mode, enable rate limiting with per-IP and per-user limits, configure all five security headers, change the default dashboard password and secret key, and enable Auth Shield. These settings cover all five dimensions.</div></div></div></div><h2 id="recommendations">Recommendations</h2><p>After computing the score, the engine generates a list of actionable recommendations based on which features are disabled or which sub-scores fall below their thresholds. Each recommendation includes a title, description, impact level, and the category it addresses.</p><table><thead><tr><th>Condition</th><th>Recommendation</th><th>Impact</th><th>Category</th></tr></thead><tbody><tr><td>WAF disabled</td><td>Enable WAF to protect against common attacks</td><td>High</td><td><code>threat_activity</code></td></tr><tr><td>WAF in log-only mode</td><td>Set WAF to block mode to actively prevent attacks</td><td>High</td><td><code>response_posture</code></td></tr><tr><td>Rate limiting disabled</td><td>Enable rate limiting to prevent abuse and brute force</td><td>Medium</td><td><code>rate_limit_coverage</code></td></tr><tr><td>Header compliance below 80</td><td>Configure CSP and HSTS headers</td><td>Medium</td><td><code>header_compliance</code></td></tr><tr><td>Auth security below 70</td><td>Change default passwords and enable Auth Shield</td><td>High</td><td><code>auth_security</code></td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">intelligence/security_score.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Example recommendation structure</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">type</span><span class="token plain"> Recommendation </span><span class="token keyword" style="color:rgb(12, 150, 155)">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Title       </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;title&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Description </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;description&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Impact      </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;impact&quot;`</span><span class="token plain">       </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// &quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Category    </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;category&quot;`</span><span class="token plain">      </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// matches a sub-score dimension</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300">Act on Recommendations</p><div class="text-sm text-gray-700 dark:text-gray-300">Recommendations are not just informational. Each one directly maps to a sub-score dimension. Implementing a high-impact recommendation can raise your overall score by 10-20 points.</div></div></div></div><h2 id="api">API</h2><p>The security score is available through a single authenticated endpoint. The response includes the overall score, grade, each sub-score with its weight and label, the computation timestamp, trend direction, and the list of recommendations.</p><h3>Get Security Score</h3><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/score</code></td></tr><tr><td>Auth</td><td>JWT token in <code>Authorization: Bearer &lt;token&gt;</code></td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/score&quot; | jq .</span></div></pre></div></div><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">Response</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">json</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;data&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;overall&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">82</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;grade&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;B&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;threat_activity&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">90</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;weight&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.3</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;label&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Threat Activity&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;auth_security&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">80</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;weight&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.2</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;label&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Auth Security&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;response_posture&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;weight&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.2</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;label&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Response Posture&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;header_compliance&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">60</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;weight&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.15</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;label&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Header Compliance&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;rate_limit_coverage&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">50</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;weight&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.15</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;label&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Rate Limiting&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;computed_at&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;2025-01-15T14:30:00Z&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;trend&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;stable&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;recommendations&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;title&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Add Security Headers&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;description&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Configure Content-Security-Policy and Strict-Transport-Security headers.&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;impact&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Medium&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;category&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;header_compliance&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;title&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Enable Rate Limiting&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;description&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Enable rate limiting to prevent abuse and brute force attacks.&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;impact&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Medium&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;category&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;rate_limit_coverage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h2 id="dashboard">Dashboard</h2><p>The security score is surfaced in two places within the Sentinel dashboard:</p><ul><li><strong>Main Dashboard</strong> — The home page displays the overall score as a ring gauge with the letter grade at the center. The gauge color shifts from red (F) through amber (C/D) to green (A/B), providing an instant visual indicator of your security posture.</li><li><strong>Analytics Page</strong> — The analytics section shows a detailed score breakdown with each sub-score displayed individually. This view lets you identify which specific dimension is dragging down your overall score and view the associated recommendations.</li></ul><p>Access the dashboard at <code>http://localhost:8080/sentinel/ui</code> after mounting Sentinel.</p><h2 id="configuration">Configuration</h2><p>The score engine does not have its own configuration block. It reads the main<!-- --> <code>Config</code> you pass to <code>sentinel.Mount</code> to determine which features are enabled and how they are configured. The sub-scores react directly to your config:</p><table><thead><tr><th>Config Area</th><th>Affects Dimension</th><th>What the Engine Checks</th></tr></thead><tbody><tr><td><code>WAF</code></td><td>Threat Activity, Response Posture</td><td>Whether WAF is enabled and whether it is in block or log mode.</td></tr><tr><td><code>RateLimit</code></td><td>Rate Limiting</td><td>Whether rate limiting is enabled and which limit types are configured (by-IP, by-user, by-route).</td></tr><tr><td><code>Headers</code></td><td>Header Compliance</td><td>Which security headers are explicitly set in the config.</td></tr><tr><td><code>Dashboard</code></td><td>Auth Security</td><td>Whether the password and secret key have been changed from their defaults.</td></tr><tr><td><code>AuthShield</code></td><td>Auth Security</td><td>Whether Auth Shield brute-force protection is enabled.</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token keyword" style="color:rgb(12, 150, 155)">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;time&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    sentinel </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/MUKE-coder/sentinel&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/gin-gonic/gin&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    r </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Default</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// A well-configured setup that achieves a high security score</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// WAF in block mode -&gt; high Threat Activity &amp; Response Posture</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">        WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">            Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Rate limiting with per-IP and per-user -&gt; high Rate Limiting</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">        RateLimit</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RateLimitConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">            ByIP</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Limit</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">Requests</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> Window</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Minute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain">            ByUser</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Limit</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">Requests</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">200</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> Window</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Minute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain">            ByRoute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">map</span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Limit</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain">                </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/api/login&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">Requests</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">5</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> Window</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">15</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Minute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Full security headers -&gt; high Header Compliance</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">32</span><span class="token plain">        Headers</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">HeadersConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">33</span><span class="token plain">            XFrameOptions</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">            </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;DENY&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">34</span><span class="token plain">            ReferrerPolicy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">           </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;strict-origin-when-cross-origin&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">35</span><span class="token plain">            ContentSecurityPolicy</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;default-src &#x27;self&#x27;&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">36</span><span class="token plain">            StrictTransportSecurity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">37</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">38</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">39</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Custom credentials -&gt; high Auth Security</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">40</span><span class="token plain">        Dashboard</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">DashboardConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">41</span><span class="token plain">            Password</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;my-strong-password&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">42</span><span class="token plain">            SecretKey</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;my-custom-jwt-secret-key&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">43</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">44</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">45</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Auth Shield enabled -&gt; bonus Auth Security points</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">46</span><span class="token plain">        AuthShield</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">AuthShieldConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">47</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">         </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">48</span><span class="token plain">            MaxAttempts</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     </span><span class="token number" style="color:rgb(170, 9, 130)">5</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">49</span><span class="token plain">            LockoutDuration</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">15</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Minute</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">50</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">51</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">52</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">53</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">GET</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/api/data&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">54</span><span class="token plain">        c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">JSON</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">200</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">H</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;status&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ok&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">55</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">56</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">57</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;:8080&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">58</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Background Recomputation</p><div class="text-sm text-gray-700 dark:text-gray-300">The score engine runs in a background goroutine that ticks every 5 minutes. It also computes the score once immediately on startup. The API endpoint<!-- --> <code>GET /sentinel/api/score</code> triggers a fresh computation on each request, so you always get the latest result. The background goroutine ensures the persisted score stays current for the dashboard even when the API is not being called.</div></div></div></div><h2>Next Steps</h2><ul><li><a href="/docs/configuration">Configuration Reference</a> — Full config field reference for all features that affect the score</li><li><a href="/docs/waf">WAF</a> — Enable and configure the WAF to improve Threat Activity and Response Posture</li><li><a href="/docs/rate-limiting">Rate Limiting</a> — Configure rate limits to boost the Rate Limiting dimension</li><li><a href="/docs/security-headers">Security Headers</a> — Add headers to maximize Header Compliance</li><li><a href="/docs/auth-shield">Auth Shield</a> — Enable brute-force protection to raise Auth Security</li></ul><!--$--><!--/$--></main></div></div><script src="/_next/static/chunks/a339dcc3b98340b3.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[82031,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"ThemeProvider\"]\n3:I[95401,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"default\"]\n4:I[45121,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n5:I[60512,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n6:I[99113,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ClientSegmentRoot\"]\n7:I[45693,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\"],\"default\"]\n37:I[50025,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n:HL[\"/_next/static/chunks/a68d47cca58670f5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"5Swj18oapgqGqSZX8fol6\",\"c\":[\"\",\"docs\",\"security-score\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[\"security-score\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/a68d47cca58670f5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/4cc5a908347f559b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"min-h-screen antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/c23263069b7f7ba3.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"Component\":\"$7\",\"slots\":{\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"serverProvidedParams\":{\"params\":{},\"promises\":[\"$@8\"]}}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"Security Score\"}],[\"$\",\"p\",null,{\"children\":[\"The Security Score is a weighted composite metric (0-100) that measures your application's overall security posture at a glance. It aggregates five dimensions of your Sentinel configuration and runtime behavior into a single number, graded from \",[\"$\",\"strong\",null,{\"children\":\"A\"}],\" (90-100) to \",[\"$\",\"strong\",null,{\"children\":\"F\"}],\" (below 60). The score updates automatically in the background and surfaces actionable recommendations to improve your defenses.\"]}],[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Always Active\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"The score engine runs automatically once Sentinel is mounted. There is no separate configuration to enable it. It uses the main \",[\"$\",\"code\",null,{\"children\":\"Config\"}],\" you pass to\",\" \",[\"$\",\"code\",null,{\"children\":\"sentinel.Mount\"}],\" to evaluate which features are active and how well they are configured.\"]}]]}]]}]}],\"$L9\",\"$La\",\"$Lb\",\"$Lc\",\"$Ld\",\"$Le\",\"$Lf\",\"$L10\",\"$L11\",\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\",\"$L17\",\"$L18\",\"$L19\",\"$L1a\",\"$L1b\",\"$L1c\",\"$L1d\",\"$L1e\",\"$L1f\",\"$L20\",\"$L21\",\"$L22\",\"$L23\",\"$L24\",\"$L25\",\"$L26\",\"$L27\",\"$L28\",\"$L29\",\"$L2a\",\"$L2b\",\"$L2c\",\"$L2d\",\"$L2e\",\"$L2f\",\"$L30\",\"$L31\",\"$L32\",\"$L33\"],[\"$L34\"],\"$L35\"]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$L36\",false]],\"m\":\"$undefined\",\"G\":[\"$37\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"38:I[99151,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\",\"/_next/static/chunks/2425b678dfc0c3cf.js\"],\"default\"]\n3c:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"OutletBoundary\"]\n3d:\"$Sreact.suspense\"\n3f:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ViewportBoundary\"]\n41:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"MetadataBoundary\"]\n9:[\"$\",\"h2\",null,{\"id\":\"dimensions\",\"children\":\"Score Dimensions\"}]\na:[\"$\",\"p\",null,{\"children\":\"The overall score is a weighted sum of five sub-scores. Each dimension evaluates a different aspect of your security posture:\"}]\n"])</script><script>self.__next_f.push([1,"b:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Dimension\"}],[\"$\",\"th\",null,{\"children\":\"Weight\"}],[\"$\",\"th\",null,{\"children\":\"What It Measures\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Threat Activity\"}]}],[\"$\",\"td\",null,{\"children\":\"30%\"}],[\"$\",\"td\",null,{\"children\":\"How many threats were detected in the last 24 hours and how severe they are. Fewer and lower-severity threats yield a higher score. A bonus is applied when your block rate exceeds 90%.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Auth Security\"}]}],[\"$\",\"td\",null,{\"children\":\"20%\"}],[\"$\",\"td\",null,{\"children\":\"Whether you have changed the default dashboard password and secret key, and whether Auth Shield is enabled. Using defaults penalizes this sub-score.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Response Posture\"}]}],[\"$\",\"td\",null,{\"children\":\"20%\"}],[\"$\",\"td\",null,{\"children\":\"The ratio of blocked threats to total threats. A 100% block rate yields a perfect sub-score. If the WAF is in log-only mode, unblocked threats lower this dimension.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Header Compliance\"}]}],[\"$\",\"td\",null,{\"children\":\"15%\"}],[\"$\",\"td\",null,{\"children\":[\"How many recommended security headers are configured: \",[\"$\",\"code\",null,{\"children\":\"X-Frame-Options\"}],\",\",\" \",[\"$\",\"code\",null,{\"children\":\"Referrer-Policy\"}],\", \",[\"$\",\"code\",null,{\"children\":\"Content-Security-Policy\"}],\", and\",\" \",[\"$\",\"code\",null,{\"children\":\"Strict-Transport-Security\"}],\". \",[\"$\",\"code\",null,{\"children\":\"X-Content-Type-Options\"}],\" is always set by default.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Rate Limiting\"}]}],[\"$\",\"td\",null,{\"children\":\"15%\"}],[\"$\",\"td\",null,{\"children\":\"Whether rate limiting is enabled and how comprehensively it is configured: per-IP, per-user, and per-route limits each contribute to this sub-score.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"h2\",null,{\"id\":\"how-it-works\",\"children\":\"How It's Computed\"}]\nd:[\"$\",\"p\",null,{\"children\":[\"Sentinel launches a background goroutine when \",[\"$\",\"code\",null,{\"children\":\"Mount\"}],\" is called. The\",\" \",[\"$\",\"code\",null,{\"children\":\"ScoreEngine\"}],\" computes the score immediately on startup and then recomputes it every 5 minutes. Each cycle performs the following steps:\"]}]\ne:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Query threat stats\"}],\" — The engine calls \",[\"$\",\"code\",null,{\"children\":\"GetThreatStats\"}],\" on the storage layer with a 24-hour window to retrieve counts by severity and block status.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Evaluate each dimension\"}],\" — Five dedicated functions compute a sub-score (0-100) for each dimension using the threat stats and the current \",[\"$\",\"code\",null,{\"children\":\"Config\"}],\".\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Weighted aggregation\"}],\" — Sub-scores are multiplied by their weights and summed to produce the overall score.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Grade assignment\"}],\" — The overall score is mapped to a letter grade.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Recommendation generation\"}],\" — The engine inspects each sub-score and the config to produce actionable recommendations for any weak areas.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Persist\"}],\" — The result is saved to storage via\",\" \",[\"$\",\"code\",null,{\"children\":\"SaveSecurityScore\"}],\" so the dashboard and API can read it without recomputing.\"]}]]}]\n39:T4e5,// ComputeScore calculates the security score based on current state.\nfunc (e *ScoreEngine) ComputeScore(ctx context.Context) (*sentinel.SecurityScore, error) {\n    stats, err := e.store.GetThreatStats(ctx, 24*time.Hour)\n    if err != nil {\n        return nil, err\n    }\n\n    threatScore   := computeThreatActivityScore(stats)    // weight: 30%\n    authScore     := computeAuthSecurityScore(e.config)   // weight: 20%\n    responseScore := computeResponsePostureScore(stats)   // weight: 20%\n    headerScore   := computeHeaderComplianceScore(e.config) // weight: 15%\n    rateLimitScore := computeRateLimitCoverageScore(e.config) // weight: 15%\n\n    overall := int(\n        float64(threatScore)*0.30 +\n        float64(authScore)*0.20 +\n        float64(responseScore)*0.20 +\n        float64(headerScore)*0.15 +\n        float64(rateLimitScore)*0.15,\n    )\n\n    grade := scoreToGrade(overall)\n    recommendations := generateRecommendations(\n        threatScore, authScore, responseScore,\n        headerScore, rateLimitScore, e.config,\n    )\n\n    score := \u0026sentinel.SecurityScore{\n        Overall: overall,\n        Grade:   grade,\n        // ... sub-scores, computed_at, recommendations\n    }\n\n    e.store.SaveSecurityScore(ctx, score)\n    return score, nil\n}f:[\"$\",\"$L38\",null,{\"language\":\"go\",\"filename\":\"intelligence/security_score.go\",\"code\":\"$39\"}]\n10:[\"$\",\"h3\",null,{\"children\":\"Grading Scale\"}]\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Score Range\"}],[\"$\",\"th\",null,{\"children\":\"Grade\"}],[\"$\",\"th\",null,{\"children\":\"Interpretation\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"90 - 100\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"A\"}]}],[\"$\",\"td\",null,{\"children\":\"Excellent. All major features enabled and well-configured.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"80 - 89\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"B\"}]}],[\"$\",\"td\",null,{\"children\":\"Good. Minor improvements available.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"70 - 79\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"C\"}]}],[\"$\",\"td\",null,{\"children\":\"Fair. Some important features are missing or misconfigured.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"60 - 69\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"D\"}]}],[\"$\",\"td\",null,{\"children\":\"Poor. Significant gaps in your security posture.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"0 - 59\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"F\"}]}],[\"$\",\"td\",null,{\"children\":\"Failing. Critical features are disabled or defaults are unchanged.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"h2\",null,{\"id\":\"sub-score-details\",\"children\":\"Sub-Score Details\"}]\n13:[\"$\",\"h3\",null,{\"children\":\"Threat Activity (30%)\"}]\n14:[\"$\",\"p\",null,{\"children\":\"Starts at 100 and deducts points for each threat detected in the last 24 hours. Deductions scale by severity: critical threats cost 20 points each, high costs 10, medium costs 5, and low costs 2. A bonus of +10 is applied when over 90% of threats are blocked, or +5 when over 50% are blocked. With no threats in the window, the sub-score is a perfect 100.\"}]\n15:[\"$\",\"h3\",null,{\"children\":\"Auth Security (20%)\"}]\n16:[\"$\",\"p\",null,{\"children\":[\"Starts at a base of 50. Changing the default dashboard password from\",\" \",[\"$\",\"code\",null,{\"children\":\"\\\"sentinel\\\"\"}],\" adds 20 points. Changing the default secret key adds another 20. Enabling Auth Shield adds 10. A fully configured authentication setup scores 100.\"]}]\n17:[\"$\",\"h3\",null,{\"children\":\"Response Posture (20%)\"}]\n18:[\"$\",\"p\",null,{\"children\":\"Measures the percentage of threats that were actively blocked. If all detected threats are blocked (WAF in block mode), the sub-score is 100. If no threats have been detected, the baseline score is 80. Running the WAF in log-only mode typically lowers this dimension because threats are recorded but not blocked.\"}]\n19:[\"$\",\"h3\",null,{\"children\":\"Header Compliance (15%)\"}]\n1a:[\"$\",\"p\",null,{\"children\":[\"Counts how many of the five recommended security headers are configured:\",\" \",[\"$\",\"code\",null,{\"children\":\"X-Content-Type-Options\"}],\" (always on), \",[\"$\",\"code\",null,{\"children\":\"X-Frame-Options\"}],\",\",\" \",[\"$\",\"code\",null,{\"children\":\"Referrer-Policy\"}],\", \",[\"$\",\"code\",null,{\"children\":\"Content-Security-Policy\"}],\", and\",\" \",[\"$\",\"code\",null,{\"children\":\"Strict-Transport-Security\"}],\". Each configured header contributes equally. If security headers are explicitly disabled, the sub-score is 0.\"]}]\n1b:[\"$\",\"h3\",null,{\"children\":\"Rate Limiting (15%)\"}]\n1c:[\"$\",\"p\",null,{\"children\":\"Awards a base of 30 points for having rate limiting enabled. Additional points come from configuring per-IP limits (+30), per-user limits (+20), and per-route limits (+20). Disabling rate limiting entirely results in a sub-score of 0.\"}]\n1d:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500\",\"children\":[[\"$\",\"path\",\"yps3ct\",{\"d\":\"M21.801 10A10 10 0 1 1 17 3.335\"}],[\"$\",\"path\",\"1pflzl\",{\"d\":\"m9 11 3 3L22 4\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-green-800 dark:text-green-300\",\"children\":\"Maximizing Your Score\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"To reach an A grade: enable WAF in block mode, enable rate limiting with per-IP and per-user limits, configure all five security headers, change the default dashboard password and secret key, and enable Auth Shield. These settings cover all five dimensions.\"}]]}]]}]}]\n1e:[\"$\",\"h2\",null,{\"id\":\"recommendations\",\"children\":\"Recommendations\"}]\n1f:[\"$\",\"p\",null,{\"children\":\"After computing the score, the engine generates a list of actionable recommendations based on which features are disabled or which sub-scores fall below their thresholds. Each recommendation includes a title, description, impact level, and the category it addresses.\"}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Condition\"}],[\"$\",\"th\",null,{\"children\":\"Recommendation\"}],[\"$\",\"th\",null,{\"children\":\"Impact\"}],[\"$\",\"th\",null,{\"children\":\"Category\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WAF disabled\"}],[\"$\",\"td\",null,{\"children\":\"Enable WAF to protect against common attacks\"}],[\"$\",\"td\",null,{\"children\":\"High\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"threat_activity\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"WAF in log-only mode\"}],[\"$\",\"td\",null,{\"children\":\"Set WAF to block mode to actively prevent attacks\"}],[\"$\",\"td\",null,{\"children\":\"High\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"response_posture\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Rate limiting disabled\"}],[\"$\",\"td\",null,{\"children\":\"Enable rate limiting to prevent abuse and brute force\"}],[\"$\",\"td\",null,{\"children\":\"Medium\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"rate_limit_coverage\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Header compliance below 80\"}],[\"$\",\"td\",null,{\"children\":\"Configure CSP and HSTS headers\"}],[\"$\",\"td\",null,{\"children\":\"Medium\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"header_compliance\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Auth security below 70\"}],[\"$\",\"td\",null,{\"children\":\"Change default passwords and enable Auth Shield\"}],[\"$\",\"td\",null,{\"children\":\"High\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"auth_security\"}]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"21:[\"$\",\"$L38\",null,{\"language\":\"go\",\"filename\":\"intelligence/security_score.go\",\"showLineNumbers\":false,\"code\":\"// Example recommendation structure\\ntype Recommendation struct {\\n    Title       string `json:\\\"title\\\"`\\n    Description string `json:\\\"description\\\"`\\n    Impact      string `json:\\\"impact\\\"`       // \\\"High\\\", \\\"Medium\\\", \\\"Low\\\"\\n    Category    string `json:\\\"category\\\"`      // matches a sub-score dimension\\n}\"}]\n22:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300\",\"children\":\"Act on Recommendations\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"Recommendations are not just informational. Each one directly maps to a sub-score dimension. Implementing a high-impact recommendation can raise your overall score by 10-20 points.\"}]]}]]}]}]\n23:[\"$\",\"h2\",null,{\"id\":\"api\",\"children\":\"API\"}]\n24:[\"$\",\"p\",null,{\"children\":\"The security score is available through a single authenticated endpoint. The response includes the overall score, grade, each sub-score with its weight and label, the computation timestamp, trend direction, and the list of recommendations.\"}]\n25:[\"$\",\"h3\",null,{\"children\":\"Get Security Score\"}]\n26:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/score\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Auth\"}],[\"$\",\"td\",null,{\"children\":[\"JWT token in \",[\"$\",\"code\",null,{\"children\":\"Authorization: Bearer \u003ctoken\u003e\"}]]}]]}]]}]]}]\n27:[\"$\",\"$L38\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/score\\\" | jq .\"}]\n3a:T466,{\n  \"data\": {\n    \"overall\": 82,\n    \"grade\": \"B\",\n    \"threat_activity\": {\n      \"score\": 90,\n      \"weight\": 0.3,\n      \"label\": \"Threat Activity\"\n    },\n    \"auth_security\": {\n      \"score\": 80,\n      \"weight\": 0.2,\n      \"label\": \"Auth Security\"\n    },\n    \"response_posture\": {\n      \"score\": 100,\n      \"weight\": 0.2,\n      \"label\": \"Response Posture\"\n    },\n    \"header_compliance\": {\n      \"score\": 60,\n      \"weight\": 0.15,\n      \"label\": \"Header Compliance\"\n    },\n    \"rate_limit_coverage\": {\n      \"score\": 50,\n      \"weight\": 0.15,\n      \"label\": \"Rate Limiting\"\n    },\n    \"computed_at\": \"2025-01-15T14:30:00Z\",\n    \"trend\": \"stable\",\n    \"recommendations\": [\n      {\n        \"title\": \"Add Security Headers\",\n        \"description\": \"Configure Content-Security-Policy and Strict-Transport-Security headers.\",\n        \"impact\": \"Medium\",\n        \"category\": \"header_compliance\"\n      },\n      {\n        \"title\": \"Enable Rate Limiting\",\n        \"description\": \"Enable rate limiting to prevent abuse and brute force attacks.\",\n        \"impact\": \"Medium\",\n        \"category\": \"rate_limit_coverage\"\n      }\n    ]\n  }\n}28:[\"$\",\"$L38\",null,{\"language\":\"json\",\"filename\":\"Response\",\"showLineNumbers\":false,\"code\":\"$3a\"}]\n29:[\"$\",\"h2\",null,{\"id\":\"dashboard\",\"children\":\"Dashboard\"}]\n2a:[\"$\",\"p\",null,{\"children\":\"The security score is surfaced in two places within the Sentinel dashboard:\"}]\n2b:[\""])</script><script>self.__next_f.push([1,"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Main Dashboard\"}],\" — The home page displays the overall score as a ring gauge with the letter grade at the center. The gauge color shifts from red (F) through amber (C/D) to green (A/B), providing an instant visual indicator of your security posture.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Analytics Page\"}],\" — The analytics section shows a detailed score breakdown with each sub-score displayed individually. This view lets you identify which specific dimension is dragging down your overall score and view the associated recommendations.\"]}]]}]\n2c:[\"$\",\"p\",null,{\"children\":[\"Access the dashboard at \",[\"$\",\"code\",null,{\"children\":\"http://localhost:8080/sentinel/ui\"}],\" after mounting Sentinel.\"]}]\n2d:[\"$\",\"h2\",null,{\"id\":\"configuration\",\"children\":\"Configuration\"}]\n2e:[\"$\",\"p\",null,{\"children\":[\"The score engine does not have its own configuration block. It reads the main\",\" \",[\"$\",\"code\",null,{\"children\":\"Config\"}],\" you pass to \",[\"$\",\"code\",null,{\"children\":\"sentinel.Mount\"}],\" to determine which features are enabled and how they are configured. The sub-scores react directly to your config:\"]}]\n"])</script><script>self.__next_f.push([1,"2f:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Config Area\"}],[\"$\",\"th\",null,{\"children\":\"Affects Dimension\"}],[\"$\",\"th\",null,{\"children\":\"What the Engine Checks\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"WAF\"}]}],[\"$\",\"td\",null,{\"children\":\"Threat Activity, Response Posture\"}],[\"$\",\"td\",null,{\"children\":\"Whether WAF is enabled and whether it is in block or log mode.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RateLimit\"}]}],[\"$\",\"td\",null,{\"children\":\"Rate Limiting\"}],[\"$\",\"td\",null,{\"children\":\"Whether rate limiting is enabled and which limit types are configured (by-IP, by-user, by-route).\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Headers\"}]}],[\"$\",\"td\",null,{\"children\":\"Header Compliance\"}],[\"$\",\"td\",null,{\"children\":\"Which security headers are explicitly set in the config.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Dashboard\"}]}],[\"$\",\"td\",null,{\"children\":\"Auth Security\"}],[\"$\",\"td\",null,{\"children\":\"Whether the password and secret key have been changed from their defaults.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AuthShield\"}]}],[\"$\",\"td\",null,{\"children\":\"Auth Security\"}],[\"$\",\"td\",null,{\"children\":\"Whether Auth Shield brute-force protection is enabled.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"3b:T6f9,"])</script><script>self.__next_f.push([1,"package main\n\nimport (\n    \"time\"\n\n    sentinel \"github.com/MUKE-coder/sentinel\"\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    r := gin.Default()\n\n    // A well-configured setup that achieves a high security score\n    sentinel.Mount(r, nil, sentinel.Config{\n        // WAF in block mode -\u003e high Threat Activity \u0026 Response Posture\n        WAF: sentinel.WAFConfig{\n            Enabled: true,\n            Mode:    sentinel.ModeBlock,\n        },\n\n        // Rate limiting with per-IP and per-user -\u003e high Rate Limiting\n        RateLimit: sentinel.RateLimitConfig{\n            Enabled: true,\n            ByIP:    \u0026sentinel.Limit{Requests: 100, Window: time.Minute},\n            ByUser:  \u0026sentinel.Limit{Requests: 200, Window: time.Minute},\n            ByRoute: map[string]sentinel.Limit{\n                \"/api/login\": {Requests: 5, Window: 15 * time.Minute},\n            },\n        },\n\n        // Full security headers -\u003e high Header Compliance\n        Headers: sentinel.HeadersConfig{\n            XFrameOptions:            \"DENY\",\n            ReferrerPolicy:           \"strict-origin-when-cross-origin\",\n            ContentSecurityPolicy:    \"default-src 'self'\",\n            StrictTransportSecurity:  true,\n        },\n\n        // Custom credentials -\u003e high Auth Security\n        Dashboard: sentinel.DashboardConfig{\n            Password:  \"my-strong-password\",\n            SecretKey: \"my-custom-jwt-secret-key\",\n        },\n\n        // Auth Shield enabled -\u003e bonus Auth Security points\n        AuthShield: sentinel.AuthShieldConfig{\n            Enabled:         true,\n            MaxAttempts:     5,\n            LockoutDuration: 15 * time.Minute,\n        },\n    })\n\n    r.GET(\"/api/data\", func(c *gin.Context) {\n        c.JSON(200, gin.H{\"status\": \"ok\"})\n    })\n\n    r.Run(\":8080\")\n}"])</script><script>self.__next_f.push([1,"30:[\"$\",\"$L38\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"$3b\"}]\n31:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Background Recomputation\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"The score engine runs in a background goroutine that ticks every 5 minutes. It also computes the score once immediately on startup. The API endpoint\",\" \",[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/score\"}],\" triggers a fresh computation on each request, so you always get the latest result. The background goroutine ensures the persisted score stays current for the dashboard even when the API is not being called.\"]}]]}]]}]}]\n32:[\"$\",\"h2\",null,{\"children\":\"Next Steps\"}]\n33:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/configuration\",\"children\":\"Configuration Reference\"}],\" — Full config field reference for all features that affect the score\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/waf\",\"children\":\"WAF\"}],\" — Enable and configure the WAF to improve Threat Activity and Response Posture\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/rate-limiting\",\"children\":\"Rate Limiting\"}],\" — Configure rate limits to boost the Rate Limiting dimension\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/security-headers\",\"children\":\"Security Headers\"}],\" — Add headers to maximize Header Compliance\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/auth-shield\",\"children\":\"Auth Shield\"}],\" — Enable brute-force protection to raise Auth Security\"]}]]}]\n34:[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/2425b678dfc0c3cf.js\",\"async\":true,\"nonce\":\"$undefined\"}]\n35:[\"$\",\"$L3c\",null,{\"children\":[\"$\",\"$3d\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@3e\"}]}]\n36:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L3f\",null,{\"children\":\"$L40\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$3d\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L42\"}]}]}],null]}]\n8:\"$0:f:0:1:1:children:0:props:children:1:props:serverProvidedParams:params\"\n"])</script><script>self.__next_f.push([1,"40:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"3e:null\n42:[[\"$\",\"title\",\"0\",{\"children\":\"Security Score - Sentinel Docs\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard.\"}]]\n"])</script></body></html>