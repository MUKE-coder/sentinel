module.exports=[81654,a=>{"use strict";var b=a.i(81332),c=a.i(17924),d=a.i(64939);function e(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h1",{children:"AI Analysis"}),(0,b.jsxs)("p",{children:["Sentinel includes an optional AI-powered analysis system that brings intelligent threat interpretation to your security data. By integrating with leading LLM providers —"," ",(0,b.jsx)("strong",{children:"Anthropic Claude"}),", ",(0,b.jsx)("strong",{children:"OpenAI"}),", or ",(0,b.jsx)("strong",{children:"Google Gemini"})," ","— Sentinel can generate plain-English explanations of threat events, assess the risk level of threat actors, summarize your daily security posture, answer natural language questions about your data, and even recommend new WAF rules based on recent attack patterns."]}),(0,b.jsx)("p",{children:"AI analysis is entirely optional. When not configured, all AI endpoints gracefully return a message indicating that AI is not set up, and the dashboard shows setup instructions instead of analysis results. No API calls are made to any external service unless you explicitly provide a provider and API key."}),(0,b.jsx)(d.default,{type:"info",title:"Optional Feature",children:"AI analysis requires a valid API key from one of the supported providers. Sentinel works perfectly without it — all core security features (WAF, rate limiting, anomaly detection, threat intelligence, alerting) operate independently of AI. Think of it as an intelligence layer on top of your existing security data."}),(0,b.jsx)("h2",{id:"providers",children:"Supported Providers"}),(0,b.jsx)("p",{children:"Sentinel supports three AI providers out of the box. Each provider uses a sensible default model, but you can override it with any model the provider supports."}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Provider"}),(0,b.jsx)("th",{children:"Constant"}),(0,b.jsx)("th",{children:"Default Model"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("strong",{children:"Claude"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"sentinel.Claude"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"claude-sonnet-4-20250514"})}),(0,b.jsx)("td",{children:"Anthropic Claude. Excellent at nuanced security analysis and structured reasoning."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("strong",{children:"OpenAI"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"sentinel.OpenAI"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"gpt-4o"})}),(0,b.jsx)("td",{children:"OpenAI GPT. Strong general-purpose analysis with broad security knowledge."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("strong",{children:"Gemini"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"sentinel.Gemini"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"gemini-2.0-flash"})}),(0,b.jsx)("td",{children:"Google Gemini. Fast and cost-effective for high-volume analysis workloads."})]})]})]}),(0,b.jsx)("h2",{id:"configuration",children:"Configuration"}),(0,b.jsxs)("p",{children:["AI analysis is configured through the ",(0,b.jsx)("code",{children:"AI"})," field on the main"," ",(0,b.jsx)("code",{children:"sentinel.Config"})," struct. This field is a pointer (",(0,b.jsx)("code",{children:"*AIConfig"}),"), so setting it to ",(0,b.jsx)("code",{children:"nil"})," (or simply omitting it) disables all AI features."]}),(0,b.jsx)("h3",{children:"AIConfig"}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Required"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"Provider"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"AIProvider"})}),(0,b.jsx)("td",{children:"Yes"}),(0,b.jsxs)("td",{children:["Which AI provider to use: ",(0,b.jsx)("code",{children:"sentinel.Claude"}),", ",(0,b.jsx)("code",{children:"sentinel.OpenAI"}),", or ",(0,b.jsx)("code",{children:"sentinel.Gemini"}),"."]})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"APIKey"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Yes"}),(0,b.jsx)("td",{children:"Your API key for the chosen provider. Keep this secret — use environment variables in production."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"Model"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"No"}),(0,b.jsx)("td",{children:"Optional model override. When empty, the default model for the chosen provider is used (see table above)."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"DailySummary"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"bool"})}),(0,b.jsx)("td",{children:"No"}),(0,b.jsxs)("td",{children:["When ",(0,b.jsx)("code",{children:"true"}),", enables automatic daily summary generation."]})]})]})]}),(0,b.jsx)(c.default,{language:"go",filename:"core/config.go",code:`// AIConfig configures optional AI-powered analysis.
type AIConfig struct {
    Provider     AIProvider \`json:"provider"\`
    APIKey       string     \`json:"api_key"\`
    Model        string     \`json:"model,omitempty"\`
    DailySummary bool       \`json:"daily_summary,omitempty"\`
}

// AIProvider specifies which AI provider to use.
type AIProvider string

const (
    Claude AIProvider = "claude"
    OpenAI AIProvider = "openai"
    Gemini AIProvider = "gemini"
)`}),(0,b.jsx)("h3",{children:"Basic Configuration (Claude)"}),(0,b.jsx)(c.default,{language:"go",filename:"main.go",code:`sentinel.Mount(r, nil, sentinel.Config{
    WAF: sentinel.WAFConfig{
        Enabled: true,
        Mode:    sentinel.ModeBlock,
    },
    AI: &sentinel.AIConfig{
        Provider: sentinel.Claude,
        APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
    },
})`}),(0,b.jsx)("h3",{children:"OpenAI Configuration"}),(0,b.jsx)(c.default,{language:"go",filename:"main.go",code:`AI: &sentinel.AIConfig{
    Provider: sentinel.OpenAI,
    APIKey:   os.Getenv("OPENAI_API_KEY"),
}`}),(0,b.jsx)("h3",{children:"Gemini Configuration"}),(0,b.jsx)(c.default,{language:"go",filename:"main.go",code:`AI: &sentinel.AIConfig{
    Provider: sentinel.Gemini,
    APIKey:   os.Getenv("GEMINI_API_KEY"),
}`}),(0,b.jsx)("h3",{children:"Custom Model Override"}),(0,b.jsxs)("p",{children:["If you want to use a specific model version instead of the default, set the"," ",(0,b.jsx)("code",{children:"Model"})," field:"]}),(0,b.jsx)(c.default,{language:"go",code:`AI: &sentinel.AIConfig{
    Provider: sentinel.OpenAI,
    APIKey:   os.Getenv("OPENAI_API_KEY"),
    Model:    "gpt-4-turbo",  // Override the default gpt-4o
}`}),(0,b.jsxs)(d.default,{type:"warning",title:"Protect Your API Key",children:["Never hardcode API keys in your source code. Use environment variables or a secrets manager. The examples above use ",(0,b.jsx)("code",{children:"os.Getenv()"})," to load the key from the environment at runtime."]}),(0,b.jsx)("h2",{id:"capabilities",children:"AI Capabilities"}),(0,b.jsx)("p",{children:"Sentinel provides five distinct AI-powered analysis features. Each one is accessible via the dashboard UI and the REST API."}),(0,b.jsx)("h3",{id:"threat-analysis",children:"1. Threat Analysis"}),(0,b.jsx)("p",{children:"Generate a detailed, plain-English analysis of a specific threat event. The AI examines the threat type, severity, payload, targeted route, and the associated actor profile to produce an explanation of what happened, why it matters, and what you should do about it."}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Response Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"summary"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A concise one-line summary of the threat."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"explanation"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A detailed explanation of the attack technique and its implications."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"severity_assessment"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The AI assessment of how severe this threat is in context."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"succeeded"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"bool"})}),(0,b.jsx)("td",{children:"Whether the AI believes the attack succeeded."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"recommendations"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Actionable recommendations for mitigating or preventing this threat."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"threat_category"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The broad category the AI assigns to this threat."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"confidence"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"int"})}),(0,b.jsx)("td",{children:"The AI confidence score (0-100) in its analysis."})]})]})]}),(0,b.jsx)("h3",{id:"actor-assessment",children:"2. Actor Assessment"}),(0,b.jsx)("p",{children:"Generate a risk assessment of a threat actor based on their IP address, behavioral history, and recent events. The AI evaluates the actor's intent, sophistication level, and overall risk to your application."}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Response Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"summary"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A concise overview of the actor and their behavior."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"intent"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The AI assessment of the actor's likely intent (e.g., reconnaissance, exploitation, data exfiltration)."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"sophistication"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The estimated skill level of the actor (e.g., script kiddie, intermediate, advanced)."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"risk_level"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Overall risk rating for this actor."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"recommendations"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Suggested actions to take regarding this actor."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"related_groups"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Known threat groups or campaigns the actor's behavior may be associated with."})]})]})]}),(0,b.jsx)("h3",{id:"daily-summary",children:"3. Daily Summary"}),(0,b.jsx)("p",{children:"Generate an AI-powered summary of the last 24 hours of security events. This provides a high-level overview of your security posture, highlights the most significant threats, identifies trends, and offers strategic recommendations."}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Response Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"summary"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A narrative overview of the day's security events."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"highlights"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Key events and milestones from the past 24 hours."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"top_threats"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"The most significant threats observed during the period."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"trend_analysis"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Analysis of how threat patterns are evolving."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"recommendations"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Strategic recommendations based on observed patterns."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"overall_status"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A brief assessment of overall security health."})]})]})]}),(0,b.jsx)("h3",{id:"natural-language-query",children:"4. Natural Language Query"}),(0,b.jsx)("p",{children:"Ask questions about your security data in plain English. The AI receives context about your recent threats, top actors, threat statistics, and security score, then answers your question using that live data."}),(0,b.jsx)(c.default,{language:"json",filename:"Example Queries",showLineNumbers:!1,code:`{ "query": "What are the most common attack types this week?" }
{ "query": "Is the IP 203.0.113.50 a serious threat?" }
{ "query": "Should I be worried about the spike in XSS attempts?" }
{ "query": "Summarize the threats targeting my /api/auth endpoint" }`}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Response Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"answer"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The AI answer to your question, grounded in your actual security data."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"sources"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"References to the data sources used to answer the question."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"suggestions"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsx)("td",{children:"Follow-up questions or actions the AI suggests."})]})]})]}),(0,b.jsx)("h3",{id:"waf-recommendations",children:"5. WAF Recommendations"}),(0,b.jsx)("p",{children:"The AI analyzes recent threat events and suggests new WAF rules to improve your defenses. Each recommendation includes a rule ID, name, regex pattern, severity, the request components it should apply to, and the reasoning behind the suggestion."}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Response Field"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"rule_id"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"A suggested unique ID for the rule."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"name"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Human-readable name for the recommended rule."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"pattern"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"The regex pattern to match against requests."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"severity"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Suggested severity level for matches."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"reason"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"string"})}),(0,b.jsx)("td",{children:"Explanation of why this rule is recommended based on observed patterns."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"applies_to"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"[]string"})}),(0,b.jsxs)("td",{children:["Which request components to inspect (e.g., ",(0,b.jsx)("code",{children:"path"}),", ",(0,b.jsx)("code",{children:"query"}),", ",(0,b.jsx)("code",{children:"headers"}),", ",(0,b.jsx)("code",{children:"body"}),")."]})]})]})]}),(0,b.jsxs)(d.default,{type:"info",title:"Review Before Applying",children:["AI-generated WAF rules are suggestions, not automatic deployments. Always review the recommended patterns carefully and test them in ",(0,b.jsx)("code",{children:"ModeLog"})," before enabling them in production. The AI may occasionally suggest overly broad patterns that could cause false positives."]}),(0,b.jsx)("h2",{id:"api-endpoints",children:"API Endpoints"}),(0,b.jsxs)("p",{children:["All AI endpoints are protected by dashboard authentication (JWT). They are available under the ",(0,b.jsx)("code",{children:"/sentinel/api/ai"})," prefix by default."]}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Method"}),(0,b.jsx)("th",{children:"Endpoint"}),(0,b.jsx)("th",{children:"Description"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"POST"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"/ai/analyze-threat/:id"})}),(0,b.jsx)("td",{children:"Analyze a specific threat event by its ID."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"GET"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"/ai/analyze-actor/:ip"})}),(0,b.jsx)("td",{children:"Generate a risk assessment for a threat actor by IP address."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"GET"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"/ai/daily-summary"})}),(0,b.jsx)("td",{children:"Generate an AI summary of the last 24 hours of security events."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"POST"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"/ai/query"})}),(0,b.jsx)("td",{children:"Ask a natural language question about your security data."})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"GET"})}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"/ai/waf-recommendations"})}),(0,b.jsx)("td",{children:"Get AI-suggested WAF rules based on recent threats."})]})]})]}),(0,b.jsx)("h3",{children:"Analyze Threat"}),(0,b.jsx)(c.default,{language:"bash",showLineNumbers:!1,code:`# Analyze a specific threat event
curl -X POST http://localhost:8080/sentinel/api/ai/analyze-threat/te-abc123 \\
  -H "Authorization: Bearer <token>"`}),(0,b.jsx)("h3",{children:"Analyze Actor"}),(0,b.jsx)(c.default,{language:"bash",showLineNumbers:!1,code:`# Get risk assessment for a threat actor
curl http://localhost:8080/sentinel/api/ai/analyze-actor/203.0.113.50 \\
  -H "Authorization: Bearer <token>"`}),(0,b.jsx)("h3",{children:"Daily Summary"}),(0,b.jsx)(c.default,{language:"bash",showLineNumbers:!1,code:`# Generate AI daily security summary
curl http://localhost:8080/sentinel/api/ai/daily-summary \\
  -H "Authorization: Bearer <token>"`}),(0,b.jsx)("h3",{children:"Natural Language Query"}),(0,b.jsx)(c.default,{language:"bash",showLineNumbers:!1,code:`# Ask a question about your security data
curl -X POST http://localhost:8080/sentinel/api/ai/query \\
  -H "Authorization: Bearer <token>" \\
  -H "Content-Type: application/json" \\
  -d '{"query": "What are the most targeted endpoints this week?"}'`}),(0,b.jsx)("h3",{children:"WAF Recommendations"}),(0,b.jsx)(c.default,{language:"bash",showLineNumbers:!1,code:`# Get AI-suggested WAF rules
curl http://localhost:8080/sentinel/api/ai/waf-recommendations \\
  -H "Authorization: Bearer <token>"`}),(0,b.jsx)("h2",{id:"caching",children:"Response Caching"}),(0,b.jsxs)("p",{children:["To minimize API costs and improve response times, Sentinel wraps every AI provider with a"," ",(0,b.jsx)("code",{children:"CachedProvider"}),". The caching layer intercepts requests and returns cached responses when available, falling back to the real provider only when the cache misses or expires."]}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Feature"}),(0,b.jsx)("th",{children:"Cache Key"}),(0,b.jsx)("th",{children:"Cached?"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Threat Analysis"}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"threat:<threat_id>"})}),(0,b.jsx)("td",{children:"Yes"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Actor Assessment"}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"actor:<ip_address>"})}),(0,b.jsx)("td",{children:"Yes"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Daily Summary"}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"daily:<YYYY-MM-DD>"})}),(0,b.jsx)("td",{children:"Yes"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"Natural Language Query"}),(0,b.jsx)("td",{children:"N/A"}),(0,b.jsx)("td",{children:"No — each query is unique"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:"WAF Recommendations"}),(0,b.jsx)("td",{children:(0,b.jsx)("code",{children:"waf-rec:<YYYY-MM-DD>"})}),(0,b.jsx)("td",{children:"Yes"})]})]})]}),(0,b.jsxs)("p",{children:["The default cache TTL is ",(0,b.jsx)("strong",{children:"1 hour"}),". After the TTL expires, the next request for the same key triggers a fresh AI call. Natural language queries are never cached because each query is unique and users expect real-time answers."]}),(0,b.jsx)(c.default,{language:"go",filename:"ai/provider.go",code:`// CachedProvider wraps a Provider with response caching.
type CachedProvider struct {
    provider Provider
    cache    map[string]*cacheEntry
    mu       sync.RWMutex
    ttl      time.Duration
}

// NewCachedProvider creates a caching wrapper around any Provider.
func NewCachedProvider(provider Provider, ttl time.Duration) *CachedProvider {
    if ttl == 0 {
        ttl = 1 * time.Hour  // Default TTL
    }
    return &CachedProvider{
        provider: provider,
        cache:    make(map[string]*cacheEntry),
        ttl:      ttl,
    }
}`}),(0,b.jsx)(d.default,{type:"success",title:"Cost Optimization",children:"The caching layer significantly reduces API costs. Analyzing the same threat event multiple times (e.g., when multiple team members view the same event in the dashboard) only incurs one API call. Daily summaries and WAF recommendations are cached for the entire day, so repeated views are instant and free."}),(0,b.jsx)("h2",{id:"graceful-degradation",children:"Graceful Degradation"}),(0,b.jsxs)("p",{children:["When AI is not configured (the ",(0,b.jsx)("code",{children:"AI"})," field is ",(0,b.jsx)("code",{children:"nil"})," or the API key is empty), Sentinel degrades gracefully rather than failing. All AI endpoints remain available but return a clear message indicating that AI is not set up."]}),(0,b.jsx)("h3",{children:"API Response When AI Is Not Configured"}),(0,b.jsx)(c.default,{language:"json",filename:"Response",showLineNumbers:!1,code:`{
  "data": null,
  "message": "AI not configured"
}`}),(0,b.jsxs)("p",{children:["This consistent response format means your frontend or API consumers can check for the"," ",(0,b.jsx)("code",{children:"message"})," field and display appropriate UI — such as a setup prompt or a feature explanation — without error handling."]}),(0,b.jsx)(c.default,{language:"go",filename:"ai/provider.go",code:`// NewProvider creates the appropriate Provider based on configuration.
// Returns nil if AI is not configured.
func NewProvider(config *AIConfig) Provider {
    if config == nil || config.APIKey == "" {
        return nil
    }
    // ... create provider based on config.Provider
}`}),(0,b.jsx)("h3",{children:"Dashboard Behavior"}),(0,b.jsxs)("p",{children:["When AI is not configured, the dashboard AI Insights page detects the"," ",(0,b.jsx)("code",{children:'"AI not configured"'})," response and displays setup instructions instead of analysis results. This guides users through enabling the feature without showing error states."]}),(0,b.jsxs)(d.default,{type:"info",title:"No Breaking Changes",children:["You can safely enable or disable AI at any time by adding or removing the"," ",(0,b.jsx)("code",{children:"AI"})," config pointer. No other part of the system depends on AI being available. The WAF, rate limiter, anomaly detection, alerting, and all other features continue to operate normally regardless of AI configuration."]}),(0,b.jsx)("h2",{id:"dashboard",children:"Dashboard — AI Insights"}),(0,b.jsxs)("p",{children:["The Sentinel dashboard includes a dedicated ",(0,b.jsx)("strong",{children:"AI Insights"})," page that provides a visual interface for all five AI capabilities. Access it at"," ",(0,b.jsx)("code",{children:"http://localhost:8080/sentinel/ui"})," and navigate to the AI Insights section."]}),(0,b.jsxs)("ul",{children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Threat Analysis"}),' — Click the "Analyze with AI" button on any threat event detail page to generate an in-depth analysis. The result includes the summary, explanation, severity assessment, confidence score, and actionable recommendations.']}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Actor Assessment"})," — From any threat actor profile page, trigger an AI risk assessment. The result shows the actor's likely intent, sophistication level, overall risk rating, and recommended actions."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Daily Summary"})," — The AI Insights page features a daily summary section that provides a narrative overview of the last 24 hours, including highlights, top threats, trend analysis, and strategic recommendations."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Natural Language Query"})," — A chat-like interface where you can type questions about your security data in plain English and receive AI-generated answers grounded in your live data."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"WAF Recommendations"})," — A dedicated section that displays AI-suggested WAF rules with their patterns, severity levels, and the reasoning behind each recommendation. Review and apply them directly from the dashboard."]})]}),(0,b.jsx)("h2",{id:"testing",children:"Testing Without an API Key"}),(0,b.jsx)("p",{children:"You can run Sentinel with the AI feature unconfigured and everything works normally. The system gracefully handles the absence of an API key at every level:"}),(0,b.jsxs)("ol",{children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Provider creation"})," — ",(0,b.jsx)("code",{children:"ai.NewProvider(nil)"})," returns"," ",(0,b.jsx)("code",{children:"nil"})," when the config is ",(0,b.jsx)("code",{children:"nil"})," or the API key is empty. No provider is instantiated, no external connections are attempted."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"API handlers"})," — Every AI handler checks if ",(0,b.jsx)("code",{children:"aiProvider"})," is"," ",(0,b.jsx)("code",{children:"nil"})," before proceeding. If it is, the handler returns an HTTP 200 with"," ",(0,b.jsx)("code",{children:'{"data": null, "message": "AI not configured"}'}),"."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Dashboard"})," — The frontend checks the API response and shows setup instructions rather than error messages when AI is not available."]})]}),(0,b.jsx)(c.default,{language:"go",filename:"main.go",code:`// AI is completely optional — just omit the AI field
sentinel.Mount(r, nil, sentinel.Config{
    WAF: sentinel.WAFConfig{
        Enabled: true,
        Mode:    sentinel.ModeBlock,
    },
    // AI: nil — not configured, all AI endpoints return gracefully
})`}),(0,b.jsx)(d.default,{type:"success",title:"Safe to Explore",children:"You can explore the AI Insights page in the dashboard even without an API key. The page loads normally and shows helpful information about what each feature does, along with configuration instructions. This makes it easy to evaluate the feature before committing to an API provider."}),(0,b.jsx)("h2",{id:"full-example",children:"Full Configuration Example"}),(0,b.jsx)("p",{children:"The following example enables the WAF, alerting, and AI analysis with Claude. The AI system will analyze threats, assess actors, generate daily summaries, answer queries, and recommend WAF rules — all powered by Claude."}),(0,b.jsx)(c.default,{language:"go",filename:"main.go",code:`package main

import (
    "os"

    sentinel "github.com/MUKE-coder/sentinel"
    "github.com/gin-gonic/gin"
)

func main() {
    r := gin.Default()

    sentinel.Mount(r, nil, sentinel.Config{
        Dashboard: sentinel.DashboardConfig{
            Username:  "admin",
            Password:  "s3cur3-p4ss!",
            SecretKey: "my-jwt-secret-change-in-production",
        },

        WAF: sentinel.WAFConfig{
            Enabled: true,
            Mode:    sentinel.ModeBlock,
        },

        Alerts: sentinel.AlertConfig{
            MinSeverity: sentinel.SeverityHigh,
            Slack: &sentinel.SlackConfig{
                WebhookURL: os.Getenv("SLACK_WEBHOOK_URL"),
            },
        },

        // Enable AI analysis with Claude
        AI: &sentinel.AIConfig{
            Provider: sentinel.Claude,
            APIKey:   os.Getenv("ANTHROPIC_API_KEY"),
            // Model defaults to claude-sonnet-4-20250514
        },
    })

    r.GET("/api/data", func(c *gin.Context) {
        c.JSON(200, gin.H{"status": "ok"})
    })

    r.Run(":8080")
}`}),(0,b.jsx)("h2",{children:"Next Steps"}),(0,b.jsxs)("ul",{children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("a",{href:"/docs/waf",children:"WAF"})," — Configure the detection rules that generate threat events for AI analysis"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("a",{href:"/docs/threat-intelligence",children:"Threat Intelligence"})," — Enrich threat actor profiles that feed into AI assessments"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("a",{href:"/docs/alerting",children:"Alerting"})," — Get notified when high-severity threats are detected"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("a",{href:"/docs/anomaly-detection",children:"Anomaly Detection"})," — Add behavioral analysis that complements AI insights"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("a",{href:"/docs/the-dashboard",children:"Dashboard"})," — Explore the AI Insights page and other dashboard features"]})]})]})}a.s(["default",()=>e,"metadata",0,{title:"AI Analysis - Sentinel Docs"}])}];

//# sourceMappingURL=app_docs_ai-analysis_page_jsx_e802e540._.js.map