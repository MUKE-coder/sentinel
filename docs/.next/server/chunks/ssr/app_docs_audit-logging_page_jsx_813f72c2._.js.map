{"version":3,"sources":["../../../../app/docs/audit-logging/page.jsx"],"sourcesContent":["import CodeBlock from '@/components/CodeBlock';\nimport Callout from '@/components/Callout';\n\nexport const metadata = { title: 'Audit Logging - Sentinel Docs' };\n\nexport default function AuditLogging() {\n  return (\n    <>\n      <h1>Audit Logging</h1>\n      <p>\n        Sentinel includes a GORM plugin that automatically tracks every database mutation —\n        creates, updates, and deletes — and records them as immutable audit log entries. Every\n        change captures <em>who</em> made it, <em>what</em> changed (including before/after state\n        for updates), and <em>when</em> it happened. Audit entries flow through the Sentinel\n        pipeline asynchronously, so your application code is never blocked by audit writes.\n      </p>\n\n      <Callout type=\"info\" title=\"Optional Package\">\n        The GORM audit logging plugin lives in a separate package (<code>github.com/MUKE-coder/sentinel/gorm</code>).\n        It is completely optional — your core Sentinel middleware works independently. Import it\n        only if your application uses GORM and you want automatic database-level audit trails.\n      </Callout>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  INSTALLATION                                                      */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"installation\">Installation</h2>\n      <p>\n        The audit logging plugin requires two Sentinel packages: the GORM plugin itself and the\n        event pipeline that transports audit entries to storage.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"go imports\"\n        code={`import (\n    sentinelgorm \"github.com/MUKE-coder/sentinel/gorm\"\n    \"github.com/MUKE-coder/sentinel/pipeline\"\n)`}\n      />\n\n      <p>\n        Make sure both packages are available in your module:\n      </p>\n\n      <CodeBlock\n        language=\"bash\"\n        showLineNumbers={false}\n        code={`go get github.com/MUKE-coder/sentinel/gorm\ngo get github.com/MUKE-coder/sentinel/pipeline`}\n      />\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  SETUP                                                             */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"setup\">Setup</h2>\n      <p>\n        Setting up audit logging takes three steps: create a pipeline, start its background\n        workers, and register the plugin with your GORM database instance.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"main.go\"\n        code={`// 1. Create an event pipeline with a buffer of 10,000 events\npipe := pipeline.New(0) // 0 = DefaultBufferSize (10,000)\n\n// 2. Start background workers to process audit events\npipe.Start(2) // 2 worker goroutines\ndefer pipe.Stop()\n\n// 3. Register the Sentinel GORM plugin\ndb.Use(sentinelgorm.New(pipe))`}\n      />\n\n      <p>\n        By default, <code>sentinelgorm.New(pipe)</code> enables both audit logging and query\n        shielding (N+1 detection, unfiltered query warnings). You can selectively disable features\n        using option functions:\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        code={`// Audit logging only — disable query shielding\ndb.Use(sentinelgorm.New(pipe, func(c *sentinelgorm.Config) {\n    c.QueryShieldEnabled = false\n}))\n\n// Query shielding only — disable audit logging\ndb.Use(sentinelgorm.New(pipe, func(c *sentinelgorm.Config) {\n    c.AuditEnabled = false\n}))`}\n      />\n\n      <h3>Plugin Config</h3>\n      <table>\n        <thead>\n          <tr>\n            <th>Field</th>\n            <th>Type</th>\n            <th>Default</th>\n            <th>Description</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><code>AuditEnabled</code></td>\n            <td><code>bool</code></td>\n            <td><code>true</code></td>\n            <td>Enables audit logging for CREATE, UPDATE, and DELETE operations.</td>\n          </tr>\n          <tr>\n            <td><code>QueryShieldEnabled</code></td>\n            <td><code>bool</code></td>\n            <td><code>true</code></td>\n            <td>Enables query analysis (N+1 detection, unfiltered query warnings).</td>\n          </tr>\n          <tr>\n            <td><code>SlowQueryThreshold</code></td>\n            <td><code>time.Duration</code></td>\n            <td><code>200ms</code></td>\n            <td>Queries slower than this duration are flagged.</td>\n          </tr>\n          <tr>\n            <td><code>N1QueryThreshold</code></td>\n            <td><code>int</code></td>\n            <td><code>10</code></td>\n            <td>Number of same-table queries in a single request before flagging as N+1.</td>\n          </tr>\n        </tbody>\n      </table>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  REQUEST CONTEXT                                                   */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"request-context\">Request Context</h2>\n      <p>\n        For audit entries to include <em>who</em> performed the action, you need to attach request\n        metadata to the GORM context using <code>sentinelgorm.WithRequestInfo()</code>. This\n        connects each database operation back to the originating HTTP request.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"handler.go\"\n        code={`func CreateProductHandler(c *gin.Context) {\n    // Build request info from the current HTTP request\n    ctx := sentinelgorm.WithRequestInfo(c.Request.Context(), &sentinelgorm.RequestInfo{\n        IP:        c.ClientIP(),\n        UserID:    c.GetString(\"user_id\"),    // from your auth middleware\n        UserEmail: c.GetString(\"user_email\"),\n        UserRole:  c.GetString(\"user_role\"),\n        UserAgent: c.Request.UserAgent(),\n        RequestID: c.GetString(\"request_id\"),\n    })\n\n    product := Product{Name: \"Widget\", Price: 9.99}\n\n    // Use db.WithContext(ctx) so the plugin picks up the request info\n    if err := db.WithContext(ctx).Create(&product).Error; err != nil {\n        c.JSON(500, gin.H{\"error\": err.Error()})\n        return\n    }\n\n    c.JSON(201, product)\n}`}\n      />\n\n      <Callout type=\"warning\" title=\"Context is Required for Attribution\">\n        If you call <code>db.Create(&record)</code> without attaching request info via{' '}\n        <code>WithContext</code>, the audit entry is still created but the <code>UserID</code>,{' '}\n        <code>IP</code>, and <code>UserAgent</code> fields will be empty. Always use{' '}\n        <code>db.WithContext(ctx)</code> in your HTTP handlers for full attribution.\n      </Callout>\n\n      <h3>RequestInfo Fields</h3>\n      <table>\n        <thead>\n          <tr>\n            <th>Field</th>\n            <th>Type</th>\n            <th>Description</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><code>IP</code></td>\n            <td><code>string</code></td>\n            <td>Client IP address of the request originator.</td>\n          </tr>\n          <tr>\n            <td><code>UserID</code></td>\n            <td><code>string</code></td>\n            <td>Authenticated user identifier (from your auth middleware).</td>\n          </tr>\n          <tr>\n            <td><code>UserEmail</code></td>\n            <td><code>string</code></td>\n            <td>Email address of the authenticated user.</td>\n          </tr>\n          <tr>\n            <td><code>UserRole</code></td>\n            <td><code>string</code></td>\n            <td>Role of the authenticated user (e.g., <code>\"admin\"</code>, <code>\"editor\"</code>).</td>\n          </tr>\n          <tr>\n            <td><code>UserAgent</code></td>\n            <td><code>string</code></td>\n            <td>The User-Agent header from the HTTP request.</td>\n          </tr>\n          <tr>\n            <td><code>RequestID</code></td>\n            <td><code>string</code></td>\n            <td>Unique request identifier for correlating multiple audit entries from a single request.</td>\n          </tr>\n        </tbody>\n      </table>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  WHAT GETS LOGGED                                                  */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"what-gets-logged\">What Gets Logged</h2>\n      <p>\n        The plugin hooks into GORM callbacks for all mutation operations. Every CREATE, UPDATE,\n        and DELETE that passes through GORM produces an audit entry. Read operations (SELECT) are\n        not audited — they are handled separately by the query shield feature.\n      </p>\n\n      <table>\n        <thead>\n          <tr>\n            <th>Operation</th>\n            <th>Action Value</th>\n            <th>Before State</th>\n            <th>After State</th>\n            <th>Description</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><strong>Create</strong></td>\n            <td><code>CREATE</code></td>\n            <td>-</td>\n            <td>Full record</td>\n            <td>Captures the complete newly created record.</td>\n          </tr>\n          <tr>\n            <td><strong>Update</strong></td>\n            <td><code>UPDATE</code></td>\n            <td>Record before change</td>\n            <td>Record after change</td>\n            <td>Captures both the previous and new state so you can diff exactly what changed.</td>\n          </tr>\n          <tr>\n            <td><strong>Delete</strong></td>\n            <td><code>DELETE</code></td>\n            <td>Record before deletion</td>\n            <td>-</td>\n            <td>Captures the full record state before it was removed.</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <p>Each audit entry also records:</p>\n      <ul>\n        <li><strong>Table name</strong> — which database table was affected (e.g., <code>users</code>, <code>products</code>)</li>\n        <li><strong>Record ID</strong> — the primary key of the affected record</li>\n        <li><strong>User attribution</strong> — UserID, UserEmail, UserRole from the request context</li>\n        <li><strong>Request metadata</strong> — IP address, User-Agent, RequestID</li>\n        <li><strong>Timestamp</strong> — when the operation occurred</li>\n        <li><strong>Success flag</strong> — whether the database operation succeeded</li>\n      </ul>\n\n      <Callout type=\"success\" title=\"Before/After Diffing\">\n        For UPDATE operations, the plugin captures the model state before the update runs (in a{' '}\n        <code>Before</code> callback) and after it completes. Both states are serialized as JSON,\n        giving you a complete before/after snapshot that you can diff to see exactly which fields\n        changed.\n      </Callout>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  THE AUDITLOG MODEL                                                */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"audit-log-model\">The AuditLog Model</h2>\n      <p>\n        Every audit entry is represented by the <code>AuditLog</code> struct defined in the{' '}\n        <code>core</code> package. This is the shape of the data that gets stored and returned by\n        the API.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"core/models.go\"\n        code={`// AuditLog represents an immutable audit trail entry.\ntype AuditLog struct {\n    ID         string    \\`json:\"id\"\\`\n    Timestamp  time.Time \\`json:\"timestamp\"\\`\n    UserID     string    \\`json:\"user_id\"\\`\n    UserEmail  string    \\`json:\"user_email,omitempty\"\\`\n    UserRole   string    \\`json:\"user_role,omitempty\"\\`\n    Action     string    \\`json:\"action\"\\`\n    Resource   string    \\`json:\"resource\"\\`\n    ResourceID string    \\`json:\"resource_id\"\\`\n    Before     JSONMap   \\`json:\"before,omitempty\"\\`\n    After      JSONMap   \\`json:\"after,omitempty\"\\`\n    IP         string    \\`json:\"ip\"\\`\n    UserAgent  string    \\`json:\"user_agent\"\\`\n    Success    bool      \\`json:\"success\"\\`\n    Error      string    \\`json:\"error,omitempty\"\\`\n    RequestID  string    \\`json:\"request_id\"\\`\n}`}\n      />\n\n      <h3>Field Reference</h3>\n      <table>\n        <thead>\n          <tr>\n            <th>Field</th>\n            <th>Type</th>\n            <th>Description</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><code>ID</code></td>\n            <td><code>string</code></td>\n            <td>UUID v4 unique identifier for the audit entry.</td>\n          </tr>\n          <tr>\n            <td><code>Timestamp</code></td>\n            <td><code>time.Time</code></td>\n            <td>When the database operation occurred.</td>\n          </tr>\n          <tr>\n            <td><code>UserID</code></td>\n            <td><code>string</code></td>\n            <td>ID of the user who performed the operation.</td>\n          </tr>\n          <tr>\n            <td><code>UserEmail</code></td>\n            <td><code>string</code></td>\n            <td>Email of the user (omitted if empty).</td>\n          </tr>\n          <tr>\n            <td><code>UserRole</code></td>\n            <td><code>string</code></td>\n            <td>Role of the user (omitted if empty).</td>\n          </tr>\n          <tr>\n            <td><code>Action</code></td>\n            <td><code>string</code></td>\n            <td>The operation type: <code>CREATE</code>, <code>UPDATE</code>, or <code>DELETE</code>.</td>\n          </tr>\n          <tr>\n            <td><code>Resource</code></td>\n            <td><code>string</code></td>\n            <td>The database table name (e.g., <code>users</code>, <code>orders</code>).</td>\n          </tr>\n          <tr>\n            <td><code>ResourceID</code></td>\n            <td><code>string</code></td>\n            <td>The primary key value of the affected record.</td>\n          </tr>\n          <tr>\n            <td><code>Before</code></td>\n            <td><code>JSONMap</code></td>\n            <td>JSON snapshot of the record before the change. Present for UPDATE and DELETE; omitted for CREATE.</td>\n          </tr>\n          <tr>\n            <td><code>After</code></td>\n            <td><code>JSONMap</code></td>\n            <td>JSON snapshot of the record after the change. Present for CREATE and UPDATE; omitted for DELETE.</td>\n          </tr>\n          <tr>\n            <td><code>IP</code></td>\n            <td><code>string</code></td>\n            <td>Client IP address from the request context.</td>\n          </tr>\n          <tr>\n            <td><code>UserAgent</code></td>\n            <td><code>string</code></td>\n            <td>User-Agent header from the request context.</td>\n          </tr>\n          <tr>\n            <td><code>Success</code></td>\n            <td><code>bool</code></td>\n            <td>Whether the database operation completed without error.</td>\n          </tr>\n          <tr>\n            <td><code>Error</code></td>\n            <td><code>string</code></td>\n            <td>Error message if the operation failed (omitted on success).</td>\n          </tr>\n          <tr>\n            <td><code>RequestID</code></td>\n            <td><code>string</code></td>\n            <td>Correlation ID to link multiple audit entries from a single HTTP request.</td>\n          </tr>\n        </tbody>\n      </table>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  FULL EXAMPLE                                                      */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"full-example\">Full Example</h2>\n      <p>\n        The following example shows a complete <code>main.go</code> that sets up Sentinel with the\n        GORM audit logging plugin, creates an HTTP handler that attaches request context, and\n        performs a database mutation that produces an audit trail entry.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"main.go\"\n        code={`package main\n\nimport (\n    \"net/http\"\n\n    sentinel \"github.com/MUKE-coder/sentinel\"\n    sentinelgorm \"github.com/MUKE-coder/sentinel/gorm\"\n    \"github.com/MUKE-coder/sentinel/pipeline\"\n    \"github.com/gin-gonic/gin\"\n    \"gorm.io/driver/sqlite\"\n    \"gorm.io/gorm\"\n)\n\ntype Product struct {\n    ID    uint    \\`gorm:\"primaryKey\" json:\"id\"\\`\n    Name  string  \\`json:\"name\"\\`\n    Price float64 \\`json:\"price\"\\`\n}\n\nfunc main() {\n    // --- Database setup ---\n    db, err := gorm.Open(sqlite.Open(\"app.db\"), &gorm.Config{})\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n    db.AutoMigrate(&Product{})\n\n    // --- Pipeline setup ---\n    pipe := pipeline.New(0) // default 10,000 buffer\n    pipe.Start(2)\n    defer pipe.Stop()\n\n    // --- Register GORM audit plugin ---\n    db.Use(sentinelgorm.New(pipe))\n\n    // --- Gin router ---\n    r := gin.Default()\n\n    // Mount Sentinel middleware + dashboard\n    sentinel.Mount(r, pipe, sentinel.Config{\n        WAF: sentinel.WAFConfig{\n            Enabled: true,\n            Mode:    sentinel.ModeBlock,\n        },\n    })\n\n    // --- Routes ---\n    r.POST(\"/api/products\", func(c *gin.Context) {\n        // Attach request info so audit entries include user attribution\n        ctx := sentinelgorm.WithRequestInfo(c.Request.Context(), &sentinelgorm.RequestInfo{\n            IP:        c.ClientIP(),\n            UserID:    c.GetString(\"user_id\"),\n            UserEmail: c.GetString(\"user_email\"),\n            UserRole:  c.GetString(\"user_role\"),\n            UserAgent: c.Request.UserAgent(),\n            RequestID: c.GetHeader(\"X-Request-ID\"),\n        })\n\n        var product Product\n        if err := c.ShouldBindJSON(&product); err != nil {\n            c.JSON(http.StatusBadRequest, gin.H{\"error\": err.Error()})\n            return\n        }\n\n        // This Create() call automatically generates an audit log entry\n        if err := db.WithContext(ctx).Create(&product).Error; err != nil {\n            c.JSON(http.StatusInternalServerError, gin.H{\"error\": err.Error()})\n            return\n        }\n\n        c.JSON(http.StatusCreated, product)\n    })\n\n    r.PUT(\"/api/products/:id\", func(c *gin.Context) {\n        ctx := sentinelgorm.WithRequestInfo(c.Request.Context(), &sentinelgorm.RequestInfo{\n            IP:        c.ClientIP(),\n            UserID:    c.GetString(\"user_id\"),\n            UserEmail: c.GetString(\"user_email\"),\n            UserAgent: c.Request.UserAgent(),\n        })\n\n        var product Product\n        if err := db.WithContext(ctx).First(&product, c.Param(\"id\")).Error; err != nil {\n            c.JSON(http.StatusNotFound, gin.H{\"error\": \"not found\"})\n            return\n        }\n\n        if err := c.ShouldBindJSON(&product); err != nil {\n            c.JSON(http.StatusBadRequest, gin.H{\"error\": err.Error()})\n            return\n        }\n\n        // This Save() call generates an UPDATE audit log with before/after state\n        if err := db.WithContext(ctx).Save(&product).Error; err != nil {\n            c.JSON(http.StatusInternalServerError, gin.H{\"error\": err.Error()})\n            return\n        }\n\n        c.JSON(http.StatusOK, product)\n    })\n\n    r.DELETE(\"/api/products/:id\", func(c *gin.Context) {\n        ctx := sentinelgorm.WithRequestInfo(c.Request.Context(), &sentinelgorm.RequestInfo{\n            IP:        c.ClientIP(),\n            UserID:    c.GetString(\"user_id\"),\n            UserAgent: c.Request.UserAgent(),\n        })\n\n        var product Product\n        if err := db.WithContext(ctx).First(&product, c.Param(\"id\")).Error; err != nil {\n            c.JSON(http.StatusNotFound, gin.H{\"error\": \"not found\"})\n            return\n        }\n\n        // This Delete() call generates a DELETE audit log with the before state\n        if err := db.WithContext(ctx).Delete(&product).Error; err != nil {\n            c.JSON(http.StatusInternalServerError, gin.H{\"error\": err.Error()})\n            return\n        }\n\n        c.JSON(http.StatusOK, gin.H{\"message\": \"deleted\"})\n    })\n\n    r.Run(\":8080\")\n}`}\n      />\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  DASHBOARD                                                         */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"dashboard\">Dashboard</h2>\n      <p>\n        The Sentinel dashboard includes a dedicated Audit Logs page that provides a searchable,\n        filterable view of your entire audit trail. Access it at{' '}\n        <code>http://localhost:8080/sentinel/ui</code> and navigate to the Audit Logs section.\n      </p>\n\n      <ul>\n        <li>\n          <strong>Search and filter</strong> — filter audit entries by user ID, action type\n          (CREATE, UPDATE, DELETE), resource (table name), and date range.\n        </li>\n        <li>\n          <strong>Before/after diff</strong> — expand any UPDATE entry to see the full\n          before and after JSON state side by side.\n        </li>\n        <li>\n          <strong>User attribution</strong> — each entry shows who performed the action,\n          from which IP, and with which user agent.\n        </li>\n        <li>\n          <strong>Pagination</strong> — large audit trails are paginated for fast browsing.\n        </li>\n      </ul>\n\n      <Callout type=\"info\" title=\"Dashboard Access\">\n        The audit logs page is part of the Sentinel dashboard UI. It is available automatically\n        when you call <code>sentinel.Mount()</code> — no additional configuration is needed beyond\n        setting up the GORM plugin.\n      </Callout>\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  API                                                               */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"api\">API</h2>\n      <p>\n        Audit logs are available via the Sentinel REST API. Use the{' '}\n        <code>GET /sentinel/api/audit-logs</code> endpoint to query the audit trail\n        programmatically.\n      </p>\n\n      <h3>Query Parameters</h3>\n      <table>\n        <thead>\n          <tr>\n            <th>Parameter</th>\n            <th>Type</th>\n            <th>Default</th>\n            <th>Description</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td><code>user_id</code></td>\n            <td><code>string</code></td>\n            <td>-</td>\n            <td>Filter by the user who performed the action.</td>\n          </tr>\n          <tr>\n            <td><code>action</code></td>\n            <td><code>string</code></td>\n            <td>-</td>\n            <td>Filter by action type: <code>CREATE</code>, <code>UPDATE</code>, or <code>DELETE</code>.</td>\n          </tr>\n          <tr>\n            <td><code>resource</code></td>\n            <td><code>string</code></td>\n            <td>-</td>\n            <td>Filter by table name (e.g., <code>users</code>, <code>products</code>).</td>\n          </tr>\n          <tr>\n            <td><code>start_time</code></td>\n            <td><code>string</code></td>\n            <td>-</td>\n            <td>ISO 8601 / RFC 3339 timestamp. Only return entries after this time.</td>\n          </tr>\n          <tr>\n            <td><code>end_time</code></td>\n            <td><code>string</code></td>\n            <td>-</td>\n            <td>ISO 8601 / RFC 3339 timestamp. Only return entries before this time.</td>\n          </tr>\n          <tr>\n            <td><code>page</code></td>\n            <td><code>int</code></td>\n            <td><code>1</code></td>\n            <td>Page number for pagination.</td>\n          </tr>\n          <tr>\n            <td><code>page_size</code></td>\n            <td><code>int</code></td>\n            <td><code>20</code></td>\n            <td>Number of entries per page.</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <h3>Example Request</h3>\n      <CodeBlock\n        language=\"bash\"\n        showLineNumbers={false}\n        code={`curl \"http://localhost:8080/sentinel/api/audit-logs?action=UPDATE&resource=products&page=1&page_size=10\"`}\n      />\n\n      <h3>Example Response</h3>\n      <CodeBlock\n        language=\"json\"\n        filename=\"Response\"\n        showLineNumbers={false}\n        code={`{\n  \"data\": [\n    {\n      \"id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n      \"timestamp\": \"2025-01-15T14:30:00Z\",\n      \"user_id\": \"user-42\",\n      \"user_email\": \"admin@example.com\",\n      \"user_role\": \"admin\",\n      \"action\": \"UPDATE\",\n      \"resource\": \"products\",\n      \"resource_id\": \"7\",\n      \"before\": {\n        \"id\": 7,\n        \"name\": \"Widget\",\n        \"price\": 9.99\n      },\n      \"after\": {\n        \"id\": 7,\n        \"name\": \"Widget Pro\",\n        \"price\": 14.99\n      },\n      \"ip\": \"10.0.0.1\",\n      \"user_agent\": \"Mozilla/5.0 ...\",\n      \"success\": true,\n      \"request_id\": \"req-abc-123\"\n    }\n  ],\n  \"meta\": {\n    \"total\": 1,\n    \"page\": 1,\n    \"page_size\": 10\n  }\n}`}\n      />\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  TESTING                                                           */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2 id=\"testing\">Testing</h2>\n      <p>\n        You can verify that audit entries are being generated by writing a test that collects\n        events from the pipeline. The pattern below uses an in-memory SQLite database and a\n        custom pipeline handler that captures audit events.\n      </p>\n\n      <CodeBlock\n        language=\"go\"\n        filename=\"audit_test.go\"\n        code={`package main_test\n\nimport (\n    \"context\"\n    \"sync\"\n    \"testing\"\n    \"time\"\n\n    sentinel \"github.com/MUKE-coder/sentinel/core\"\n    sentinelgorm \"github.com/MUKE-coder/sentinel/gorm\"\n    \"github.com/MUKE-coder/sentinel/pipeline\"\n    \"github.com/glebarez/sqlite\"\n    \"gorm.io/gorm\"\n)\n\ntype Product struct {\n    ID    uint    \\`gorm:\"primaryKey\" json:\"id\"\\`\n    Name  string  \\`json:\"name\"\\`\n    Price float64 \\`json:\"price\"\\`\n}\n\n// auditCollector captures audit events from the pipeline.\ntype auditCollector struct {\n    mu     sync.Mutex\n    audits []*sentinel.AuditLog\n}\n\nfunc (ac *auditCollector) Handle(ctx context.Context, event pipeline.Event) error {\n    if event.Type == pipeline.EventAudit {\n        if al, ok := event.Payload.(*sentinel.AuditLog); ok {\n            ac.mu.Lock()\n            ac.audits = append(ac.audits, al)\n            ac.mu.Unlock()\n        }\n    }\n    return nil\n}\n\nfunc TestAuditLogging(t *testing.T) {\n    // Set up pipeline with a collector\n    pipe := pipeline.New(100)\n    collector := &auditCollector{}\n    pipe.AddHandler(collector)\n    pipe.Start(1)\n    defer pipe.Stop()\n\n    // Open in-memory SQLite\n    db, err := gorm.Open(sqlite.Open(\":memory:\"), &gorm.Config{})\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    // Register plugin and migrate\n    db.Use(sentinelgorm.New(pipe))\n    db.AutoMigrate(&Product{})\n\n    // Attach request info\n    ctx := sentinelgorm.WithRequestInfo(context.Background(), &sentinelgorm.RequestInfo{\n        IP:     \"10.0.0.1\",\n        UserID: \"user-42\",\n    })\n\n    // CREATE — should produce an audit entry\n    product := Product{Name: \"Widget\", Price: 9.99}\n    db.WithContext(ctx).Create(&product)\n\n    // Wait for async pipeline processing\n    time.Sleep(100 * time.Millisecond)\n\n    // Verify the audit entry\n    collector.mu.Lock()\n    defer collector.mu.Unlock()\n\n    if len(collector.audits) != 1 {\n        t.Fatalf(\"expected 1 audit entry, got %d\", len(collector.audits))\n    }\n\n    entry := collector.audits[0]\n    if entry.Action != \"CREATE\" {\n        t.Errorf(\"expected action CREATE, got %s\", entry.Action)\n    }\n    if entry.Resource != \"products\" {\n        t.Errorf(\"expected resource products, got %s\", entry.Resource)\n    }\n    if entry.UserID != \"user-42\" {\n        t.Errorf(\"expected user_id user-42, got %s\", entry.UserID)\n    }\n    if entry.IP != \"10.0.0.1\" {\n        t.Errorf(\"expected IP 10.0.0.1, got %s\", entry.IP)\n    }\n    if entry.After == nil {\n        t.Error(\"expected After state to be present\")\n    }\n    if entry.After[\"name\"] != \"Widget\" {\n        t.Errorf(\"expected After.name=Widget, got %v\", entry.After[\"name\"])\n    }\n}`}\n      />\n\n      <Callout type=\"info\" title=\"Pipeline is Asynchronous\">\n        Audit events are processed asynchronously by pipeline workers. In tests, add a short{' '}\n        <code>time.Sleep</code> (50-100ms) after database operations to allow the pipeline to\n        flush before asserting on collected audit entries.\n      </Callout>\n\n      <p>\n        You can also verify audit entries via the API in an integration test by sending an HTTP\n        request and then querying the audit logs endpoint:\n      </p>\n\n      <CodeBlock\n        language=\"bash\"\n        showLineNumbers={false}\n        code={`# Create a product\ncurl -X POST http://localhost:8080/api/products \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\"name\": \"Widget\", \"price\": 9.99}'\n\n# Check audit trail\ncurl \"http://localhost:8080/sentinel/api/audit-logs?resource=products&action=CREATE\"`}\n      />\n\n      {/* ------------------------------------------------------------------ */}\n      {/*  NEXT STEPS                                                        */}\n      {/* ------------------------------------------------------------------ */}\n\n      <h2>Next Steps</h2>\n      <ul>\n        <li><a href=\"/docs/getting-started\">Getting Started</a> — Set up the core Sentinel middleware</li>\n        <li><a href=\"/docs/the-dashboard\">Dashboard</a> — Browse audit logs and other security data in the UI</li>\n        <li><a href=\"/docs/performance\">Performance</a> — Monitor route-level performance alongside audit trails</li>\n        <li><a href=\"/docs/alerting\">Alerting</a> — Get notified when threat events occur</li>\n        <li><a href=\"/docs/waf\">WAF</a> — Protect your application from common web attacks</li>\n      </ul>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}