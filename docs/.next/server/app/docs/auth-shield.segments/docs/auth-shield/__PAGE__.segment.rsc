1:"$Sreact.fragment"
2d:I[99151,["/_next/static/chunks/4cc5a908347f559b.js","/_next/static/chunks/c23263069b7f7ba3.js","/_next/static/chunks/2425b678dfc0c3cf.js"],"default"]
2f:I[35417,["/_next/static/chunks/26ca110782d86623.js","/_next/static/chunks/81f0f13d25d49d65.js"],"OutletBoundary"]
30:"$Sreact.suspense"
0:{"buildId":"5Swj18oapgqGqSZX8fol6","rsc":["$","$1","c",{"children":[[["$","h1",null,{"children":"Auth Shield"}],["$","p",null,{"children":"Auth Shield protects your login endpoints from brute-force attacks and credential stuffing. When enabled, it monitors authentication attempts per IP, automatically locks out offending clients after repeated failures, and emits threat events into the Sentinel pipeline."}],["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300","children":"How It Differs from Rate Limiting"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["Rate limiting controls overall request volume. Auth Shield is purpose-built for login endpoints — it tracks ",["$","strong",null,{"children":"failed authentication outcomes"}]," (non-2xx responses), not just request counts. A legitimate user who logs in successfully on the first try is never affected."]}]]}]]}]}],["$","h2",null,{"id":"configuration","children":"Configuration"}],["$","p",null,{"children":["Auth Shield is configured through the ",["$","code",null,{"children":"AuthShieldConfig"}]," section of"," ",["$","code",null,{"children":"sentinel.Config"}],". All fields have sensible defaults except"," ",["$","code",null,{"children":"LoginRoute"}],", which must match your actual login endpoint path."]}],["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Field"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Default"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Enabled"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":"Enables the Auth Shield middleware."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"LoginRoute"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":["$","code",null,{"children":"\"\""}]}],["$","td",null,{"children":["The exact path of your login endpoint (e.g., ",["$","code",null,{"children":"/api/login"}],"). Must match the route registered in Gin."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"MaxFailedAttempts"}]}],["$","td",null,{"children":["$","code",null,{"children":"int"}]}],["$","td",null,{"children":["$","code",null,{"children":"5"}]}],["$","td",null,{"children":"Number of failed login attempts within the lockout window before the IP is locked out."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"LockoutDuration"}]}],["$","td",null,{"children":["$","code",null,{"children":"time.Duration"}]}],["$","td",null,{"children":["$","code",null,{"children":"15 * time.Minute"}]}],["$","td",null,{"children":["How long an IP remains locked out after exceeding ",["$","code",null,{"children":"MaxFailedAttempts"}],". Also used as the sliding window for counting failures."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"CredentialStuffingDetection"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":"When enabled, detects a single IP trying many different usernames (more than 10 unique usernames within the window)."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"BruteForceDetection"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":"When enabled, detects repeated password guessing against the same username."}]]}]]}]]}],"$L2","$L3","$L4","$L5","$L6","$L7","$L8","$L9","$La","$Lb","$Lc","$Ld","$Le","$Lf","$L10","$L11","$L12","$L13","$L14","$L15","$L16","$L17","$L18","$L19","$L1a","$L1b","$L1c","$L1d","$L1e","$L1f","$L20","$L21","$L22","$L23","$L24","$L25","$L26","$L27","$L28","$L29","$L2a"],["$L2b"],"$L2c"]}],"loading":null,"isPartial":false}
2:["$","h2",null,{"id":"how-it-works","children":"How It Works"}]
3:["$","p",null,{"children":["Auth Shield registers as Gin middleware and intercepts only ",["$","code",null,{"children":"POST"}]," requests to the configured ",["$","code",null,{"children":"LoginRoute"}],". All other routes and HTTP methods pass through untouched. The flow is:"]}]
4:["$","ol",null,{"children":[["$","li",null,{"children":[["$","strong",null,{"children":"Pre-check"}]," — Before your login handler runs, Auth Shield checks if the client IP is currently locked out. If it is, the request is immediately rejected with a ",["$","code",null,{"children":"429 Too Many Requests"}]," response."]}],["$","li",null,{"children":[["$","strong",null,{"children":"Passthrough"}]," — If the IP is not locked, the request proceeds to your login handler as normal."]}],["$","li",null,{"children":[["$","strong",null,{"children":"Observe response"}]," — After your handler responds, Auth Shield inspects the HTTP status code:",["$","ul",null,{"children":[["$","li",null,{"children":[["$","strong",null,{"children":"2xx"}]," — Successful login. The failure counter for that IP (and username, if provided) is reset to zero."]}],["$","li",null,{"children":[["$","strong",null,{"children":"4xx"}]," — Failed login. The failure is recorded with a timestamp."]}]]}]]}],["$","li",null,{"children":[["$","strong",null,{"children":"Lockout"}]," — If the number of failures from an IP within the"," ",["$","code",null,{"children":"LockoutDuration"}]," window reaches ",["$","code",null,{"children":"MaxFailedAttempts"}],", the IP is locked out for the full ",["$","code",null,{"children":"LockoutDuration"}],"."]}]]}]
5:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300","children":"LoginRoute Must Match Exactly"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["The ",["$","code",null,{"children":"LoginRoute"}]," must be the exact path string of your login handler (e.g.,"," ",["$","code",null,{"children":"/api/login"}],"). It is compared against ",["$","code",null,{"children":"c.Request.URL.Path"}],". If it does not match, Auth Shield will not intercept the request and no failures will be tracked."]}]]}]]}]}]
6:["$","h2",null,{"id":"example","children":"Example Configuration"}]
7:["$","p",null,{"children":"A typical production setup with 5 allowed attempts and a 15-minute lockout:"}]
2e:T448,package main

import (
    "time"

    sentinel "github.com/MUKE-coder/sentinel"
    "github.com/gin-gonic/gin"
)

func main() {
    r := gin.Default()

    sentinel.Mount(r, nil, sentinel.Config{
        AuthShield: sentinel.AuthShieldConfig{
            Enabled:                    true,
            LoginRoute:                 "/api/login",
            MaxFailedAttempts:          5,
            LockoutDuration:            15 * time.Minute,
            CredentialStuffingDetection: true,
            BruteForceDetection:        true,
        },
    })

    r.POST("/api/login", func(c *gin.Context) {
        // Your login logic here
        username := c.PostForm("username")
        password := c.PostForm("password")

        // Optionally set the username so Auth Shield can track per-user failures
        c.Set("sentinel_username", username)

        if username == "admin" && password == "correct-password" {
            c.JSON(200, gin.H{"token": "jwt-token-here"})
        } else {
            c.JSON(401, gin.H{"error": "Invalid credentials"})
        }
    })

    r.Run(":8080")
}8:["$","$L2d",null,{"language":"go","filename":"main.go","code":"$2e"}]
9:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300","children":"Username Tracking"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["To enable per-username failure tracking and credential stuffing detection, set"," ",["$","code",null,{"children":"c.Set(\"sentinel_username\", username)"}]," in your login handler before writing the response. Auth Shield reads this value from the Gin context. If not set, only IP-based tracking is used."]}]]}]]}]}]
a:["$","h2",null,{"id":"tracking","children":"What Gets Tracked"}]
b:["$","p",null,{"children":"Auth Shield determines success or failure based on the HTTP status code returned by your login handler:"}]
c:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Status Code"}],["$","th",null,{"children":"Interpretation"}],["$","th",null,{"children":"Action"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"200-299"}]}],["$","td",null,{"children":"Successful login"}],["$","td",null,{"children":"Reset all failure counters for the IP and username."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"400-499"}]}],["$","td",null,{"children":"Failed login"}],["$","td",null,{"children":["Increment the failure counter. Lock the IP if ",["$","code",null,{"children":"MaxFailedAttempts"}]," is reached."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"500+"}]}],["$","td",null,{"children":"Server error"}],["$","td",null,{"children":"Ignored. Server errors are not counted as failed login attempts."}]]}]]}]]}]
d:["$","p",null,{"children":["Failure timestamps older than ",["$","code",null,{"children":"LockoutDuration"}]," are automatically pruned from the sliding window, so a slow trickle of failures over a long period will not trigger a lockout."]}]
e:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500","children":[["$","path","yps3ct",{"d":"M21.801 10A10 10 0 1 1 17 3.335"}],["$","path","1pflzl",{"d":"m9 11 3 3L22 4"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-green-800 dark:text-green-300","children":"Design Your Login Handler Accordingly"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["Return a ",["$","code",null,{"children":"401"}]," for invalid credentials and a ",["$","code",null,{"children":"200"}]," for successful logins. Avoid returning ",["$","code",null,{"children":"200"}]," with an error in the body, as Auth Shield will treat it as a success and reset the counter."]}]]}]]}]}]
f:["$","h2",null,{"id":"lockout-response","children":"Lockout Response"}]
10:["$","p",null,{"children":"When a locked-out IP attempts to access the login route, Auth Shield returns the following response without invoking your login handler:"}]
11:["$","$L2d",null,{"language":"json","filename":"429 Too Many Requests","showLineNumbers":false,"code":"{\n  \"error\": \"Too many failed login attempts. Please try again later.\",\n  \"code\": \"AUTH_SHIELD_LOCKED\"\n}"}]
12:["$","h2",null,{"id":"events","children":"Events"}]
13:["$","p",null,{"children":"Auth Shield emits threat events into the Sentinel pipeline whenever a lockout is triggered or credential stuffing is detected. These events flow through the same pipeline as WAF and anomaly events, meaning they are:"}]
14:["$","ul",null,{"children":[["$","li",null,{"children":"Stored in the configured storage backend"}],["$","li",null,{"children":"Visible in the dashboard Threats page"}],["$","li",null,{"children":"Eligible for alerting (Slack, email, webhook) based on severity"}],["$","li",null,{"children":"Available for AI analysis if an AI provider is configured"}]]}]
15:["$","h3",null,{"children":"Threat Event Types"}]
16:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Threat Type"}],["$","th",null,{"children":"Trigger"}],["$","th",null,{"children":"Severity"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"BruteForce"}]}],["$","td",null,{"children":["IP locked out after exceeding ",["$","code",null,{"children":"MaxFailedAttempts"}]]}],["$","td",null,{"children":"High"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"CredentialStuffing"}]}],["$","td",null,{"children":"Single IP tries more than 10 different usernames within the window"}],["$","td",null,{"children":"High"}]]}]]}]]}]
17:["$","p",null,{"children":"Each event includes the offending IP, the login route path, a confidence score of 90, and evidence detailing the specific detection pattern."}]
18:["$","h2",null,{"id":"testing","children":"Testing"}]
19:["$","p",null,{"children":"You can verify Auth Shield is working by sending failed login requests and observing the lockout behavior. The following example assumes the default configuration with 5 max attempts."}]
1a:["$","h3",null,{"children":"Trigger a Lockout"}]
1b:["$","$L2d",null,{"language":"bash","showLineNumbers":false,"code":"# Send 5 failed login attempts (invalid credentials)\nfor i in $(seq 1 5); do\n  echo \"Attempt $i:\"\n  curl -s -o /dev/null -w \"HTTP %{http_code}\" \\\n    -X POST http://localhost:8080/api/login \\\n    -d \"username=admin&password=wrong\"\n  echo \"\"\ndone\n\n# Attempt 1-5: HTTP 401 (failed login, counter incrementing)\n# After 5 failures, the IP is now locked out."}]
1c:["$","h3",null,{"children":"Verify the Lockout"}]
1d:["$","$L2d",null,{"language":"bash","showLineNumbers":false,"code":"# The 6th attempt should return 429 (locked out)\ncurl -s -w \"\\nHTTP %{http_code}\\n\" \\\n  -X POST http://localhost:8080/api/login \\\n  -d \"username=admin&password=wrong\"\n\n# Expected output:\n# {\"error\":\"Too many failed login attempts. Please try again later.\",\"code\":\"AUTH_SHIELD_LOCKED\"}\n# HTTP 429"}]
1e:["$","h3",null,{"children":"Verify Successful Login Still Works (from a different IP)"}]
1f:["$","$L2d",null,{"language":"bash","showLineNumbers":false,"code":"# Even correct credentials from the locked IP are rejected\ncurl -s -w \"\\nHTTP %{http_code}\\n\" \\\n  -X POST http://localhost:8080/api/login \\\n  -d \"username=admin&password=correct-password\"\n\n# HTTP 429 (still locked — must wait for LockoutDuration to expire)"}]
20:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300","children":"Testing Locally"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["When testing locally, all requests come from ",["$","code",null,{"children":"127.0.0.1"}]," or ",["$","code",null,{"children":"::1"}],", so they share a single IP counter. To test with different IPs, use the"," ",["$","code",null,{"children":"X-Forwarded-For"}]," header if your setup supports it, or test from different machines."]}]]}]]}]}]
21:["$","h2",null,{"id":"dashboard","children":"Dashboard"}]
22:["$","p",null,{"children":["Auth Shield events appear in the Sentinel dashboard on the ",["$","strong",null,{"children":"Threats"}]," page. Each event includes:"]}]
23:["$","ul",null,{"children":[["$","li",null,{"children":["Threat type displayed as ",["$","code",null,{"children":"BruteForce"}]," or ",["$","code",null,{"children":"CredentialStuffing"}]]}],["$","li",null,{"children":"The offending IP address"}],["$","li",null,{"children":"Timestamp of when the lockout was triggered"}],["$","li",null,{"children":"Severity level (High)"}],["$","li",null,{"children":["Evidence showing the detection pattern and location (",["$","code",null,{"children":"auth_shield"}],")"]}]]}]
24:["$","p",null,{"children":["You can filter the Threats page by type to isolate brute-force and credential stuffing events. If alerting is configured with a minimum severity of ",["$","code",null,{"children":"High"}]," or lower, these events will also trigger Slack, email, or webhook notifications."]}]
25:["$","h2",null,{"id":"combining","children":"Combining with Rate Limiting"}]
26:["$","p",null,{"children":"Auth Shield and rate limiting are complementary. A recommended pattern is to use both:"}]
27:["$","$L2d",null,{"language":"go","filename":"config.go","code":"sentinel.Config{\n    // Auth Shield: locks out IPs after failed login attempts\n    AuthShield: sentinel.AuthShieldConfig{\n        Enabled:                    true,\n        LoginRoute:                 \"/api/login\",\n        MaxFailedAttempts:          5,\n        LockoutDuration:            15 * time.Minute,\n        CredentialStuffingDetection: true,\n        BruteForceDetection:        true,\n    },\n\n    // Rate Limiting: caps overall request volume to the login route\n    RateLimit: sentinel.RateLimitConfig{\n        Enabled: true,\n        ByRoute: map[string]sentinel.Limit{\n            \"/api/login\": {Requests: 10, Window: 15 * time.Minute},\n        },\n    },\n}"}]
28:["$","p",null,{"children":"In this setup, rate limiting prevents any IP from making more than 10 requests to the login route in 15 minutes (regardless of success or failure), while Auth Shield specifically tracks authentication failures and locks out after 5 failed attempts."}]
29:["$","h2",null,{"children":"Next Steps"}]
2a:["$","ul",null,{"children":[["$","li",null,{"children":[["$","a",null,{"href":"/docs/configuration","children":"Configuration Reference"}]," — Full list of all configuration options"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/rate-limiting","children":"Rate Limiting"}]," — Per-IP, per-user, and per-route rate limits"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/anomaly-detection","children":"Anomaly Detection"}]," — Behavioral analysis including credential stuffing patterns"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/alerting","children":"Alerting"}]," — Get notified when brute-force attacks are detected"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/the-dashboard","children":"Dashboard"}]," — Explore the Threats page and other security views"]}]]}]
2b:["$","script","script-0",{"src":"/_next/static/chunks/2425b678dfc0c3cf.js","async":true}]
2c:["$","$L2f",null,{"children":["$","$30",null,{"name":"Next.MetadataOutlet","children":"$@31"}]}]
31:null
