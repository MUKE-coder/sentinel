1:"$Sreact.fragment"
6e:I[99151,["/_next/static/chunks/4cc5a908347f559b.js","/_next/static/chunks/c23263069b7f7ba3.js","/_next/static/chunks/2425b678dfc0c3cf.js"],"default"]
6f:I[35417,["/_next/static/chunks/26ca110782d86623.js","/_next/static/chunks/81f0f13d25d49d65.js"],"OutletBoundary"]
70:"$Sreact.suspense"
0:{"buildId":"5Swj18oapgqGqSZX8fol6","rsc":["$","$1","c",{"children":[[["$","h1",null,{"children":"Threat Intelligence"}],["$","p",null,{"children":"Sentinel automatically profiles every IP address that triggers a security event. The Threat Intelligence system builds persistent actor profiles, computes risk scores, enriches data with geolocation and IP reputation, and provides tools to manage IP blocklists and whitelists. All of this happens automatically as events flow through the pipeline — no manual configuration is required to start collecting intelligence."}],["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300","children":"Automatic Profiling"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":"Threat actor profiling is always active when any detection feature is enabled (WAF, Auth Shield, Anomaly Detection). Every security event automatically creates or updates the corresponding actor profile. You do not need to enable profiling separately."}]]}]]}]}],["$","h2",null,{"id":"threat-actor-profiles","children":"Threat Actor Profiles"}],["$","p",null,{"children":"Every unique IP address that triggers a security event receives a persistent profile. The profiler runs as a pipeline handler, processing each threat event asynchronously and updating the corresponding actor record in storage."}],["$","h3",null,{"children":"Profile Fields"}],["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Field"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"IP"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"The IP address that uniquely identifies this actor."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"FirstSeen"}]}],["$","td",null,{"children":["$","code",null,{"children":"time.Time"}]}],["$","td",null,{"children":"Timestamp of the first security event from this IP."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"LastSeen"}]}],["$","td",null,{"children":["$","code",null,{"children":"time.Time"}]}],["$","td",null,{"children":"Timestamp of the most recent security event from this IP."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"ThreatCount"}]}],["$","td",null,{"children":["$","code",null,{"children":"int"}]}],["$","td",null,{"children":"Total number of security events attributed to this IP."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"AttackTypes"}]}],["$","td",null,{"children":["$","code",null,{"children":"[]string"}]}],["$","td",null,{"children":["Deduplicated list of attack types observed (e.g., ",["$","code",null,{"children":"SQLInjection"}],", ",["$","code",null,{"children":"XSS"}],", ",["$","code",null,{"children":"BruteForce"}],")."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"TargetedRoutes"}]}],["$","td",null,{"children":["$","code",null,{"children":"[]string"}]}],["$","td",null,{"children":["Deduplicated list of routes this actor has targeted (e.g., ",["$","code",null,{"children":"GET /api/users"}],")."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"RiskScore"}]}],["$","td",null,{"children":["$","code",null,{"children":"int"}]}],["$","td",null,{"children":["Computed risk score from 0 to 100. See ",["$","a",null,{"href":"#risk-scoring","children":"Risk Scoring"}]," below."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Status"}]}],["$","td",null,{"children":"$L2"}],"$L3"]}],"$L4","$L5","$L6","$L7","$L8","$L9"]}]]}],"$La","$Lb","$Lc","$Ld","$Le","$Lf","$L10","$L11","$L12","$L13","$L14","$L15","$L16","$L17","$L18","$L19","$L1a","$L1b","$L1c","$L1d","$L1e","$L1f","$L20","$L21","$L22","$L23","$L24","$L25","$L26","$L27","$L28","$L29","$L2a","$L2b","$L2c","$L2d","$L2e","$L2f","$L30","$L31","$L32","$L33","$L34","$L35","$L36","$L37","$L38","$L39","$L3a","$L3b","$L3c","$L3d","$L3e","$L3f","$L40","$L41","$L42","$L43","$L44","$L45","$L46","$L47","$L48","$L49","$L4a","$L4b","$L4c","$L4d","$L4e","$L4f","$L50","$L51","$L52","$L53","$L54","$L55","$L56","$L57","$L58","$L59","$L5a","$L5b","$L5c","$L5d","$L5e","$L5f","$L60","$L61","$L62","$L63","$L64","$L65","$L66","$L67","$L68","$L69","$L6a","$L6b"],["$L6c"],"$L6d"]}],"loading":null,"isPartial":false}
2:["$","code",null,{"children":"ActorStatus"}]
3:["$","td",null,{"children":["Current status: ",["$","code",null,{"children":"Active"}],", ",["$","code",null,{"children":"Blocked"}],", or ",["$","code",null,{"children":"Whitelisted"}],"."]}]
4:["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Country"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"Country of origin (populated by geolocation if enabled)."}]]}]
5:["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"City"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"City of origin (populated by geolocation if enabled)."}]]}]
6:["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"ISP"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"Internet service provider of the IP."}]]}]
7:["$","tr",null,{"children":[["$","td",null,{"children":[["$","code",null,{"children":"Lat"}]," / ",["$","code",null,{"children":"Lng"}]]}],["$","td",null,{"children":["$","code",null,{"children":"float64"}]}],["$","td",null,{"children":"Geographic coordinates for map visualization in the dashboard."}]]}]
8:["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"IsKnownBadActor"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["Set to ",["$","code",null,{"children":"true"}]," if the IP has a high abuse score from IP reputation checking."]}]]}]
9:["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"AbuseScore"}]}],["$","td",null,{"children":["$","code",null,{"children":"int"}]}],["$","td",null,{"children":"Abuse confidence score from AbuseIPDB (0-100)."}]]}]
a:["$","p",null,{"children":"Profiles are created on the first event and updated incrementally on each subsequent event. Attack types and targeted routes are deduplicated, so the lists grow only when new distinct values appear."}]
b:["$","$L6e",null,{"language":"go","filename":"core/models.go","code":"// ThreatActor represents a persistent profile of an attacker.\ntype ThreatActor struct {\n    ID              string      `json:\"id\"`\n    IP              string      `json:\"ip\"`\n    FirstSeen       time.Time   `json:\"first_seen\"`\n    LastSeen        time.Time   `json:\"last_seen\"`\n    TotalRequests   int         `json:\"total_requests\"`\n    ThreatCount     int         `json:\"threat_count\"`\n    AttackTypes     []string    `json:\"attack_types\"`\n    TargetedRoutes  []string    `json:\"targeted_routes\"`\n    RiskScore       int         `json:\"risk_score\"`\n    Status          ActorStatus `json:\"status\"`\n    Country         string      `json:\"country\"`\n    City            string      `json:\"city,omitempty\"`\n    ISP             string      `json:\"isp\"`\n    IsKnownBadActor bool        `json:\"is_known_bad_actor\"`\n    AbuseScore      int         `json:\"abuse_score\"`\n    Lat             float64     `json:\"lat\"`\n    Lng             float64     `json:\"lng\"`\n}"}]
c:["$","h2",null,{"id":"risk-scoring","children":"Risk Scoring"}]
d:["$","p",null,{"children":"Each threat actor is assigned a risk score between 0 and 100. The score is recomputed every time a new threat event is attributed to the actor. The scoring algorithm considers four factors:"}]
e:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Factor"}],["$","th",null,{"children":"Points"}],["$","th",null,{"children":"Condition"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Attack Variety"}],["$","td",null,{"children":"+10 per unique type (max 50)"}],["$","td",null,{"children":["Each distinct attack type in ",["$","code",null,{"children":"AttackTypes"}]," adds 10 points, capped at 50."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Known Bad Actor"}],["$","td",null,{"children":"+20"}],["$","td",null,{"children":["IP has been flagged by AbuseIPDB (",["$","code",null,{"children":"IsKnownBadActor == true"}],")."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Recency"}],["$","td",null,{"children":"+10"}],["$","td",null,{"children":"The most recent attack was within the last hour."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Volume"}],["$","td",null,{"children":"+20"}],["$","td",null,{"children":"Total threat count exceeds 100 events."}]]}]]}]]}]
f:["$","p",null,{"children":"The final score is capped at 100. An actor with 5 unique attack types, a recent attack, over 100 events, and a known-bad reputation would score the maximum of 100."}]
10:["$","$L6e",null,{"language":"go","filename":"intelligence/profiler.go","code":"// ComputeRiskScore calculates a risk score (0-100) for a threat actor.\nfunc ComputeRiskScore(actor *sentinel.ThreatActor) int {\n    score := 0\n\n    // +10 for each unique attack type, max 50\n    attackTypeScore := len(actor.AttackTypes) * 10\n    if attackTypeScore > 50 {\n        attackTypeScore = 50\n    }\n    score += attackTypeScore\n\n    // +20 if known bad actor (AbuseIPDB)\n    if actor.IsKnownBadActor {\n        score += 20\n    }\n\n    // +10 if attacked in last hour\n    if time.Since(actor.LastSeen) < time.Hour {\n        score += 10\n    }\n\n    // +20 if attack count > 100\n    if actor.ThreatCount > 100 {\n        score += 20\n    }\n\n    if score > 100 {\n        score = 100\n    }\n    return score\n}"}]
11:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500","children":[["$","path","yps3ct",{"d":"M21.801 10A10 10 0 1 1 17 3.335"}],["$","path","1pflzl",{"d":"m9 11 3 3L22 4"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-green-800 dark:text-green-300","children":"Risk Score Interpretation"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":[["$","strong",null,{"children":"0-20:"}]," Low risk, minimal activity."," ",["$","strong",null,{"children":"21-50:"}]," Moderate risk, multiple attack types or sustained activity."," ",["$","strong",null,{"children":"51-80:"}]," High risk, diverse attack patterns or known bad reputation."," ",["$","strong",null,{"children":"81-100:"}]," Critical risk, consider immediate blocking."]}]]}]]}]}]
12:["$","h2",null,{"id":"ip-reputation","children":"IP Reputation"}]
13:["$","p",null,{"children":["Sentinel can optionally enrich threat actor profiles with external IP reputation data from"," ",["$","strong",null,{"children":"AbuseIPDB"}],". When enabled, the reputation checker queries the AbuseIPDB API for each IP that triggers a security event, retrieves its abuse confidence score, and can automatically block IPs that exceed a configurable threshold."]}]
14:["$","h3",null,{"children":"IPReputationConfig"}]
15:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Field"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Default"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Enabled"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":"Enables IP reputation checking."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"AbuseIPDBKey"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":["$","code",null,{"children":"\"\""}]}],["$","td",null,{"children":["Your AbuseIPDB API key. Required for reputation lookups. Obtain one from ",["$","code",null,{"children":"abuseipdb.com"}],"."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"AutoBlock"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":["Automatically block IPs whose abuse score meets or exceeds ",["$","code",null,{"children":"MinAbuseScore"}],"."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"MinAbuseScore"}]}],["$","td",null,{"children":["$","code",null,{"children":"int"}]}],["$","td",null,{"children":["$","code",null,{"children":"80"}]}],["$","td",null,{"children":"Minimum AbuseIPDB confidence score (0-100) to trigger auto-blocking."}]]}]]}]]}]
16:["$","$L6e",null,{"language":"go","filename":"main.go","code":"sentinel.Mount(r, nil, sentinel.Config{\n    IPReputation: sentinel.IPReputationConfig{\n        Enabled:       true,\n        AbuseIPDBKey:  \"your-abuseipdb-api-key\",\n        AutoBlock:     true,\n        MinAbuseScore: 80, // Block IPs with 80%+ abuse confidence\n    },\n})"}]
17:["$","p",null,{"children":["Reputation results are cached for 24 hours to minimize API calls. The cache is maintained in memory and cleared on application restart. When ",["$","code",null,{"children":"AutoBlock"}]," is enabled and an IP exceeds the threshold, it is immediately added to the blocklist via the IP Manager."]}]
18:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300","children":"AbuseIPDB Rate Limits"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["The free AbuseIPDB plan allows 1,000 checks per day. If your application processes a high volume of unique attacker IPs, consider upgrading your AbuseIPDB plan or increasing"," ",["$","code",null,{"children":"MinAbuseScore"}]," to reduce the number of reputation lookups triggered by low-confidence threats."]}]]}]]}]}]
19:["$","h2",null,{"id":"geolocation","children":"Geolocation"}]
1a:["$","p",null,{"children":"When geolocation is enabled, Sentinel resolves the geographic origin of each attacker IP and attaches country, city, coordinates, ISP, and ASN data to both the threat event and the actor profile. This data powers the geographic attack map in the dashboard."}]
1b:["$","h3",null,{"children":"GeoConfig"}]
1c:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Field"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Default"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Enabled"}]}],["$","td",null,{"children":["$","code",null,{"children":"bool"}]}],["$","td",null,{"children":["$","code",null,{"children":"false"}]}],["$","td",null,{"children":"Enables IP geolocation lookups."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Provider"}]}],["$","td",null,{"children":["$","code",null,{"children":"GeoProvider"}]}],["$","td",null,{"children":["$","code",null,{"children":"GeoIPFree"}]}],["$","td",null,{"children":["The geolocation provider. Default uses the free ",["$","code",null,{"children":"ip-api.com"}]," service (no API key required)."]}]]}]]}]]}]
1d:["$","$L6e",null,{"language":"go","filename":"main.go","code":"sentinel.Mount(r, nil, sentinel.Config{\n    Geo: sentinel.GeoConfig{\n        Enabled:  true,\n        Provider: sentinel.GeoIPFree, // Free provider, no API key needed\n    },\n})"}]
1e:["$","p",null,{"children":["Geolocation results are cached in an LRU cache (default 10,000 entries) to minimize external API calls. Private and loopback IPs (e.g., ",["$","code",null,{"children":"127.0.0.1"}],","," ",["$","code",null,{"children":"10.x.x.x"}],", ",["$","code",null,{"children":"192.168.x.x"}],") are skipped automatically."]}]
1f:["$","h3",null,{"children":"GeoResult Fields"}]
20:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Field"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"Country"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":["Full country name (e.g., ",["$","code",null,{"children":"United States"}],")."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"CountryCode"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":["ISO 3166-1 alpha-2 country code (e.g., ",["$","code",null,{"children":"US"}],")."]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"City"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"City name."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":[["$","code",null,{"children":"Lat"}]," / ",["$","code",null,{"children":"Lng"}]]}],["$","td",null,{"children":["$","code",null,{"children":"float64"}]}],["$","td",null,{"children":"Geographic coordinates."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"ISP"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"Internet service provider."}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"ASN"}]}],["$","td",null,{"children":["$","code",null,{"children":"string"}]}],["$","td",null,{"children":"Autonomous system number and name."}]]}]]}]]}]
21:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300","children":"Production Geolocation"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["The free ",["$","code",null,{"children":"ip-api.com"}]," provider is rate-limited to 45 requests per minute. For production workloads with high traffic, consider using a local MaxMind GeoLite2 database for offline lookups with no rate limits."]}]]}]]}]}]
22:["$","h2",null,{"id":"ip-management","children":"IP Management"}]
23:["$","p",null,{"children":"The IP Manager provides a centralized system for blocking and whitelisting IP addresses and CIDR ranges. It maintains an in-memory cache that syncs from storage every 30 seconds, ensuring fast per-request lookups with no database overhead on the hot path."}]
24:["$","h3",null,{"children":"Blocking IPs"}]
25:["$","p",null,{"children":"Blocked IPs are rejected by the middleware before reaching your application handlers. You can block individual IPs or entire CIDR ranges. Blocks can optionally have an expiration time."}]
26:["$","$L6e",null,{"language":"go","code":"// Block a single IP with no expiration\nipManager.BlockIP(ctx, \"203.0.113.50\", \"Repeated SQL injection attempts\", nil)\n\n// Block a CIDR range\nipManager.BlockIP(ctx, \"198.51.100.0/24\", \"Known botnet range\", nil)\n\n// Block with expiration (auto-unblock after 24 hours)\nexpiry := time.Now().Add(24 * time.Hour)\nipManager.BlockIP(ctx, \"203.0.113.75\", \"Temporary block\", &expiry)"}]
27:["$","h3",null,{"children":"Whitelisting IPs"}]
28:["$","p",null,{"children":"Whitelisted IPs bypass all security checks including the WAF, rate limiting, and Auth Shield. Use this for trusted internal services, monitoring systems, and CI/CD pipelines."}]
29:["$","$L6e",null,{"language":"go","code":"// Whitelist a trusted IP\nipManager.WhitelistIP(ctx, \"10.0.0.5\")"}]
2a:["$","h3",null,{"children":"How the Cache Works"}]
2b:["$","p",null,{"children":"The IP Manager loads all blocked and whitelisted IPs into memory at startup. A background goroutine re-syncs from storage every 30 seconds to pick up changes made via the API or dashboard. Blocking and whitelisting operations update both storage and the in-memory cache immediately, so changes take effect without waiting for the next sync cycle."}]
2c:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300","children":"CIDR Matching"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["When you block a CIDR range like ",["$","code",null,{"children":"198.51.100.0/24"}],", every IP within that range is matched. The IP Manager parses CIDR notation and performs subnet containment checks. Individual IP blocks use exact string matching for maximum performance."]}]]}]]}]}]
2d:["$","h2",null,{"id":"full-configuration","children":"Full Configuration Example"}]
2e:["$","p",null,{"children":"The following example enables all threat intelligence features: profiling, geolocation, IP reputation with auto-blocking, and the WAF for event generation."}]
2f:["$","$L6e",null,{"language":"go","filename":"main.go","code":"package main\n\nimport (\n    sentinel \"github.com/MUKE-coder/sentinel\"\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    r := gin.Default()\n\n    sentinel.Mount(r, nil, sentinel.Config{\n        // WAF generates the threat events that feed the profiler\n        WAF: sentinel.WAFConfig{\n            Enabled: true,\n            Mode:    sentinel.ModeBlock,\n        },\n\n        // IP reputation enrichment with auto-blocking\n        IPReputation: sentinel.IPReputationConfig{\n            Enabled:       true,\n            AbuseIPDBKey:  \"your-abuseipdb-api-key\",\n            AutoBlock:     true,\n            MinAbuseScore: 80,\n        },\n\n        // Geolocation for geographic attribution\n        Geo: sentinel.GeoConfig{\n            Enabled:  true,\n            Provider: sentinel.GeoIPFree,\n        },\n    })\n\n    r.GET(\"/api/data\", func(c *gin.Context) {\n        c.JSON(200, gin.H{\"status\": \"ok\"})\n    })\n\n    r.Run(\":8080\")\n}"}]
30:["$","h2",null,{"id":"dashboard","children":"Dashboard"}]
31:["$","p",null,{"children":"The Sentinel dashboard provides two dedicated pages for threat intelligence:"}]
32:["$","h3",null,{"children":"Actors Page"}]
33:["$","p",null,{"children":"The Actors page lists all threat actor profiles with sortable columns for IP, risk score, threat count, attack types, country, and last seen time. From this page you can:"}]
34:["$","ul",null,{"children":[["$","li",null,{"children":"Search and filter actors by IP, status, or minimum risk score."}],["$","li",null,{"children":"View the full profile for any actor, including their complete attack history."}],["$","li",null,{"children":"Block an actor directly from their profile with a single click."}],["$","li",null,{"children":"View geographic data and the attack types observed for each actor."}]]}]
35:["$","h3",null,{"children":"IP Management Page"}]
36:["$","p",null,{"children":"The IP Management page provides a visual interface for managing your blocklist and whitelist:"}]
37:["$","ul",null,{"children":[["$","li",null,{"children":"View all currently blocked IPs and CIDR ranges with block reasons and timestamps."}],["$","li",null,{"children":"Add new IPs or CIDR ranges to the blocklist with an optional expiration."}],["$","li",null,{"children":"Unblock IPs that were previously blocked manually or by auto-blocking."}],["$","li",null,{"children":"Manage the whitelist for trusted IPs."}]]}]
38:["$","p",null,{"children":["Access these pages at"," ",["$","code",null,{"children":"http://localhost:8080/sentinel/ui"}]," and navigate to the Actors or IP Management sections."]}]
39:["$","h2",null,{"id":"api","children":"API Reference"}]
3a:["$","p",null,{"children":["All threat intelligence endpoints require authentication via the dashboard JWT token. Include the token in the ",["$","code",null,{"children":"Authorization"}]," header as"," ",["$","code",null,{"children":"Bearer <token>"}],"."]}]
3b:["$","h3",null,{"children":"List Actors"}]
3c:["$","p",null,{"children":"Returns a paginated list of threat actor profiles with optional filtering."}]
3d:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"GET /sentinel/api/actors"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Query Params"}],["$","td",null,{"children":[["$","code",null,{"children":"status"}],", ",["$","code",null,{"children":"min_risk"}],", ",["$","code",null,{"children":"search"}],","," ",["$","code",null,{"children":"page"}],", ",["$","code",null,{"children":"page_size"}]]}]]}]]}]]}]
3e:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# List all actors, sorted by default\ncurl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors?page=1&page_size=20\"\n\n# Filter by minimum risk score\ncurl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors?min_risk=50\"\n\n# Filter by status\ncurl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors?status=Active\""}]
3f:["$","$L6e",null,{"language":"json","filename":"Response","showLineNumbers":false,"code":"{\n  \"data\": [\n    {\n      \"id\": \"203.0.113.50\",\n      \"ip\": \"203.0.113.50\",\n      \"first_seen\": \"2025-01-15T08:23:00Z\",\n      \"last_seen\": \"2025-01-15T14:45:00Z\",\n      \"total_requests\": 347,\n      \"threat_count\": 89,\n      \"attack_types\": [\"SQLInjection\", \"XSS\", \"PathTraversal\"],\n      \"targeted_routes\": [\"GET /api/users\", \"POST /api/search\"],\n      \"risk_score\": 70,\n      \"status\": \"Active\",\n      \"country\": \"United States\",\n      \"city\": \"New York\",\n      \"isp\": \"Example ISP\",\n      \"is_known_bad_actor\": false,\n      \"abuse_score\": 45,\n      \"lat\": 40.7128,\n      \"lng\": -74.006\n    }\n  ],\n  \"meta\": {\n    \"total\": 42,\n    \"page\": 1,\n    \"page_size\": 20\n  }\n}"}]
40:["$","h3",null,{"children":"Get Actor by IP"}]
41:["$","p",null,{"children":"Returns the full profile for a specific threat actor."}]
42:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"GET /sentinel/api/actors/:ip"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"URL Param"}],["$","td",null,{"children":[["$","code",null,{"children":":ip"}]," — the IP address of the actor"]}]]}]]}]]}]
43:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"curl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors/203.0.113.50\""}]
44:["$","h3",null,{"children":"Block Actor"}]
45:["$","p",null,{"children":"Blocks a threat actor by IP. The IP is added to the blocklist and all future requests from this IP are rejected."}]
46:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"POST /sentinel/api/actors/:ip/block"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"URL Param"}],["$","td",null,{"children":[["$","code",null,{"children":":ip"}]," — the IP address to block"]}]]}]]}]]}]
47:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"curl -s -X POST -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors/203.0.113.50/block\""}]
48:["$","$L6e",null,{"language":"json","filename":"Response","showLineNumbers":false,"code":"{\n  \"message\": \"Actor blocked\"\n}"}]
49:["$","h3",null,{"children":"Actor Request History"}]
4a:["$","p",null,{"children":"Returns the threat events associated with a specific actor IP."}]
4b:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"GET /sentinel/api/actors/:ip/requests"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"URL Param"}],["$","td",null,{"children":[["$","code",null,{"children":":ip"}]," — the IP address of the actor"]}]]}]]}]]}]
4c:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"curl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/actors/203.0.113.50/requests\""}]
4d:["$","h3",null,{"children":"List Blocked IPs"}]
4e:["$","p",null,{"children":"Returns all currently blocked IPs and CIDR ranges."}]
4f:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"GET /sentinel/api/ip/blocked"}]}]]}]}]]}]
50:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"curl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/ip/blocked\""}]
51:["$","$L6e",null,{"language":"json","filename":"Response","showLineNumbers":false,"code":"{\n  \"data\": [\n    {\n      \"ip\": \"203.0.113.50\",\n      \"reason\": \"Blocked via dashboard\",\n      \"blocked_at\": \"2025-01-15T14:50:00Z\",\n      \"expires_at\": null,\n      \"cidr\": false\n    },\n    {\n      \"ip\": \"198.51.100.0/24\",\n      \"reason\": \"Known botnet range\",\n      \"blocked_at\": \"2025-01-14T09:00:00Z\",\n      \"expires_at\": null,\n      \"cidr\": true\n    }\n  ]\n}"}]
52:["$","h3",null,{"children":"Block IP"}]
53:["$","p",null,{"children":"Adds an IP or CIDR range to the blocklist."}]
54:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"POST /sentinel/api/ip/block"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"Body"}],["$","td",null,{"children":["JSON with ",["$","code",null,{"children":"ip"}]," (required), ",["$","code",null,{"children":"reason"}],", ",["$","code",null,{"children":"expiry"}]," (optional, RFC3339)"]}]]}]]}]]}]
55:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# Block a single IP\ncurl -s -X POST -H \"Authorization: Bearer <token>\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"ip\": \"203.0.113.75\", \"reason\": \"Manual block\"}' \\\n  \"http://localhost:8080/sentinel/api/ip/block\"\n\n# Block a CIDR range with expiration\ncurl -s -X POST -H \"Authorization: Bearer <token>\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"ip\": \"198.51.100.0/24\", \"reason\": \"Temporary block\", \"expiry\": \"2025-02-15T00:00:00Z\"}' \\\n  \"http://localhost:8080/sentinel/api/ip/block\""}]
56:["$","h3",null,{"children":"Unblock IP"}]
57:["$","p",null,{"children":["Removes an IP or CIDR range from the blocklist. For CIDR ranges, replace ",["$","code",null,{"children":"/"}]," ","with ",["$","code",null,{"children":"_"}]," in the URL parameter (e.g., ",["$","code",null,{"children":"198.51.100.0_24"}],")."]}]
58:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"DELETE /sentinel/api/ip/block/:ip"}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"URL Param"}],["$","td",null,{"children":[["$","code",null,{"children":":ip"}]," — the IP or CIDR (with ",["$","code",null,{"children":"/"}]," replaced by ",["$","code",null,{"children":"_"}],")"]}]]}]]}]]}]
59:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# Unblock a single IP\ncurl -s -X DELETE -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/ip/block/203.0.113.75\"\n\n# Unblock a CIDR range (replace / with _)\ncurl -s -X DELETE -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/ip/block/198.51.100.0_24\""}]
5a:["$","h3",null,{"children":"IP Reputation Lookup"}]
5b:["$","p",null,{"children":"Retrieves the AbuseIPDB reputation data for a specific IP (requires IP reputation to be enabled)."}]
5c:["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Property"}],["$","th",null,{"children":"Value"}]]}]}],["$","tbody",null,{"children":["$","tr",null,{"children":[["$","td",null,{"children":"Endpoint"}],["$","td",null,{"children":["$","code",null,{"children":"GET /sentinel/api/ip/:ip/reputation"}]}]]}]}]]}]
5d:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"curl -s -H \"Authorization: Bearer <token>\" \\\n  \"http://localhost:8080/sentinel/api/ip/203.0.113.50/reputation\""}]
5e:["$","h2",null,{"id":"testing","children":"Testing"}]
5f:["$","p",null,{"children":"After enabling the WAF or any other detection feature, threat actor profiles are created automatically. You can verify the intelligence system is working by triggering a few test events and then querying the actors API."}]
60:["$","h3",null,{"children":"Step 1: Trigger Security Events"}]
61:["$","p",null,{"children":"Send a few malicious requests to generate threat events. These will automatically create actor profiles."}]
62:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# Trigger a SQL injection event\ncurl -s \"http://localhost:8080/api/data?id=1'+OR+'1'='1\"\n\n# Trigger an XSS event\ncurl -s \"http://localhost:8080/api/data?q=<script>alert(1)</script>\"\n\n# Trigger a path traversal event\ncurl -s \"http://localhost:8080/api/data/../../../../etc/passwd\""}]
63:["$","h3",null,{"children":"Step 2: Log In to the Dashboard API"}]
64:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# Obtain a JWT token\nTOKEN=$(curl -s -X POST http://localhost:8080/sentinel/api/auth/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"admin\",\"password\":\"sentinel\"}' | jq -r '.token')\n\necho $TOKEN"}]
65:["$","h3",null,{"children":"Step 3: View Actor Profiles"}]
66:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# List all actors\ncurl -s -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/actors\" | jq .\n\n# View a specific actor (use your test IP, likely 127.0.0.1)\ncurl -s -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/actors/127.0.0.1\" | jq .\n\n# View the threat history for an actor\ncurl -s -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/actors/127.0.0.1/requests\" | jq ."}]
67:["$","h3",null,{"children":"Step 4: Test IP Blocking"}]
68:["$","$L6e",null,{"language":"bash","showLineNumbers":false,"code":"# Block an actor\ncurl -s -X POST -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/actors/203.0.113.50/block\" | jq .\n\n# Verify the IP appears in the blocklist\ncurl -s -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/ip/blocked\" | jq .\n\n# Unblock the IP\ncurl -s -X DELETE -H \"Authorization: Bearer $TOKEN\" \\\n  \"http://localhost:8080/sentinel/api/ip/block/203.0.113.50\" | jq ."}]
69:["$","div",null,{"className":"my-4 rounded-lg border p-4 bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800","children":["$","div",null,{"className":"flex items-start gap-3","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":18,"height":18,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-circle-x mt-0.5 flex-shrink-0 text-red-500","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1uzhvr",{"d":"m15 9-6 6"}],["$","path","z0biqf",{"d":"m9 9 6 6"}],"$undefined"]}],["$","div",null,{"children":[["$","p",null,{"className":"font-semibold text-sm mb-1 text-red-800 dark:text-red-300","children":"Local Testing Note"}],["$","div",null,{"className":"text-sm text-gray-700 dark:text-gray-300","children":["When testing locally, all requests originate from ",["$","code",null,{"children":"127.0.0.1"}]," or"," ",["$","code",null,{"children":"::1"}],", so all test events will be attributed to a single actor profile. Geolocation lookups are skipped for private and loopback IPs. To test with realistic geographic data, deploy to a staging environment and send requests from external IPs."]}]]}]]}]}]
6a:["$","h2",null,{"children":"Next Steps"}]
6b:["$","ul",null,{"children":[["$","li",null,{"children":[["$","a",null,{"href":"/docs/waf","children":"WAF"}]," — Configure the WAF rules that generate threat events"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/auth-shield","children":"Auth Shield"}]," — Protect login endpoints from brute-force attacks"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/anomaly-detection","children":"Anomaly Detection"}]," — Add behavioral analysis for advanced threat detection"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/alerting","children":"Alerting"}]," — Get notified when high-risk actors are detected"]}],["$","li",null,{"children":[["$","a",null,{"href":"/docs/the-dashboard","children":"Dashboard"}]," — Explore the Actors and IP Management pages"]}]]}]
6c:["$","script","script-0",{"src":"/_next/static/chunks/2425b678dfc0c3cf.js","async":true}]
6d:["$","$L6f",null,{"children":["$","$70",null,{"name":"Next.MetadataOutlet","children":"$@71"}]}]
71:null
