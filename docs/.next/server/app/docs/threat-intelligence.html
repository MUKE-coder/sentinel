<!DOCTYPE html><!--5Swj18oapgqGqSZX8fol6--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/a68d47cca58670f5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/a339dcc3b98340b3.js"/><script src="/_next/static/chunks/bfffc7ec77d3b06a.js" async=""></script><script src="/_next/static/chunks/b9cfbaaba1fd82be.js" async=""></script><script src="/_next/static/chunks/c540f39c8777f86f.js" async=""></script><script src="/_next/static/chunks/turbopack-a8b0537048952335.js" async=""></script><script src="/_next/static/chunks/4cc5a908347f559b.js" async=""></script><script src="/_next/static/chunks/26ca110782d86623.js" async=""></script><script src="/_next/static/chunks/81f0f13d25d49d65.js" async=""></script><script src="/_next/static/chunks/c23263069b7f7ba3.js" async=""></script><script src="/_next/static/chunks/2425b678dfc0c3cf.js" async=""></script><title>Threat Intelligence - Sentinel Docs</title><meta name="description" content="Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard."/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="min-h-screen antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><nav class="sticky top-0 z-50 w-full border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-16"><div class="flex items-center gap-8"><a class="flex items-center gap-2.5 group" href="/"><div class="w-8 h-8 rounded-lg bg-gradient-to-br from-sentinel-400 to-sentinel-600 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield text-white"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><span class="font-bold text-lg tracking-tight">Sentinel</span></a><div class="hidden md:flex items-center gap-6"><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors flex items-center gap-1.5" href="/docs/getting-started"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Docs</a><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors" href="/docs/api-reference">API</a></div></div><div class="flex items-center gap-3"><div class="hidden sm:block"><button class="flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm text-gray-500 dark:text-gray-400 w-64"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><span class="flex-1 text-left">Search docs...</span><kbd class="hidden sm:flex items-center gap-0.5 text-[10px] font-mono text-gray-400 dark:text-gray-500 bg-gray-200 dark:bg-gray-800 px-1.5 py-0.5 rounded"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-command"><path d="M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"></path></svg> K</kbd></button></div><div class="w-9 h-9"></div><a href="https://github.com/MUKE-coder/sentinel" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github text-gray-600 dark:text-gray-400"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></nav><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><button class="lg:hidden mb-4 p-2 rounded-lg border border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-900"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><div class="flex gap-10"><aside class="hidden lg:block w-64 flex-shrink-0"><div class="sticky top-20 overflow-y-auto max-h-[calc(100vh-5rem)] pb-10 pr-4"><nav class="space-y-6"><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Getting Started</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/getting-started">Introduction</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/configuration">Configuration</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Security</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/waf">WAF</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/rate-limiting">Rate Limiting</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/auth-shield">Auth Shield</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/security-headers">Security Headers</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Intelligence</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors bg-sentinel-50 dark:bg-sentinel-950/50 text-sentinel-600 dark:text-sentinel-400 font-medium" href="/docs/threat-intelligence">Threat Intelligence</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/anomaly-detection">Anomaly Detection</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/security-score">Security Score</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Monitoring</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/the-dashboard">Dashboard</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/performance">Performance</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/alerting">Alerting</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Data</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/audit-logging">Audit Logging</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/ai-analysis">AI Analysis</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/compliance-reports">Compliance Reports</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Reference</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/api-reference">API Reference</a></li></ul></div></nav></div></aside><main class="min-w-0 flex-1 prose-docs"><h1>Threat Intelligence</h1><p>Sentinel automatically profiles every IP address that triggers a security event. The Threat Intelligence system builds persistent actor profiles, computes risk scores, enriches data with geolocation and IP reputation, and provides tools to manage IP blocklists and whitelists. All of this happens automatically as events flow through the pipeline â€” no manual configuration is required to start collecting intelligence.</p><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Automatic Profiling</p><div class="text-sm text-gray-700 dark:text-gray-300">Threat actor profiling is always active when any detection feature is enabled (WAF, Auth Shield, Anomaly Detection). Every security event automatically creates or updates the corresponding actor profile. You do not need to enable profiling separately.</div></div></div></div><h2 id="threat-actor-profiles">Threat Actor Profiles</h2><p>Every unique IP address that triggers a security event receives a persistent profile. The profiler runs as a pipeline handler, processing each threat event asynchronously and updating the corresponding actor record in storage.</p><h3>Profile Fields</h3><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>IP</code></td><td><code>string</code></td><td>The IP address that uniquely identifies this actor.</td></tr><tr><td><code>FirstSeen</code></td><td><code>time.Time</code></td><td>Timestamp of the first security event from this IP.</td></tr><tr><td><code>LastSeen</code></td><td><code>time.Time</code></td><td>Timestamp of the most recent security event from this IP.</td></tr><tr><td><code>ThreatCount</code></td><td><code>int</code></td><td>Total number of security events attributed to this IP.</td></tr><tr><td><code>AttackTypes</code></td><td><code>[]string</code></td><td>Deduplicated list of attack types observed (e.g., <code>SQLInjection</code>, <code>XSS</code>, <code>BruteForce</code>).</td></tr><tr><td><code>TargetedRoutes</code></td><td><code>[]string</code></td><td>Deduplicated list of routes this actor has targeted (e.g., <code>GET /api/users</code>).</td></tr><tr><td><code>RiskScore</code></td><td><code>int</code></td><td>Computed risk score from 0 to 100. See <a href="#risk-scoring">Risk Scoring</a> below.</td></tr><tr><td><code>Status</code></td><td><code>ActorStatus</code></td><td>Current status: <code>Active</code>, <code>Blocked</code>, or <code>Whitelisted</code>.</td></tr><tr><td><code>Country</code></td><td><code>string</code></td><td>Country of origin (populated by geolocation if enabled).</td></tr><tr><td><code>City</code></td><td><code>string</code></td><td>City of origin (populated by geolocation if enabled).</td></tr><tr><td><code>ISP</code></td><td><code>string</code></td><td>Internet service provider of the IP.</td></tr><tr><td><code>Lat</code> / <code>Lng</code></td><td><code>float64</code></td><td>Geographic coordinates for map visualization in the dashboard.</td></tr><tr><td><code>IsKnownBadActor</code></td><td><code>bool</code></td><td>Set to <code>true</code> if the IP has a high abuse score from IP reputation checking.</td></tr><tr><td><code>AbuseScore</code></td><td><code>int</code></td><td>Abuse confidence score from AbuseIPDB (0-100).</td></tr></tbody></table><p>Profiles are created on the first event and updated incrementally on each subsequent event. Attack types and targeted routes are deduplicated, so the lists grow only when new distinct values appear.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">core/models.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ThreatActor represents a persistent profile of an attacker.</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">type</span><span class="token plain"> ThreatActor </span><span class="token keyword" style="color:rgb(12, 150, 155)">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    ID              </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;id&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    IP              </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;ip&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    FirstSeen       time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Time   </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;first_seen&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    LastSeen        time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Time   </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;last_seen&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    TotalRequests   </span><span class="token builtin" style="color:rgb(72, 118, 214)">int</span><span class="token plain">         </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;total_requests&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    ThreatCount     </span><span class="token builtin" style="color:rgb(72, 118, 214)">int</span><span class="token plain">         </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;threat_count&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    AttackTypes     </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;attack_types&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">    TargetedRoutes  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;targeted_routes&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    RiskScore       </span><span class="token builtin" style="color:rgb(72, 118, 214)">int</span><span class="token plain">         </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;risk_score&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">    Status          ActorStatus </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;status&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">    Country         </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;country&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">    City            </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;city,omitempty&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">    ISP             </span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;isp&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">    IsKnownBadActor </span><span class="token builtin" style="color:rgb(72, 118, 214)">bool</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;is_known_bad_actor&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">    AbuseScore      </span><span class="token builtin" style="color:rgb(72, 118, 214)">int</span><span class="token plain">         </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;abuse_score&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">    Lat             </span><span class="token builtin" style="color:rgb(72, 118, 214)">float64</span><span class="token plain">     </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;lat&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">    Lng             </span><span class="token builtin" style="color:rgb(72, 118, 214)">float64</span><span class="token plain">     </span><span class="token string" style="color:rgb(72, 118, 214)">`json:&quot;lng&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h2 id="risk-scoring">Risk Scoring</h2><p>Each threat actor is assigned a risk score between 0 and 100. The score is recomputed every time a new threat event is attributed to the actor. The scoring algorithm considers four factors:</p><table><thead><tr><th>Factor</th><th>Points</th><th>Condition</th></tr></thead><tbody><tr><td>Attack Variety</td><td>+10 per unique type (max 50)</td><td>Each distinct attack type in <code>AttackTypes</code> adds 10 points, capped at 50.</td></tr><tr><td>Known Bad Actor</td><td>+20</td><td>IP has been flagged by AbuseIPDB (<code>IsKnownBadActor == true</code>).</td></tr><tr><td>Recency</td><td>+10</td><td>The most recent attack was within the last hour.</td></tr><tr><td>Volume</td><td>+20</td><td>Total threat count exceeds 100 events.</td></tr></tbody></table><p>The final score is capped at 100. An actor with 5 unique attack types, a recent attack, over 100 events, and a known-bad reputation would score the maximum of 100.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">intelligence/profiler.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ComputeRiskScore calculates a risk score (0-100) for a threat actor.</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">ComputeRiskScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">actor </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ThreatActor</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(72, 118, 214)">int</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    score </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// +10 for each unique attack type, max 50</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    attackTypeScore </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">len</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">AttackTypes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">10</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> attackTypeScore </span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">50</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">        attackTypeScore </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">50</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">    score </span><span class="token operator" style="color:rgb(12, 150, 155)">+=</span><span class="token plain"> attackTypeScore</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// +20 if known bad actor (AbuseIPDB)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> actor</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">IsKnownBadActor </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">        score </span><span class="token operator" style="color:rgb(12, 150, 155)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">20</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// +10 if attacked in last hour</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Since</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">LastSeen</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Hour </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">        score </span><span class="token operator" style="color:rgb(12, 150, 155)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">10</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// +20 if attack count &gt; 100</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> actor</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ThreatCount </span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">        score </span><span class="token operator" style="color:rgb(12, 150, 155)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">20</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> score </span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">        score </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> score</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500"><path d="M21.801 10A10 10 0 1 1 17 3.335"></path><path d="m9 11 3 3L22 4"></path></svg><div><p class="font-semibold text-sm mb-1 text-green-800 dark:text-green-300">Risk Score Interpretation</p><div class="text-sm text-gray-700 dark:text-gray-300"><strong>0-20:</strong> Low risk, minimal activity.<!-- --> <strong>21-50:</strong> Moderate risk, multiple attack types or sustained activity.<!-- --> <strong>51-80:</strong> High risk, diverse attack patterns or known bad reputation.<!-- --> <strong>81-100:</strong> Critical risk, consider immediate blocking.</div></div></div></div><h2 id="ip-reputation">IP Reputation</h2><p>Sentinel can optionally enrich threat actor profiles with external IP reputation data from<!-- --> <strong>AbuseIPDB</strong>. When enabled, the reputation checker queries the AbuseIPDB API for each IP that triggers a security event, retrieves its abuse confidence score, and can automatically block IPs that exceed a configurable threshold.</p><h3>IPReputationConfig</h3><table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>Enabled</code></td><td><code>bool</code></td><td><code>false</code></td><td>Enables IP reputation checking.</td></tr><tr><td><code>AbuseIPDBKey</code></td><td><code>string</code></td><td><code>&quot;&quot;</code></td><td>Your AbuseIPDB API key. Required for reputation lookups. Obtain one from <code>abuseipdb.com</code>.</td></tr><tr><td><code>AutoBlock</code></td><td><code>bool</code></td><td><code>false</code></td><td>Automatically block IPs whose abuse score meets or exceeds <code>MinAbuseScore</code>.</td></tr><tr><td><code>MinAbuseScore</code></td><td><code>int</code></td><td><code>80</code></td><td>Minimum AbuseIPDB confidence score (0-100) to trigger auto-blocking.</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    IPReputation</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">IPReputationConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">       </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">        AbuseIPDBKey</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;your-abuseipdb-api-key&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        AutoBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">        MinAbuseScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">80</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Block IPs with 80%+ abuse confidence</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span></div></pre></div></div><p>Reputation results are cached for 24 hours to minimize API calls. The cache is maintained in memory and cleared on application restart. When <code>AutoBlock</code> is enabled and an IP exceeds the threshold, it is immediately added to the blocklist via the IP Manager.</p><div class="my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300">AbuseIPDB Rate Limits</p><div class="text-sm text-gray-700 dark:text-gray-300">The free AbuseIPDB plan allows 1,000 checks per day. If your application processes a high volume of unique attacker IPs, consider upgrading your AbuseIPDB plan or increasing<!-- --> <code>MinAbuseScore</code> to reduce the number of reputation lookups triggered by low-confidence threats.</div></div></div></div><h2 id="geolocation">Geolocation</h2><p>When geolocation is enabled, Sentinel resolves the geographic origin of each attacker IP and attaches country, city, coordinates, ISP, and ASN data to both the threat event and the actor profile. This data powers the geographic attack map in the dashboard.</p><h3>GeoConfig</h3><table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>Enabled</code></td><td><code>bool</code></td><td><code>false</code></td><td>Enables IP geolocation lookups.</td></tr><tr><td><code>Provider</code></td><td><code>GeoProvider</code></td><td><code>GeoIPFree</code></td><td>The geolocation provider. Default uses the free <code>ip-api.com</code> service (no API key required).</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Geo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">GeoConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">        Provider</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">GeoIPFree</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Free provider, no API key needed</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span></div></pre></div></div><p>Geolocation results are cached in an LRU cache (default 10,000 entries) to minimize external API calls. Private and loopback IPs (e.g., <code>127.0.0.1</code>,<!-- --> <code>10.x.x.x</code>, <code>192.168.x.x</code>) are skipped automatically.</p><h3>GeoResult Fields</h3><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Country</code></td><td><code>string</code></td><td>Full country name (e.g., <code>United States</code>).</td></tr><tr><td><code>CountryCode</code></td><td><code>string</code></td><td>ISO 3166-1 alpha-2 country code (e.g., <code>US</code>).</td></tr><tr><td><code>City</code></td><td><code>string</code></td><td>City name.</td></tr><tr><td><code>Lat</code> / <code>Lng</code></td><td><code>float64</code></td><td>Geographic coordinates.</td></tr><tr><td><code>ISP</code></td><td><code>string</code></td><td>Internet service provider.</td></tr><tr><td><code>ASN</code></td><td><code>string</code></td><td>Autonomous system number and name.</td></tr></tbody></table><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Production Geolocation</p><div class="text-sm text-gray-700 dark:text-gray-300">The free <code>ip-api.com</code> provider is rate-limited to 45 requests per minute. For production workloads with high traffic, consider using a local MaxMind GeoLite2 database for offline lookups with no rate limits.</div></div></div></div><h2 id="ip-management">IP Management</h2><p>The IP Manager provides a centralized system for blocking and whitelisting IP addresses and CIDR ranges. It maintains an in-memory cache that syncs from storage every 30 seconds, ensuring fast per-request lookups with no database overhead on the hot path.</p><h3>Blocking IPs</h3><p>Blocked IPs are rejected by the middleware before reaching your application handlers. You can block individual IPs or entire CIDR ranges. Blocks can optionally have an expiration time.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Block a single IP with no expiration</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">ipManager</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">BlockIP</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.50&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Repeated SQL injection attempts&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Block a CIDR range</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">ipManager</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">BlockIP</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;198.51.100.0/24&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Known botnet range&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Block with expiration (auto-unblock after 24 hours)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">expiry </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Now</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Add</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">24</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Hour</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">ipManager</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">BlockIP</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.75&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Temporary block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">&amp;</span><span class="token plain">expiry</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span></div></pre></div></div><h3>Whitelisting IPs</h3><p>Whitelisted IPs bypass all security checks including the WAF, rate limiting, and Auth Shield. Use this for trusted internal services, monitoring systems, and CI/CD pipelines.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Whitelist a trusted IP</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">ipManager</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">WhitelistIP</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;10.0.0.5&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span></div></pre></div></div><h3>How the Cache Works</h3><p>The IP Manager loads all blocked and whitelisted IPs into memory at startup. A background goroutine re-syncs from storage every 30 seconds to pick up changes made via the API or dashboard. Blocking and whitelisting operations update both storage and the in-memory cache immediately, so changes take effect without waiting for the next sync cycle.</p><div class="my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300">CIDR Matching</p><div class="text-sm text-gray-700 dark:text-gray-300">When you block a CIDR range like <code>198.51.100.0/24</code>, every IP within that range is matched. The IP Manager parses CIDR notation and performs subnet containment checks. Individual IP blocks use exact string matching for maximum performance.</div></div></div></div><h2 id="full-configuration">Full Configuration Example</h2><p>The following example enables all threat intelligence features: profiling, geolocation, IP reputation with auto-blocking, and the WAF for event generation.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token keyword" style="color:rgb(12, 150, 155)">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    sentinel </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/MUKE-coder/sentinel&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/gin-gonic/gin&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    r </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Default</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// WAF generates the threat events that feed the profiler</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">        WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">            Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// IP reputation enrichment with auto-blocking</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">        IPReputation</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">IPReputationConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">       </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain">            AbuseIPDBKey</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;your-abuseipdb-api-key&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">            AutoBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">            MinAbuseScore</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">80</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Geolocation for geographic attribution</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain">        Geo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">GeoConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">            Provider</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">GeoIPFree</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">32</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">33</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">GET</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/api/data&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">34</span><span class="token plain">        c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">JSON</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">200</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">H</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;status&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ok&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">35</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">36</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">37</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;:8080&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">38</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h2 id="dashboard">Dashboard</h2><p>The Sentinel dashboard provides two dedicated pages for threat intelligence:</p><h3>Actors Page</h3><p>The Actors page lists all threat actor profiles with sortable columns for IP, risk score, threat count, attack types, country, and last seen time. From this page you can:</p><ul><li>Search and filter actors by IP, status, or minimum risk score.</li><li>View the full profile for any actor, including their complete attack history.</li><li>Block an actor directly from their profile with a single click.</li><li>View geographic data and the attack types observed for each actor.</li></ul><h3>IP Management Page</h3><p>The IP Management page provides a visual interface for managing your blocklist and whitelist:</p><ul><li>View all currently blocked IPs and CIDR ranges with block reasons and timestamps.</li><li>Add new IPs or CIDR ranges to the blocklist with an optional expiration.</li><li>Unblock IPs that were previously blocked manually or by auto-blocking.</li><li>Manage the whitelist for trusted IPs.</li></ul><p>Access these pages at<!-- --> <code>http://localhost:8080/sentinel/ui</code> and navigate to the Actors or IP Management sections.</p><h2 id="api">API Reference</h2><p>All threat intelligence endpoints require authentication via the dashboard JWT token. Include the token in the <code>Authorization</code> header as<!-- --> <code>Bearer &lt;token&gt;</code>.</p><h3>List Actors</h3><p>Returns a paginated list of threat actor profiles with optional filtering.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/actors</code></td></tr><tr><td>Query Params</td><td><code>status</code>, <code>min_risk</code>, <code>search</code>,<!-- --> <code>page</code>, <code>page_size</code></td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># List all actors, sorted by default</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors?page=1&amp;page_size=20&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Filter by minimum risk score</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors?min_risk=50&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Filter by status</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors?status=Active&quot;</span></div></pre></div></div><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">Response</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">json</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;data&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;id&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.50&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;ip&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.50&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;first_seen&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;2025-01-15T08:23:00Z&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;last_seen&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;2025-01-15T14:45:00Z&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;total_requests&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">347</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;threat_count&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">89</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;attack_types&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;SQLInjection&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;XSS&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;PathTraversal&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;targeted_routes&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;GET /api/users&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;POST /api/search&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;risk_score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">70</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;status&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Active&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;country&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;United States&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;city&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;New York&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;isp&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Example ISP&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;is_known_bad_actor&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;abuse_score&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">45</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;lat&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">40.7128</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;lng&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">-74.006</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;meta&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;total&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">42</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;page&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;page_size&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">20</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Get Actor by IP</h3><p>Returns the full profile for a specific threat actor.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/actors/:ip</code></td></tr><tr><td>URL Param</td><td><code>:ip</code> â€” the IP address of the actor</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/203.0.113.50&quot;</span></div></pre></div></div><h3>Block Actor</h3><p>Blocks a threat actor by IP. The IP is added to the blocklist and all future requests from this IP are rejected.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>POST /sentinel/api/actors/:ip/block</code></td></tr><tr><td>URL Param</td><td><code>:ip</code> â€” the IP address to block</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X POST -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/203.0.113.50/block&quot;</span></div></pre></div></div><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">Response</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">json</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;message&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Actor blocked&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Actor Request History</h3><p>Returns the threat events associated with a specific actor IP.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/actors/:ip/requests</code></td></tr><tr><td>URL Param</td><td><code>:ip</code> â€” the IP address of the actor</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/203.0.113.50/requests&quot;</span></div></pre></div></div><h3>List Blocked IPs</h3><p>Returns all currently blocked IPs and CIDR ranges.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/ip/blocked</code></td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/blocked&quot;</span></div></pre></div></div><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">Response</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">json</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;data&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;ip&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.50&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;reason&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Blocked via dashboard&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;blocked_at&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;2025-01-15T14:50:00Z&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;expires_at&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token null keyword" style="color:rgb(12, 150, 155)">null</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;cidr&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;ip&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;198.51.100.0/24&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;reason&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Known botnet range&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;blocked_at&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;2025-01-14T09:00:00Z&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;expires_at&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token null keyword" style="color:rgb(12, 150, 155)">null</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token property" style="color:rgb(12, 150, 155)">&quot;cidr&quot;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Block IP</h3><p>Adds an IP or CIDR range to the blocklist.</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>POST /sentinel/api/ip/block</code></td></tr><tr><td>Body</td><td>JSON with <code>ip</code> (required), <code>reason</code>, <code>expiry</code> (optional, RFC3339)</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Block a single IP</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X POST -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -d &#x27;{&quot;ip&quot;: &quot;203.0.113.75&quot;, &quot;reason&quot;: &quot;Manual block&quot;}&#x27; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/block&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Block a CIDR range with expiration</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X POST -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -d &#x27;{&quot;ip&quot;: &quot;198.51.100.0/24&quot;, &quot;reason&quot;: &quot;Temporary block&quot;, &quot;expiry&quot;: &quot;2025-02-15T00:00:00Z&quot;}&#x27; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/block&quot;</span></div></pre></div></div><h3>Unblock IP</h3><p>Removes an IP or CIDR range from the blocklist. For CIDR ranges, replace <code>/</code> <!-- -->with <code>_</code> in the URL parameter (e.g., <code>198.51.100.0_24</code>).</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>DELETE /sentinel/api/ip/block/:ip</code></td></tr><tr><td>URL Param</td><td><code>:ip</code> â€” the IP or CIDR (with <code>/</code> replaced by <code>_</code>)</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Unblock a single IP</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X DELETE -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/block/203.0.113.75&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Unblock a CIDR range (replace / with _)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X DELETE -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/block/198.51.100.0_24&quot;</span></div></pre></div></div><h3>IP Reputation Lookup</h3><p>Retrieves the AbuseIPDB reputation data for a specific IP (requires IP reputation to be enabled).</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td><code>GET /sentinel/api/ip/:ip/reputation</code></td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer &lt;token&gt;&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/203.0.113.50/reputation&quot;</span></div></pre></div></div><h2 id="testing">Testing</h2><p>After enabling the WAF or any other detection feature, threat actor profiles are created automatically. You can verify the intelligence system is working by triggering a few test events and then querying the actors API.</p><h3>Step 1: Trigger Security Events</h3><p>Send a few malicious requests to generate threat events. These will automatically create actor profiles.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Trigger a SQL injection event</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s &quot;http://localhost:8080/api/data?id=1&#x27;+OR+&#x27;1&#x27;=&#x27;1&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Trigger an XSS event</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s &quot;http://localhost:8080/api/data?q=&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Trigger a path traversal event</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s &quot;http://localhost:8080/api/data/../../../../etc/passwd&quot;</span></div></pre></div></div><h3>Step 2: Log In to the Dashboard API</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Obtain a JWT token</span></div><div class="token-line" style="color:#403f53"><span class="token plain">TOKEN=$(curl -s -X POST http://localhost:8080/sentinel/api/auth/login \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -d &#x27;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;sentinel&quot;}&#x27; | jq -r &#x27;.token&#x27;)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">echo $TOKEN</span></div></pre></div></div><h3>Step 3: View Actor Profiles</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># List all actors</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># View a specific actor (use your test IP, likely 127.0.0.1)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/127.0.0.1&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># View the threat history for an actor</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/127.0.0.1/requests&quot; | jq .</span></div></pre></div></div><h3>Step 4: Test IP Blocking</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Block an actor</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X POST -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/actors/203.0.113.50/block&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Verify the IP appears in the blocklist</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/blocked&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Unblock the IP</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -s -X DELETE -H &quot;Authorization: Bearer $TOKEN&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;http://localhost:8080/sentinel/api/ip/block/203.0.113.50&quot; | jq .</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-x mt-0.5 flex-shrink-0 text-red-500"><circle cx="12" cy="12" r="10"></circle><path d="m15 9-6 6"></path><path d="m9 9 6 6"></path></svg><div><p class="font-semibold text-sm mb-1 text-red-800 dark:text-red-300">Local Testing Note</p><div class="text-sm text-gray-700 dark:text-gray-300">When testing locally, all requests originate from <code>127.0.0.1</code> or<!-- --> <code>::1</code>, so all test events will be attributed to a single actor profile. Geolocation lookups are skipped for private and loopback IPs. To test with realistic geographic data, deploy to a staging environment and send requests from external IPs.</div></div></div></div><h2>Next Steps</h2><ul><li><a href="/docs/waf">WAF</a> â€” Configure the WAF rules that generate threat events</li><li><a href="/docs/auth-shield">Auth Shield</a> â€” Protect login endpoints from brute-force attacks</li><li><a href="/docs/anomaly-detection">Anomaly Detection</a> â€” Add behavioral analysis for advanced threat detection</li><li><a href="/docs/alerting">Alerting</a> â€” Get notified when high-risk actors are detected</li><li><a href="/docs/the-dashboard">Dashboard</a> â€” Explore the Actors and IP Management pages</li></ul><!--$--><!--/$--></main></div></div><script src="/_next/static/chunks/a339dcc3b98340b3.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[82031,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"ThemeProvider\"]\n3:I[95401,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"default\"]\n4:I[45121,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n5:I[60512,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n6:I[99113,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ClientSegmentRoot\"]\n7:I[45693,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\"],\"default\"]\n72:I[50025,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n:HL[\"/_next/static/chunks/a68d47cca58670f5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"5Swj18oapgqGqSZX8fol6\",\"c\":[\"\",\"docs\",\"threat-intelligence\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[\"threat-intelligence\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/a68d47cca58670f5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/4cc5a908347f559b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"min-h-screen antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/c23263069b7f7ba3.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"Component\":\"$7\",\"slots\":{\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"serverProvidedParams\":{\"params\":{},\"promises\":[\"$@8\"]}}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"Threat Intelligence\"}],[\"$\",\"p\",null,{\"children\":\"Sentinel automatically profiles every IP address that triggers a security event. The Threat Intelligence system builds persistent actor profiles, computes risk scores, enriches data with geolocation and IP reputation, and provides tools to manage IP blocklists and whitelists. All of this happens automatically as events flow through the pipeline â€” no manual configuration is required to start collecting intelligence.\"}],[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Automatic Profiling\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"Threat actor profiling is always active when any detection feature is enabled (WAF, Auth Shield, Anomaly Detection). Every security event automatically creates or updates the corresponding actor profile. You do not need to enable profiling separately.\"}]]}]]}]}],\"$L9\",\"$La\",\"$Lb\",\"$Lc\",\"$Ld\",\"$Le\",\"$Lf\",\"$L10\",\"$L11\",\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\",\"$L17\",\"$L18\",\"$L19\",\"$L1a\",\"$L1b\",\"$L1c\",\"$L1d\",\"$L1e\",\"$L1f\",\"$L20\",\"$L21\",\"$L22\",\"$L23\",\"$L24\",\"$L25\",\"$L26\",\"$L27\",\"$L28\",\"$L29\",\"$L2a\",\"$L2b\",\"$L2c\",\"$L2d\",\"$L2e\",\"$L2f\",\"$L30\",\"$L31\",\"$L32\",\"$L33\",\"$L34\",\"$L35\",\"$L36\",\"$L37\",\"$L38\",\"$L39\",\"$L3a\",\"$L3b\",\"$L3c\",\"$L3d\",\"$L3e\",\"$L3f\",\"$L40\",\"$L41\",\"$L42\",\"$L43\",\"$L44\",\"$L45\",\"$L46\",\"$L47\",\"$L48\",\"$L49\",\"$L4a\",\"$L4b\",\"$L4c\",\"$L4d\",\"$L4e\",\"$L4f\",\"$L50\",\"$L51\",\"$L52\",\"$L53\",\"$L54\",\"$L55\",\"$L56\",\"$L57\",\"$L58\",\"$L59\",\"$L5a\",\"$L5b\",\"$L5c\",\"$L5d\",\"$L5e\",\"$L5f\",\"$L60\",\"$L61\",\"$L62\",\"$L63\",\"$L64\",\"$L65\",\"$L66\",\"$L67\",\"$L68\",\"$L69\",\"$L6a\",\"$L6b\",\"$L6c\",\"$L6d\",\"$L6e\"],[\"$L6f\"],\"$L70\"]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$L71\",false]],\"m\":\"$undefined\",\"G\":[\"$72\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"73:I[99151,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\",\"/_next/static/chunks/2425b678dfc0c3cf.js\"],\"default\"]\n74:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"OutletBoundary\"]\n75:\"$Sreact.suspense\"\n77:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ViewportBoundary\"]\n79:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"MetadataBoundary\"]\n9:[\"$\",\"h2\",null,{\"id\":\"threat-actor-profiles\",\"children\":\"Threat Actor Profiles\"}]\na:[\"$\",\"p\",null,{\"children\":\"Every unique IP address that triggers a security event receives a persistent profile. The profiler runs as a pipeline handler, processing each threat event asynchronously and updating the corresponding actor record in storage.\"}]\nb:[\"$\",\"h3\",null,{\"children\":\"Profile Fields\"}]\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"IP\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"The IP address that uniquely identifies this actor.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FirstSeen\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"time.Time\"}]}],[\"$\",\"td\",null,{\"children\":\"Timestamp of the first security event from this IP.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"LastSeen\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"time.Time\"}]}],[\"$\",\"td\",null,{\"children\":\"Timestamp of the most recent security event from this IP.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ThreatCount\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"int\"}]}],[\"$\",\"td\",null,{\"children\":\"Total number of security events attributed to this IP.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AttackTypes\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"[]string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Deduplicated list of attack types observed (e.g., \",[\"$\",\"code\",null,{\"children\":\"SQLInjection\"}],\", \",[\"$\",\"code\",null,{\"children\":\"XSS\"}],\", \",[\"$\",\"code\",null,{\"children\":\"BruteForce\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"TargetedRoutes\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"[]string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Deduplicated list of routes this actor has targeted (e.g., \",[\"$\",\"code\",null,{\"children\":\"GET /api/users\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RiskScore\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"int\"}]}],[\"$\",\"td\",null,{\"children\":[\"Computed risk score from 0 to 100. See \",[\"$\",\"a\",null,{\"href\":\"#risk-scoring\",\"children\":\"Risk Scoring\"}],\" below.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Status\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ActorStatus\"}]}],[\"$\",\"td\",null,{\"children\":[\"Current status: \",[\"$\",\"code\",null,{\"children\":\"Active\"}],\", \",[\"$\",\"code\",null,{\"children\":\"Blocked\"}],\", or \",[\"$\",\"code\",null,{\"children\":\"Whitelisted\"}],\".\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Country\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Country of origin (populated by geolocation if enabled).\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"City\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"City of origin (populated by geolocation if enabled).\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ISP\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Internet service provider of the IP.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Lat\"}],\" / \",[\"$\",\"code\",null,{\"children\":\"Lng\"}]]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"float64\"}]}],[\"$\",\"td\",null,{\"children\":\"Geographic coordinates for map visualization in the dashboard.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"IsKnownBadActor\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"bool\"}]}],[\"$\",\"td\",null,{\"children\":[\"Set to \",[\"$\",\"code\",null,{\"children\":\"true\"}],\" if the IP has a high abuse score from IP reputation checking.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AbuseScore\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"int\"}]}],[\"$\",\"td\",null,{\"children\":\"Abuse confidence score from AbuseIPDB (0-100).\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"p\",null,{\"children\":\"Profiles are created on the first event and updated incrementally on each subsequent event. Attack types and targeted routes are deduplicated, so the lists grow only when new distinct values appear.\"}]\ne:[\"$\",\"$L73\",null,{\"language\":\"go\",\"filename\":\"core/models.go\",\"code\":\"// ThreatActor represents a persistent profile of an attacker.\\ntype ThreatActor struct {\\n    ID              string      `json:\\\"id\\\"`\\n    IP              string      `json:\\\"ip\\\"`\\n    FirstSeen       time.Time   `json:\\\"first_seen\\\"`\\n    LastSeen        time.Time   `json:\\\"last_seen\\\"`\\n    TotalRequests   int         `json:\\\"total_requests\\\"`\\n    ThreatCount     int         `json:\\\"threat_count\\\"`\\n    AttackTypes     []string    `json:\\\"attack_types\\\"`\\n    TargetedRoutes  []string    `json:\\\"targeted_routes\\\"`\\n    RiskScore       int         `json:\\\"risk_score\\\"`\\n    Status          ActorStatus `json:\\\"status\\\"`\\n    Country         string      `json:\\\"country\\\"`\\n    City            string      `json:\\\"city,omitempty\\\"`\\n    ISP             string      `json:\\\"isp\\\"`\\n    IsKnownBadActor bool        `json:\\\"is_known_bad_actor\\\"`\\n    AbuseScore      int         `json:\\\"abuse_score\\\"`\\n    Lat             float64     `json:\\\"lat\\\"`\\n    Lng             float64     `json:\\\"lng\\\"`\\n}\"}]\nf:[\"$\",\"h2\",null,{\"id\":\"risk-scoring\",\"children\":\"Risk Scoring\"}]\n10:[\"$\",\"p\",null,{\"children\":\"Each threat actor is assigned a risk score between 0 and 100. The score is recomputed every time a new threat event is attributed to the actor. The scoring algorithm considers four factors:\"}]\n11:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Factor\"}],[\"$\",\"th\",null,{\"children\":\"Points\"}],[\"$\",\"th\",null,{\"children\":\"Condition\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Attack Variety\"}],[\"$\",\"td\",null,{\"children\":\"+10 per unique type (max 50)\"}],[\"$\",\"td\",null,{\"children\":[\"Each distinct attack type in \",[\"$\",\"code\",null,{\"children\":\"AttackTypes\"}],\" adds 10 points, capped at 50.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Known Bad Actor\"}],[\"$\",\"td\",null,{\"children\":\"+20\"}],[\"$\",\"td\",null,{\"children\":[\"IP has been flagged by AbuseIPDB (\",[\"$\",\"code\",null,{\"children\":\"IsKnownBadActor == true\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Recency\"}],[\"$\",\"td\",null,{\"children\":\"+10\"}],[\"$\",\"td\",null,{\"children\":\"The most recent attack was within the last hour.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Volume\"}],[\"$\",\"td\",null,{\"children\":\"+20\"}],[\"$\",\"td\",null,{\"children\":\"Total threat count exceeds 100 events.\"}]]}]]}]]}]\n12:[\"$\",\"p\",null,{\"children\":\"The final score is capped at 100. An actor with 5 unique attack types, a recent attack, over 100 events, and a known-bad reputation would score the maximum of 100.\"}]\n13:[\"$\",\"$L73\",null,{\"language\":\"go\",\"filename\":\"intelligence/profiler.go\",\"code\":\"// ComputeRiskScore calculates a risk score (0-100) for a threat actor.\\nfunc ComputeRiskScore(actor *sentinel.ThreatActor) int {\\n    score := 0\\n\\n    // +10 for each unique attack type, max 50\\n    attackTypeScore := len(actor.AttackTypes) * 10\\n    if attackTypeScore \u003e 50 {\\n        attackTypeScore = 50\\n    }\\n    score += attackTypeScore\\n\\n    // +20 if known bad actor (AbuseIPDB)\\n    if actor.IsKnownBadActor {\\n        score += 20\\n    }\\n\\n    // +10 if attacked in last hour\\n    if time.Since(actor.LastSeen) \u003c time.Hour {\\n        score += 10\\n    }\\n\\n    // +20 if attack count \u003e 100\\n    if actor.ThreatCount \u003e 100 {\\n        score += 20\\n    }\\n\\n    if score \u003e 100 {\\n        score = 100\\n    }\\n    return score\\n}\"}]\n14:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none"])</script><script>self.__next_f.push([1,"\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500\",\"children\":[[\"$\",\"path\",\"yps3ct\",{\"d\":\"M21.801 10A10 10 0 1 1 17 3.335\"}],[\"$\",\"path\",\"1pflzl\",{\"d\":\"m9 11 3 3L22 4\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-green-800 dark:text-green-300\",\"children\":\"Risk Score Interpretation\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[[\"$\",\"strong\",null,{\"children\":\"0-20:\"}],\" Low risk, minimal activity.\",\" \",[\"$\",\"strong\",null,{\"children\":\"21-50:\"}],\" Moderate risk, multiple attack types or sustained activity.\",\" \",[\"$\",\"strong\",null,{\"children\":\"51-80:\"}],\" High risk, diverse attack patterns or known bad reputation.\",\" \",[\"$\",\"strong\",null,{\"children\":\"81-100:\"}],\" Critical risk, consider immediate blocking.\"]}]]}]]}]}]\n15:[\"$\",\"h2\",null,{\"id\":\"ip-reputation\",\"children\":\"IP Reputation\"}]\n16:[\"$\",\"p\",null,{\"children\":[\"Sentinel can optionally enrich threat actor profiles with external IP reputation data from\",\" \",[\"$\",\"strong\",null,{\"children\":\"AbuseIPDB\"}],\". When enabled, the reputation checker queries the AbuseIPDB API for each IP that triggers a security event, retrieves its abuse confidence score, and can automatically block IPs that exceed a configurable threshold.\"]}]\n17:[\"$\",\"h3\",null,{\"children\":\"IPReputationConfig\"}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Default\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Enabled\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"bool\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"false\"}]}],[\"$\",\"td\",null,{\"children\":\"Enables IP reputation checking.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AbuseIPDBKey\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\\"\\\"\"}]}],[\"$\",\"td\",null,{\"children\":[\"Your AbuseIPDB API key. Required for reputation lookups. Obtain one from \",[\"$\",\"code\",null,{\"children\":\"abuseipdb.com\"}],\".\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AutoBlock\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"bool\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"false\"}]}],[\"$\",\"td\",null,{\"children\":[\"Automatically block IPs whose abuse score meets or exceeds \",[\"$\",\"code\",null,{\"children\":\"MinAbuseScore\"}],\".\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"MinAbuseScore\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"int\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"80\"}]}],[\"$\",\"td\",null,{\"children\":\"Minimum AbuseIPDB confidence score (0-100) to trigger auto-blocking.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"$L73\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"sentinel.Mount(r, nil, sentinel.Config{\\n    IPReputation: sentinel.IPReputationConfig{\\n        Enabled:       true,\\n        AbuseIPDBKey:  \\\"your-abuseipdb-api-key\\\",\\n        AutoBlock:     true,\\n        MinAbuseScore: 80, // Block IPs with 80%+ abuse confidence\\n    },\\n})\"}]\n1a:[\"$\",\"p\",null,{\"children\":[\"Reputation results are cached for 24 hours to minimize API calls. The cache is maintained in memory and cleared on application restart. When \",[\"$\",\"code\",null,{\"children\":\"AutoBlock\"}],\" is enabled and an IP exceeds the threshold, it is immediately added to the blocklist via the IP Manager.\"]}]\n1b:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300\",\"children\":\"AbuseIPDB Rate Limits\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"The free AbuseIPDB plan allows 1,000 checks per day. If your application processes a high volume of unique attacker IPs, consider upgrading your AbuseIPDB plan or increasing\",\" \",[\"$\",\"code\",null,{\"children\":\"MinAbuseScore\"}],\" to reduce the number of reputation lookups triggered by low-confidence threats.\"]}]]}]]}]}]\n1c:[\"$\",\"h2\",null,{\"id\":\"geolocation\",\"children\":\"Geolocation\"}]\n1d:[\"$\",\"p\",null,{\"children\":\"When geolocation is enabled, Sentinel resolves the geographic origin of each attacker IP and attaches country, city, coordinates, ISP, and ASN data to both the threat event and the actor profile. This data powers the geographic attack map in the dashboard.\"}]\n1e:[\"$\",\"h3\",null,{\"children\":\"GeoConfig\"}]\n1f:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Default\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Enabled\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"bool\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"false\"}]}],[\"$\",\"td\",null,{\"children\":\"Enables IP geolocation lookups.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Provider\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GeoProvider\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GeoIPFree\"}]}],[\"$\",\"td\",null,{\"children\":[\"The geolocation provider. Default uses the free \",[\"$\",\"code\",null,{\"children\":\"ip-api.com\"}],\" service (no API key required).\"]}]]}]]}]]}]\n20:[\"$\",\"$L73\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"sentinel.Mount(r, nil, sentinel.Config{\\n    Geo: sentinel.GeoConfig{\\n        Enabled:  true,\\n        Provider: sentinel.GeoIPFree, // Free provider, no API key needed\\n    },\\n})\"}]\n21:[\"$\",\"p\",null,{\"children\":[\"Geolocation results are cached in an LRU cache (default 10,000 entries) to minimize external API calls. Private and loopback IPs (e.g., \",[\"$\",\"code\",null,{\"children\":\"127.0.0.1\"}],\",\",\" \",[\"$\",\"code\",null,{\"children\":\"10.x.x.x\"}],\", \",[\"$\",\"code\",null,{\"children\":\"192.168.x.x\"}],\") are skipped automatically.\"]}]\n22:[\"$\",\"h3\",null,{\"children\":\"GeoResult Fields\"}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Country\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Full country name (e.g., \",[\"$\",\"code\",null,{\"children\":\"United States\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"CountryCode\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":[\"ISO 3166-1 alpha-2 country code (e.g., \",[\"$\",\"code\",null,{\"children\":\"US\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"City\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"City name.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Lat\"}],\" / \",[\"$\",\"code\",null,{\"children\":\"Lng\"}]]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"float64\"}]}],[\"$\",\"td\",null,{\"children\":\"Geographic coordinates.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ISP\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Internet service provider.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ASN\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Autonomous system number and name.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Production Geolocation\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"The free \",[\"$\",\"code\",null,{\"children\":\"ip-api.com\"}],\" provider is rate-limited to 45 requests per minute. For production workloads with high traffic, consider using a local MaxMind GeoLite2 database for offline lookups with no rate limits.\"]}]]}]]}]}]\n25:[\"$\",\"h2\",null,{\"id\":\"ip-management\",\"children\":\"IP Management\"}]\n26:[\"$\",\"p\",null,{\"children\":\"The IP Manager provides a centralized system for blocking and whitelisting IP addresses and CIDR ranges. It maintains an in-memory cache that syncs from storage every 30 seconds, ensuring fast per-request lookups with no database overhead on the hot path.\"}]\n27:[\"$\",\"h3\",null,{\"children\":\"Blocking IPs\"}]\n28:[\"$\",\"p\",null,{\"children\":\"Blocked IPs are rejected by the middleware before reaching your application handlers. You can block individual IPs or entire CIDR ranges. Blocks can optionally have an expiration time.\"}]\n29:[\"$\",\"$L73\",null,{\"language\":\"go\",\"code\":\"// Block a single IP with no expiration\\nipManager.BlockIP(ctx, \\\"203.0.113.50\\\", \\\"Repeated SQL injection attempts\\\", nil)\\n\\n// Block a CIDR range\\nipManager.BlockIP(ctx, \\\"198.51.100.0/24\\\", \\\"Known botnet range\\\", nil)\\n\\n// Block with expiration (auto-unblock after 24 hours)\\nexpiry := time.Now().Add(24 * time.Hour)\\nipManager.BlockIP(ctx, \\\"203.0.113.75\\\", \\\"Temporary block\\\", \u0026expiry)\"}]\n2a:[\"$\",\"h3\",null,{\"children\":\"Whitelisting IPs\"}]\n2b:[\"$\",\"p\",null,{\"children\":\"Whitelisted IPs bypass all security checks including the WAF, rate limiting, and Auth Shield. Use this for trusted internal services, monitoring systems, and CI/CD pipelines.\"}]\n2c:[\"$\",\"$L73\",null,{\"language\":\"go\",\"code\":\"// Whitelist a trusted IP\\nipManager.WhitelistIP(ctx, \\\"10.0.0.5\\\")\"}]\n2d:[\"$\",\"h3\",null,{\"children\":\"How the Cache Works\"}]\n2e:[\"$\",\"p\",null,{\"children\":\"The IP Manager loads all blocked and whitelisted IPs into memory at startup. A background goroutine re-syncs from storage every 30 seconds to pick up changes made via the API or dashboard. Blocking and whitelisting operations update both storage and the in-memory cache immediately, so changes take effect without waiting for the next sync cycle.\"}]\n2f:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300\",\"children\":\"CIDR Matching\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"When you block a CIDR range like \",[\"$\",\"code\",null,{\"children\":\"198.51.100.0/24\"}],\", every IP within that range"])</script><script>self.__next_f.push([1," is matched. The IP Manager parses CIDR notation and performs subnet containment checks. Individual IP blocks use exact string matching for maximum performance.\"]}]]}]]}]}]\n30:[\"$\",\"h2\",null,{\"id\":\"full-configuration\",\"children\":\"Full Configuration Example\"}]\n31:[\"$\",\"p\",null,{\"children\":\"The following example enables all threat intelligence features: profiling, geolocation, IP reputation with auto-blocking, and the WAF for event generation.\"}]\n32:[\"$\",\"$L73\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"package main\\n\\nimport (\\n    sentinel \\\"github.com/MUKE-coder/sentinel\\\"\\n    \\\"github.com/gin-gonic/gin\\\"\\n)\\n\\nfunc main() {\\n    r := gin.Default()\\n\\n    sentinel.Mount(r, nil, sentinel.Config{\\n        // WAF generates the threat events that feed the profiler\\n        WAF: sentinel.WAFConfig{\\n            Enabled: true,\\n            Mode:    sentinel.ModeBlock,\\n        },\\n\\n        // IP reputation enrichment with auto-blocking\\n        IPReputation: sentinel.IPReputationConfig{\\n            Enabled:       true,\\n            AbuseIPDBKey:  \\\"your-abuseipdb-api-key\\\",\\n            AutoBlock:     true,\\n            MinAbuseScore: 80,\\n        },\\n\\n        // Geolocation for geographic attribution\\n        Geo: sentinel.GeoConfig{\\n            Enabled:  true,\\n            Provider: sentinel.GeoIPFree,\\n        },\\n    })\\n\\n    r.GET(\\\"/api/data\\\", func(c *gin.Context) {\\n        c.JSON(200, gin.H{\\\"status\\\": \\\"ok\\\"})\\n    })\\n\\n    r.Run(\\\":8080\\\")\\n}\"}]\n33:[\"$\",\"h2\",null,{\"id\":\"dashboard\",\"children\":\"Dashboard\"}]\n34:[\"$\",\"p\",null,{\"children\":\"The Sentinel dashboard provides two dedicated pages for threat intelligence:\"}]\n35:[\"$\",\"h3\",null,{\"children\":\"Actors Page\"}]\n36:[\"$\",\"p\",null,{\"children\":\"The Actors page lists all threat actor profiles with sortable columns for IP, risk score, threat count, attack types, country, and last seen time. From this page you can:\"}]\n37:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"Search and filter actors by IP, status, or minimum risk score.\"}],[\"$\",\"li\",null,{\"children\":\"View the full profile for any actor, including their complete attack history.\"}],[\"$\",\"li\",null,{\"children\":\"Block an actor directly from their profile with a single click.\"}],[\"$\",\"li\",null,{\"children\":\"View geographic data and the attack types observed for each actor.\"}]]}]\n38:[\"$\",\"h3\",null,{\"children\":\"IP Management Page\"}]\n39:[\"$\",\"p\",null,{\"children\":\"The IP Management page provides a visual interface for managing your blocklist and whitelist:\"}]\n3a:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"View all currently blocked IPs and CIDR ranges with block reasons and timestamps.\"}],[\"$\",\"li\",null,{\"children\":\"Add new IPs or CIDR ranges to the blocklist with an optional expiration.\"}],[\"$\",\"li\",null,{\"children\":\"Unblock IPs that were previously blocked manually or by auto-blocking.\"}],[\"$\",\"li\",null,{\"children\":\"Manage the whitelist for trusted IPs.\"}]]}]\n3b:[\"$\",\"p\",null,{\"children\":[\"Access these pages at\",\" \",[\"$\",\"code\",null,{\"children\":\"http://localhost:8080/sentinel/ui\"}],\" and navigate to the Actors or IP Management sections.\"]}]\n3c:[\"$\",\"h2\",null,{\"id\":\"api\",\"children\":\"API Reference\"}]\n3d:[\"$\",\"p\",null,{\"children\":[\"All threat intelligence endpoints require authentication via the dashboard JWT token. Include the token in the \",[\"$\",\"code\",null,{\"children\":\"Authorization\"}],\" header as\",\" \",[\"$\",\"code\",null,{\"children\":\"Bearer \u003ctoken\u003e\"}],\".\"]}]\n3e:[\"$\",\"h3\",null,{\"children\":\"List Actors\"}]\n3f:[\"$\",\"p\",null,{\"children\":\"Returns a paginated list of threat actor profiles with optional filtering.\"}]\n40:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/actors\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Query Params\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\""])</script><script>self.__next_f.push([1,":\"status\"}],\", \",[\"$\",\"code\",null,{\"children\":\"min_risk\"}],\", \",[\"$\",\"code\",null,{\"children\":\"search\"}],\",\",\" \",[\"$\",\"code\",null,{\"children\":\"page\"}],\", \",[\"$\",\"code\",null,{\"children\":\"page_size\"}]]}]]}]]}]]}]\n41:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# List all actors, sorted by default\\ncurl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors?page=1\u0026page_size=20\\\"\\n\\n# Filter by minimum risk score\\ncurl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors?min_risk=50\\\"\\n\\n# Filter by status\\ncurl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors?status=Active\\\"\"}]\n42:[\"$\",\"$L73\",null,{\"language\":\"json\",\"filename\":\"Response\",\"showLineNumbers\":false,\"code\":\"{\\n  \\\"data\\\": [\\n    {\\n      \\\"id\\\": \\\"203.0.113.50\\\",\\n      \\\"ip\\\": \\\"203.0.113.50\\\",\\n      \\\"first_seen\\\": \\\"2025-01-15T08:23:00Z\\\",\\n      \\\"last_seen\\\": \\\"2025-01-15T14:45:00Z\\\",\\n      \\\"total_requests\\\": 347,\\n      \\\"threat_count\\\": 89,\\n      \\\"attack_types\\\": [\\\"SQLInjection\\\", \\\"XSS\\\", \\\"PathTraversal\\\"],\\n      \\\"targeted_routes\\\": [\\\"GET /api/users\\\", \\\"POST /api/search\\\"],\\n      \\\"risk_score\\\": 70,\\n      \\\"status\\\": \\\"Active\\\",\\n      \\\"country\\\": \\\"United States\\\",\\n      \\\"city\\\": \\\"New York\\\",\\n      \\\"isp\\\": \\\"Example ISP\\\",\\n      \\\"is_known_bad_actor\\\": false,\\n      \\\"abuse_score\\\": 45,\\n      \\\"lat\\\": 40.7128,\\n      \\\"lng\\\": -74.006\\n    }\\n  ],\\n  \\\"meta\\\": {\\n    \\\"total\\\": 42,\\n    \\\"page\\\": 1,\\n    \\\"page_size\\\": 20\\n  }\\n}\"}]\n43:[\"$\",\"h3\",null,{\"children\":\"Get Actor by IP\"}]\n44:[\"$\",\"p\",null,{\"children\":\"Returns the full profile for a specific threat actor.\"}]\n45:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/actors/:ip\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"URL Param\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\":ip\"}],\" â€” the IP address of the actor\"]}]]}]]}]]}]\n46:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/203.0.113.50\\\"\"}]\n47:[\"$\",\"h3\",null,{\"children\":\"Block Actor\"}]\n48:[\"$\",\"p\",null,{\"children\":\"Blocks a threat actor by IP. The IP is added to the blocklist and all future requests from this IP are rejected.\"}]\n49:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"POST /sentinel/api/actors/:ip/block\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"URL Param\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\":ip\"}],\" â€” the IP address to block\"]}]]}]]}]]}]\n4a:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -X POST -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/203.0.113.50/block\\\"\"}]\n4b:[\"$\",\"$L73\",null,{\"language\":\"json\",\"filename\":\"Response\",\"showLineNumbers\":false,\"code\":\"{\\n  \\\"message\\\": \\\"Actor blocked\\\"\\n}\"}]\n4c:[\"$\",\"h3\",null,{\"children\":\"Actor Request History\"}]\n4d:[\"$\",\"p\",null,{\"children\":\"Returns the threat events associated with a specific actor IP.\"}]\n4e:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/actors/:ip/requests\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{"])</script><script>self.__next_f.push([1,"\"children\":\"URL Param\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\":ip\"}],\" â€” the IP address of the actor\"]}]]}]]}]]}]\n4f:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/203.0.113.50/requests\\\"\"}]\n50:[\"$\",\"h3\",null,{\"children\":\"List Blocked IPs\"}]\n51:[\"$\",\"p\",null,{\"children\":\"Returns all currently blocked IPs and CIDR ranges.\"}]\n52:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/ip/blocked\"}]}]]}]}]]}]\n53:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/blocked\\\"\"}]\n54:[\"$\",\"$L73\",null,{\"language\":\"json\",\"filename\":\"Response\",\"showLineNumbers\":false,\"code\":\"{\\n  \\\"data\\\": [\\n    {\\n      \\\"ip\\\": \\\"203.0.113.50\\\",\\n      \\\"reason\\\": \\\"Blocked via dashboard\\\",\\n      \\\"blocked_at\\\": \\\"2025-01-15T14:50:00Z\\\",\\n      \\\"expires_at\\\": null,\\n      \\\"cidr\\\": false\\n    },\\n    {\\n      \\\"ip\\\": \\\"198.51.100.0/24\\\",\\n      \\\"reason\\\": \\\"Known botnet range\\\",\\n      \\\"blocked_at\\\": \\\"2025-01-14T09:00:00Z\\\",\\n      \\\"expires_at\\\": null,\\n      \\\"cidr\\\": true\\n    }\\n  ]\\n}\"}]\n55:[\"$\",\"h3\",null,{\"children\":\"Block IP\"}]\n56:[\"$\",\"p\",null,{\"children\":\"Adds an IP or CIDR range to the blocklist.\"}]\n57:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"POST /sentinel/api/ip/block\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Body\"}],[\"$\",\"td\",null,{\"children\":[\"JSON with \",[\"$\",\"code\",null,{\"children\":\"ip\"}],\" (required), \",[\"$\",\"code\",null,{\"children\":\"reason\"}],\", \",[\"$\",\"code\",null,{\"children\":\"expiry\"}],\" (optional, RFC3339)\"]}]]}]]}]]}]\n58:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Block a single IP\\ncurl -s -X POST -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  -H \\\"Content-Type: application/json\\\" \\\\\\n  -d '{\\\"ip\\\": \\\"203.0.113.75\\\", \\\"reason\\\": \\\"Manual block\\\"}' \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/block\\\"\\n\\n# Block a CIDR range with expiration\\ncurl -s -X POST -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  -H \\\"Content-Type: application/json\\\" \\\\\\n  -d '{\\\"ip\\\": \\\"198.51.100.0/24\\\", \\\"reason\\\": \\\"Temporary block\\\", \\\"expiry\\\": \\\"2025-02-15T00:00:00Z\\\"}' \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/block\\\"\"}]\n59:[\"$\",\"h3\",null,{\"children\":\"Unblock IP\"}]\n5a:[\"$\",\"p\",null,{\"children\":[\"Removes an IP or CIDR range from the blocklist. For CIDR ranges, replace \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" \",\"with \",[\"$\",\"code\",null,{\"children\":\"_\"}],\" in the URL parameter (e.g., \",[\"$\",\"code\",null,{\"children\":\"198.51.100.0_24\"}],\").\"]}]\n5b:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"DELETE /sentinel/api/ip/block/:ip\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"URL Param\"}],[\"$\",\"td\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\":ip\"}],\" â€” the IP or CIDR (with \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" replaced by \",[\"$\",\"code\",null,{\"children\":\"_\"}],\")\"]}]]}]]}]]}]\n5c:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Unblock a single IP\\ncurl -s -X DELETE -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/block/203.0.113.75\\\"\\n\\n# Unblock a CIDR r"])</script><script>self.__next_f.push([1,"ange (replace / with _)\\ncurl -s -X DELETE -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/block/198.51.100.0_24\\\"\"}]\n5d:[\"$\",\"h3\",null,{\"children\":\"IP Reputation Lookup\"}]\n5e:[\"$\",\"p\",null,{\"children\":\"Retrieves the AbuseIPDB reputation data for a specific IP (requires IP reputation to be enabled).\"}]\n5f:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Property\"}],[\"$\",\"th\",null,{\"children\":\"Value\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Endpoint\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"GET /sentinel/api/ip/:ip/reputation\"}]}]]}]}]]}]\n60:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"curl -s -H \\\"Authorization: Bearer \u003ctoken\u003e\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/203.0.113.50/reputation\\\"\"}]\n61:[\"$\",\"h2\",null,{\"id\":\"testing\",\"children\":\"Testing\"}]\n62:[\"$\",\"p\",null,{\"children\":\"After enabling the WAF or any other detection feature, threat actor profiles are created automatically. You can verify the intelligence system is working by triggering a few test events and then querying the actors API.\"}]\n63:[\"$\",\"h3\",null,{\"children\":\"Step 1: Trigger Security Events\"}]\n64:[\"$\",\"p\",null,{\"children\":\"Send a few malicious requests to generate threat events. These will automatically create actor profiles.\"}]\n65:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Trigger a SQL injection event\\ncurl -s \\\"http://localhost:8080/api/data?id=1'+OR+'1'='1\\\"\\n\\n# Trigger an XSS event\\ncurl -s \\\"http://localhost:8080/api/data?q=\u003cscript\u003ealert(1)\u003c/script\u003e\\\"\\n\\n# Trigger a path traversal event\\ncurl -s \\\"http://localhost:8080/api/data/../../../../etc/passwd\\\"\"}]\n66:[\"$\",\"h3\",null,{\"children\":\"Step 2: Log In to the Dashboard API\"}]\n67:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Obtain a JWT token\\nTOKEN=$(curl -s -X POST http://localhost:8080/sentinel/api/auth/login \\\\\\n  -H \\\"Content-Type: application/json\\\" \\\\\\n  -d '{\\\"username\\\":\\\"admin\\\",\\\"password\\\":\\\"sentinel\\\"}' | jq -r '.token')\\n\\necho $TOKEN\"}]\n68:[\"$\",\"h3\",null,{\"children\":\"Step 3: View Actor Profiles\"}]\n69:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# List all actors\\ncurl -s -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors\\\" | jq .\\n\\n# View a specific actor (use your test IP, likely 127.0.0.1)\\ncurl -s -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/127.0.0.1\\\" | jq .\\n\\n# View the threat history for an actor\\ncurl -s -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/127.0.0.1/requests\\\" | jq .\"}]\n6a:[\"$\",\"h3\",null,{\"children\":\"Step 4: Test IP Blocking\"}]\n6b:[\"$\",\"$L73\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Block an actor\\ncurl -s -X POST -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/actors/203.0.113.50/block\\\" | jq .\\n\\n# Verify the IP appears in the blocklist\\ncurl -s -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/blocked\\\" | jq .\\n\\n# Unblock the IP\\ncurl -s -X DELETE -H \\\"Authorization: Bearer $TOKEN\\\" \\\\\\n  \\\"http://localhost:8080/sentinel/api/ip/block/203.0.113.50\\\" | jq .\"}]\n6c:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-circle-x mt-0.5 flex-shrink-0 text-red-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1uzhvr\",{\"d\":\"m15 9-6 6\"}],[\"$\",\"path\",\"z0biqf\",{\"d\":\"m9 9 6 6\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-red-"])</script><script>self.__next_f.push([1,"800 dark:text-red-300\",\"children\":\"Local Testing Note\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"When testing locally, all requests originate from \",[\"$\",\"code\",null,{\"children\":\"127.0.0.1\"}],\" or\",\" \",[\"$\",\"code\",null,{\"children\":\"::1\"}],\", so all test events will be attributed to a single actor profile. Geolocation lookups are skipped for private and loopback IPs. To test with realistic geographic data, deploy to a staging environment and send requests from external IPs.\"]}]]}]]}]}]\n6d:[\"$\",\"h2\",null,{\"children\":\"Next Steps\"}]\n6e:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/waf\",\"children\":\"WAF\"}],\" â€” Configure the WAF rules that generate threat events\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/auth-shield\",\"children\":\"Auth Shield\"}],\" â€” Protect login endpoints from brute-force attacks\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/anomaly-detection\",\"children\":\"Anomaly Detection\"}],\" â€” Add behavioral analysis for advanced threat detection\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/alerting\",\"children\":\"Alerting\"}],\" â€” Get notified when high-risk actors are detected\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/the-dashboard\",\"children\":\"Dashboard\"}],\" â€” Explore the Actors and IP Management pages\"]}]]}]\n6f:[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/2425b678dfc0c3cf.js\",\"async\":true,\"nonce\":\"$undefined\"}]\n70:[\"$\",\"$L74\",null,{\"children\":[\"$\",\"$75\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@76\"}]}]\n71:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L77\",null,{\"children\":\"$L78\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L79\",null,{\"children\":[\"$\",\"$75\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L7a\"}]}]}],null]}]\n8:\"$0:f:0:1:1:children:0:props:children:1:props:serverProvidedParams:params\"\n"])</script><script>self.__next_f.push([1,"78:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"76:null\n7a:[[\"$\",\"title\",\"0\",{\"children\":\"Threat Intelligence - Sentinel Docs\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard.\"}]]\n"])</script></body></html>