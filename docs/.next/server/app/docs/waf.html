<!DOCTYPE html><!--5Swj18oapgqGqSZX8fol6--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/a68d47cca58670f5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/a339dcc3b98340b3.js"/><script src="/_next/static/chunks/bfffc7ec77d3b06a.js" async=""></script><script src="/_next/static/chunks/b9cfbaaba1fd82be.js" async=""></script><script src="/_next/static/chunks/c540f39c8777f86f.js" async=""></script><script src="/_next/static/chunks/turbopack-a8b0537048952335.js" async=""></script><script src="/_next/static/chunks/4cc5a908347f559b.js" async=""></script><script src="/_next/static/chunks/26ca110782d86623.js" async=""></script><script src="/_next/static/chunks/81f0f13d25d49d65.js" async=""></script><script src="/_next/static/chunks/c23263069b7f7ba3.js" async=""></script><script src="/_next/static/chunks/2425b678dfc0c3cf.js" async=""></script><title>WAF - Sentinel Docs</title><meta name="description" content="Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard."/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="min-h-screen antialiased"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><nav class="sticky top-0 z-50 w-full border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-16"><div class="flex items-center gap-8"><a class="flex items-center gap-2.5 group" href="/"><div class="w-8 h-8 rounded-lg bg-gradient-to-br from-sentinel-400 to-sentinel-600 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield text-white"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><span class="font-bold text-lg tracking-tight">Sentinel</span></a><div class="hidden md:flex items-center gap-6"><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors flex items-center gap-1.5" href="/docs/getting-started"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Docs</a><a class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors" href="/docs/api-reference">API</a></div></div><div class="flex items-center gap-3"><div class="hidden sm:block"><button class="flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm text-gray-500 dark:text-gray-400 w-64"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><span class="flex-1 text-left">Search docs...</span><kbd class="hidden sm:flex items-center gap-0.5 text-[10px] font-mono text-gray-400 dark:text-gray-500 bg-gray-200 dark:bg-gray-800 px-1.5 py-0.5 rounded"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-command"><path d="M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"></path></svg> K</kbd></button></div><div class="w-9 h-9"></div><a href="https://github.com/MUKE-coder/sentinel" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github text-gray-600 dark:text-gray-400"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></nav><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><button class="lg:hidden mb-4 p-2 rounded-lg border border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-900"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><div class="flex gap-10"><aside class="hidden lg:block w-64 flex-shrink-0"><div class="sticky top-20 overflow-y-auto max-h-[calc(100vh-5rem)] pb-10 pr-4"><nav class="space-y-6"><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Getting Started</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/getting-started">Introduction</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/configuration">Configuration</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Security</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors bg-sentinel-50 dark:bg-sentinel-950/50 text-sentinel-600 dark:text-sentinel-400 font-medium" href="/docs/waf">WAF</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/rate-limiting">Rate Limiting</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/auth-shield">Auth Shield</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/security-headers">Security Headers</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Intelligence</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/threat-intelligence">Threat Intelligence</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/anomaly-detection">Anomaly Detection</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/security-score">Security Score</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Monitoring</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/the-dashboard">Dashboard</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/performance">Performance</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/alerting">Alerting</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Data</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/audit-logging">Audit Logging</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/ai-analysis">AI Analysis</a></li><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/compliance-reports">Compliance Reports</a></li></ul></div><div><h4 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2 px-3">Reference</h4><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-lg text-sm transition-colors text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-900" href="/docs/api-reference">API Reference</a></li></ul></div></nav></div></aside><main class="min-w-0 flex-1 prose-docs"><h1>Web Application Firewall (WAF)</h1><p>Sentinel includes a built-in Web Application Firewall that inspects every incoming HTTP request for malicious payloads. It provides comprehensive coverage for the<!-- --> <strong>OWASP Top 10</strong> attack categories, including SQL injection, cross-site scripting (XSS), path traversal, command injection, server-side request forgery (SSRF), XML external entity injection (XXE), local file inclusion (LFI), and open redirect attacks.</p><p>The WAF operates as Gin middleware registered by <code>sentinel.Mount()</code>. It runs before your application handlers, so malicious requests are intercepted before they reach your business logic. All detections are recorded as security events and are visible in the Sentinel dashboard.</p><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Zero False Positives by Default</p><div class="text-sm text-gray-700 dark:text-gray-300">Sentinel ships with carefully tuned regex patterns at multiple strictness levels. Start with the defaults, observe traffic in <code>ModeLog</code>, and adjust sensitivity per category as needed for your application.</div></div></div></div><h2 id="enabling">Enabling the WAF</h2><p>The WAF is disabled by default. To enable it, set <code>Enabled: true</code> in your<!-- --> <code>WAFConfig</code> and choose a mode. The simplest configuration enables blocking mode with all default rule sensitivities:</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token keyword" style="color:rgb(12, 150, 155)">package</span><span class="token plain"> main</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    sentinel </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/MUKE-coder/sentinel&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;github.com/gin-gonic/gin&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">main</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    r </span><span class="token operator" style="color:rgb(12, 150, 155)">:=</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Default</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">        WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">            Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">            Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">GET</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/api/data&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">func</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(12, 150, 155)">*</span><span class="token plain">gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">        c</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">JSON</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">200</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> gin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">H</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;status&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;ok&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">    r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Run</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;:8080&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><p>With this configuration, Sentinel inspects every request against all built-in rule categories at their default strictness levels. Malicious requests receive an HTTP 403 response and are logged as security events.</p><h2 id="modes">WAF Modes</h2><p>The WAF supports two primary operating modes. The mode determines what happens when a malicious payload is detected.</p><table><thead><tr><th>Mode</th><th>Constant</th><th>Behavior</th><th>Use Case</th></tr></thead><tbody><tr><td>Log</td><td><code>sentinel.ModeLog</code></td><td>Detects and records threats but <strong>allows the request to proceed</strong>. The event is logged and visible in the dashboard.</td><td>Initial rollout, testing, auditing</td></tr><tr><td>Block</td><td><code>sentinel.ModeBlock</code></td><td>Detects threats and <strong>rejects the request with HTTP 403 Forbidden</strong>. The response includes a JSON body with the block reason.</td><td>Production enforcement</td></tr></tbody></table><h3>ModeLog (Detect Only)</h3><p>In log mode, the WAF identifies malicious payloads and creates security events, but it does not block the request. This is ideal for initial deployment when you want to observe what the WAF detects without impacting real traffic.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeLog</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Detect and log, but don&#x27;t block</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><p>When a threat is detected in log mode, the request continues to your handler normally. The detection is recorded and appears in the dashboard under the Events page with full details including the matched pattern, severity, and request metadata.</p><h3>ModeBlock (Block Malicious Requests)</h3><p>In block mode, detected threats are rejected immediately with an HTTP 403 status code. The request never reaches your application handler. The response body contains a JSON object describing the block:</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Detect and block with 403</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Example blocked response</span></div><div class="token-line" style="color:#403f53"><span class="token plain">HTTP/1.1 403 Forbidden</span></div><div class="token-line" style="color:#403f53"><span class="token plain">Content-Type: application/json</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">{</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;error&quot;: &quot;Request blocked by WAF&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;reason&quot;: &quot;SQL Injection detected&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;request_id&quot;: &quot;abc123&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500"><path d="M21.801 10A10 10 0 1 1 17 3.335"></path><path d="m9 11 3 3L22 4"></path></svg><div><p class="font-semibold text-sm mb-1 text-green-800 dark:text-green-300">Recommended Rollout Strategy</p><div class="text-sm text-gray-700 dark:text-gray-300">Start with <code>sentinel.ModeLog</code> in production for 1-2 weeks to observe detections and identify any false positives. Review the dashboard, tune rule sensitivities and exclusions, then switch to <code>sentinel.ModeBlock</code> when you are confident in the configuration.</div></div></div></div><h2 id="built-in-rules">Built-in Rules</h2><p>Sentinel ships with eight built-in detection rule categories that cover the most common web attack vectors. Each category has its own set of regex patterns and can be independently configured with a strictness level.</p><h3>Rule Categories</h3><table><thead><tr><th>Category</th><th>Field</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>SQL Injection</td><td><code>SQLInjection</code></td><td><code>RuleStrict</code></td><td>Detects SQL injection attempts including UNION-based, boolean-based, time-based blind, and error-based injection patterns.</td></tr><tr><td>Cross-Site Scripting</td><td><code>XSS</code></td><td><code>RuleStrict</code></td><td>Detects XSS payloads including script tags, event handlers (<code>onerror</code>, <code>onload</code>), <code>javascript:</code> URIs, and encoded variants.</td></tr><tr><td>Path Traversal</td><td><code>PathTraversal</code></td><td><code>RuleStrict</code></td><td>Detects directory traversal sequences (<code>../</code>, <code>..%2f</code>) targeting sensitive system files like <code>/etc/passwd</code> or <code>web.config</code>.</td></tr><tr><td>Command Injection</td><td><code>CommandInjection</code></td><td><code>RuleStrict</code></td><td>Detects OS command injection via shell metacharacters (<code>;</code>, <code>|</code>, <code>&amp;&amp;</code>, backticks) and common commands (<code>cat</code>, <code>wget</code>, <code>curl</code>).</td></tr><tr><td>SSRF</td><td><code>SSRF</code></td><td><code>RuleMedium</code></td><td>Detects server-side request forgery attempts targeting internal networks (<code>127.0.0.1</code>, <code>169.254.169.254</code>, <code>localhost</code>, private IP ranges).</td></tr><tr><td>XXE</td><td><code>XXE</code></td><td><code>RuleStrict</code></td><td>Detects XML external entity injection via <code>DOCTYPE</code> declarations, <code>ENTITY</code> definitions, and <code>SYSTEM</code> identifiers in request bodies.</td></tr><tr><td>LFI</td><td><code>LFI</code></td><td><code>RuleStrict</code></td><td>Detects local file inclusion attempts targeting common sensitive paths (<code>/etc/shadow</code>, <code>/proc/self</code>, <code>php://filter</code>).</td></tr><tr><td>Open Redirect</td><td><code>OpenRedirect</code></td><td><code>RuleMedium</code></td><td>Detects open redirect attempts via URL parameters containing external URLs or protocol-relative URLs (<code>//evil.com</code>).</td></tr></tbody></table><h3>Strictness Levels</h3><p>Each rule category supports three strictness levels that control how aggressively patterns are matched. Higher strictness catches more edge cases but may produce more false positives for certain applications.</p><table><thead><tr><th>Level</th><th>Constant</th><th>Description</th></tr></thead><tbody><tr><td>Off</td><td><code>sentinel.RuleOff</code></td><td>Completely disables this rule category. No patterns are evaluated.</td></tr><tr><td>Basic</td><td><code>sentinel.RuleBasic</code></td><td>Matches only the most obvious and high-confidence attack patterns. Lowest false positive rate.</td></tr><tr><td>Strict</td><td><code>sentinel.RuleStrict</code></td><td>Matches a comprehensive set of patterns including encoded and obfuscated variants. Highest coverage, but may require exclusions for some applications.</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">config.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    Rules</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleSet</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        SQLInjection</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Maximum SQL injection coverage</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">        XSS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Maximum XSS coverage</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">        PathTraversal</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Catch encoded traversal sequences</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">        CommandInjection</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleBasic</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Basic only — reduces false positives for CLI tools</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">        SSRF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">             sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Balanced SSRF detection</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">        XXE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Full XXE protection</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">        LFI</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Full LFI protection</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">        OpenRedirect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleOff</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">     </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Disabled — app handles redirects internally</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300">Disabling Rules</p><div class="text-sm text-gray-700 dark:text-gray-300">Setting a rule category to <code>sentinel.RuleOff</code> completely disables that detection class. Only do this if you are certain your application is not vulnerable to that attack vector, or if you have other defenses in place (e.g., a cloud WAF handling that category).</div></div></div></div><h2 id="custom-rules">Custom Rules</h2><p>In addition to the built-in rules, you can define custom rules to detect application-specific attack patterns. Custom rules are defined as <code>WAFRule</code> structs and are evaluated alongside the built-in rules during request inspection.</p><h3>WAFRule Struct</h3><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>ID</code></td><td><code>string</code></td><td>Unique identifier for the rule. Used in event logs and the dashboard. Must be unique across all custom rules.</td></tr><tr><td><code>Name</code></td><td><code>string</code></td><td>Human-readable name displayed in the dashboard and event details.</td></tr><tr><td><code>Pattern</code></td><td><code>string</code></td><td>Go-compatible regular expression. Compiled once at startup for performance. Use raw strings (<code>`...`</code>) to avoid double-escaping.</td></tr><tr><td><code>AppliesTo</code></td><td><code>[]string</code></td><td>Which parts of the request to inspect. Valid values: <code>&quot;path&quot;</code>, <code>&quot;query&quot;</code>, <code>&quot;headers&quot;</code>, <code>&quot;body&quot;</code>. You can specify multiple.</td></tr><tr><td><code>Severity</code></td><td><code>Severity</code></td><td>Severity level assigned to matches. Options: <code>sentinel.SeverityLow</code>, <code>sentinel.SeverityMedium</code>, <code>sentinel.SeverityHigh</code>, <code>sentinel.SeverityCritical</code>.</td></tr><tr><td><code>Action</code></td><td><code>string</code></td><td>Action to take when the pattern matches: <code>&quot;block&quot;</code> (reject with 403) or <code>&quot;log&quot;</code> (record but allow). This overrides the global WAF mode for this specific rule.</td></tr><tr><td><code>Enabled</code></td><td><code>bool</code></td><td>Whether the rule is active. Set to <code>false</code> to disable a rule without removing it from the configuration.</td></tr></tbody></table><h3>AppliesTo Targets</h3><table><thead><tr><th>Target</th><th>What Is Inspected</th></tr></thead><tbody><tr><td><code>&quot;path&quot;</code></td><td>The URL path (e.g., <code>/api/users/123</code>)</td></tr><tr><td><code>&quot;query&quot;</code></td><td>The raw query string (e.g., <code>id=1&amp;name=test</code>)</td></tr><tr><td><code>&quot;headers&quot;</code></td><td>All HTTP request headers concatenated (key: value pairs)</td></tr><tr><td><code>&quot;body&quot;</code></td><td>The request body (for POST, PUT, PATCH requests)</td></tr></tbody></table><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">config.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">CustomRules</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFRule</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">        ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-wp-admin&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">        Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block WordPress admin probes&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)/(wp-admin|wp-login\.php|xmlrpc\.php|wp-content)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">        AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">        Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">        Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">        ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-sensitive-files&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">        Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block sensitive file access&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">        Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)\.(env|git|bak|sql|log|ini|cfg|conf|swp)$`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">        AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">        Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">        Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain">        ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-scanner-bots&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">        Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block known scanner user agents&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">        Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(sqlmap|nikto|nessus|dirbuster|gobuster|masscan|nmap)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">        AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;headers&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain">        Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain">        Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain">        ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;log-api-key-exposure&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain">        Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Detect API key in query string&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">32</span><span class="token plain">        Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(api[_-]?key|apikey|secret|token|password)=.+`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">33</span><span class="token plain">        AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">34</span><span class="token plain">        Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">35</span><span class="token plain">        Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;log&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">36</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">37</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">38</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Rule Action vs Global Mode</p><div class="text-sm text-gray-700 dark:text-gray-300">Each custom rule has its own <code>Action</code> field that overrides the global WAF mode for that specific rule. This means you can set the WAF to <code>ModeLog</code> globally but have individual custom rules that block, or vice versa. Built-in rules always follow the global mode.</div></div></div></div><h2 id="exclusions">Excluding Routes and IPs</h2><p>You can exclude specific routes and IP addresses from WAF inspection. Excluded routes and IPs bypass the WAF entirely — no patterns are evaluated and no events are generated for these requests.</p><h3>ExcludeRoutes</h3><p>Use <code>ExcludeRoutes</code> to skip WAF inspection for specific URL paths. This is commonly used for health check endpoints, metrics endpoints, or routes that legitimately handle content that might trigger WAF rules (e.g., a CMS editor).</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    ExcludeRoutes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/health&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">           </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Health check endpoint</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/readiness&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Kubernetes readiness probe</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/metrics&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">          </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Prometheus metrics</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/api/v1/webhooks&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Incoming webhooks may contain arbitrary content</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>ExcludeIPs</h3><p>Use <code>ExcludeIPs</code> to skip WAF inspection for trusted IP addresses or CIDR ranges. This is useful for internal services, monitoring systems, or CI/CD pipelines that might trigger false positives.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    ExcludeIPs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;127.0.0.1&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Localhost</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;10.0.0.0/8&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">      </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Internal network</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;172.16.0.0/12&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Docker networks</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;192.168.0.0/16&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Private network</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;203.0.113.50&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Monitoring server</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300">Be Careful with IP Exclusions</p><div class="text-sm text-gray-700 dark:text-gray-300">Excluded IPs bypass all WAF rules including custom rules. Only exclude IPs you fully trust. If an attacker can spoof a trusted IP (e.g., via the <code>X-Forwarded-For</code> header), they could bypass the WAF. Make sure your reverse proxy sets the client IP correctly and that Gin is configured to trust the right proxy headers.</div></div></div></div><h2 id="how-detection-works">How Detection Works</h2><p>Understanding the WAF detection pipeline helps you configure it effectively and debug false positives.</p><h3>Request Inspection Flow</h3><ol><li><strong>Exclusion Check</strong> — The middleware first checks if the request IP or route is in the exclusion lists. If so, the request is passed through without inspection.</li><li><strong>Request Decomposition</strong> — The classifier extracts four components from the request: the URL <strong>path</strong>, the raw <strong>query string</strong>, all HTTP <strong>headers</strong> (concatenated), and the request <strong>body</strong> (if present).</li><li><strong>Pattern Matching</strong> — Each extracted component is evaluated against the compiled regex patterns for all enabled rule categories. The patterns are compiled once at startup for performance. Both built-in rules and custom rules are evaluated.</li><li><strong>Threat Event Creation</strong> — When a pattern matches, a <code>ThreatEvent</code> is created containing the rule ID, category, severity, matched pattern, the request component that matched, and full request metadata (IP, user agent, timestamp).</li><li><strong>Async Pipeline</strong> — The threat event is sent to the async event pipeline via a non-blocking ring buffer. Worker goroutines pick up the event and persist it to storage, update threat actor profiles, recompute security scores, and dispatch alerts if the severity threshold is met.</li><li><strong>Response</strong> — Based on the WAF mode (or the custom rule action), the request is either blocked with a 403 response or allowed to proceed to the next handler.</li></ol><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># The detection flow visualized:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Request ──&gt; Exclusion Check ──&gt; Decompose Request ──&gt; Pattern Matching</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                  │                                         │</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                  │ (excluded)                    ┌─────────┴─────────┐</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                  v                               v                   v</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#              Pass Through                  No Match              Match Found</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                               │                     │</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                               v                     v</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                          Pass Through         Create ThreatEvent</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                                     │</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                          ┌──────────┴──────────┐</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                          v                      v</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                      ModeLog              ModeBlock</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                          │                      │</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                          v                      v</span></div><div class="token-line" style="color:#403f53"><span class="token plain">#                                                   Log + Continue          Log + 403</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Non-Blocking Event Pipeline</p><div class="text-sm text-gray-700 dark:text-gray-300">The WAF detection and event logging are decoupled. Pattern matching happens synchronously in the request path, but event persistence, threat profiling, score computation, and alerting all happen asynchronously via the pipeline. This means the WAF adds minimal latency to your requests even under heavy attack traffic.</div></div></div></div><h2 id="testing">Testing the WAF</h2><p>After enabling the WAF, you should test it to verify that it correctly detects and handles malicious requests. Below are curl commands you can use to test each major attack category.</p><h3>Testing SQL Injection</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Classic SQL injection in query parameter</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/users?id=1&#x27;+OR+&#x27;1&#x27;=&#x27;1&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># UNION-based SQL injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/users?id=1+UNION+SELECT+username,password+FROM+users--&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Boolean-based blind injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/users?id=1+AND+1=1&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># SQL injection in POST body</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v -X POST http://localhost:8080/api/search \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  -d &#x27;{&quot;query&quot;: &quot;test\&quot;; DROP TABLE users; --&quot;}&#x27;</span></div></pre></div></div><h3>Testing XSS</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Script tag injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/search?q=&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Event handler injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/search?q=&lt;img+src=x+onerror=alert(1)&gt;&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># JavaScript URI</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/search?q=javascript:alert(document.cookie)&quot;</span></div></pre></div></div><h3>Testing Path Traversal</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Basic path traversal</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/files/../../../../etc/passwd&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># URL-encoded traversal</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/files/..%2f..%2f..%2fetc%2fpasswd&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Double-encoded traversal</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/files/..%252f..%252f..%252fetc%252fpasswd&quot;</span></div></pre></div></div><h3>Testing Command Injection</h3><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain"># Semicolon injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/ping?host=127.0.0.1;cat+/etc/passwd&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Pipe injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/ping?host=127.0.0.1|whoami&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Backtick injection</span></div><div class="token-line" style="color:#403f53"><span class="token plain">curl -v &quot;http://localhost:8080/api/ping?host=\`whoami\`&quot;</span></div></pre></div></div><h3>Expected Responses</h3><p>The response you receive depends on the WAF mode:</p><h4>ModeBlock Response (403 Forbidden)</h4><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">$ curl -s &quot;http://localhost:8080/api/users?id=1&#x27;+OR+&#x27;1&#x27;=&#x27;1&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain">{</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;error&quot;: &quot;Request blocked by WAF&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;reason&quot;: &quot;SQL Injection detected&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;request_id&quot;: &quot;req_abc123def456&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></pre></div></div><h4>ModeLog Response (200 OK, event logged)</h4><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="token plain">$ curl -s &quot;http://localhost:8080/api/users?id=1&#x27;+OR+&#x27;1&#x27;=&#x27;1&quot; | jq .</span></div><div class="token-line" style="color:#403f53"><span class="token plain">{</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;users&quot;: []</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># The request succeeds, but a WAF event is logged in the dashboard.</span></div><div class="token-line" style="color:#403f53"><span class="token plain"># Check the Sentinel Events page to see the detection.</span></div></pre></div></div><div class="my-4 rounded-lg border p-4 bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-x mt-0.5 flex-shrink-0 text-red-500"><circle cx="12" cy="12" r="10"></circle><path d="m15 9-6 6"></path><path d="m9 9 6 6"></path></svg><div><p class="font-semibold text-sm mb-1 text-red-800 dark:text-red-300">Testing in Production</p><div class="text-sm text-gray-700 dark:text-gray-300">Only run these tests against development or staging environments. Running attack payloads against a production system could trigger alerts, IP bans, or lock out your own IP address if Auth Shield or IP reputation features are also enabled.</div></div></div></div><h2 id="custom-rule-examples">Custom Rule Examples</h2><p>Below are practical custom rule examples for common use cases. These demonstrate the flexibility of the WAF rule engine for application-specific security needs.</p><h3>Block WordPress and CMS Admin Probes</h3><p>Bots constantly scan for common CMS admin panels. If your application is not WordPress, block these immediately to reduce noise.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-cms-probes&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block CMS admin panel probes&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)/(wp-admin|wp-login\.php|wp-content|wp-includes|xmlrpc\.php|administrator|phpmyadmin|adminer|cgi-bin)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Block Sensitive File Extensions</h3><p>Prevent access to backup files, configuration files, and version control artifacts that should never be served by your application.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-sensitive-extensions&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block sensitive file extensions&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)\.(env|git|gitignore|bak|sql|log|ini|cfg|conf|swp|old|orig|dist|save|DS_Store|htaccess|htpasswd)$`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Block Known Scanner User Agents</h3><p>Automated security scanners identify themselves via their User-Agent header. Block known scanner signatures to reduce noise in your security logs.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-scanner-agents&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block known vulnerability scanner agents&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(sqlmap|nikto|nessus|nmap|masscan|dirbuster|gobuster|wfuzz|ffuf|burpsuite|zap|acunetix|qualys|openvas)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;headers&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Detect API Keys in Query Strings</h3><p>API keys should be sent in headers, not query strings (which appear in logs and browser history). This rule logs a warning when credentials appear in URLs.</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;detect-credentials-in-url&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">    Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Detect credentials in query string&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">    Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(api[_-]?key|apikey|secret[_-]?key|access[_-]?token|auth[_-]?token|password|passwd)=[^&amp;]+`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">    AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">    Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">    Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;log&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Log only — don&#x27;t block, just alert</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">    Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span></div></pre></div></div><h3>Full Custom Rules Configuration</h3><p>Here is a complete example combining multiple custom rules with the built-in rule set:</p><div class="group relative my-4 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white dark:bg-[#011627]"><div class="flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"><span class="text-xs font-mono text-gray-500 dark:text-gray-400">main.go</span><span class="text-xs text-gray-400 dark:text-gray-500 uppercase">go</span></div><div class="relative"><button class="absolute right-3 top-3 z-10 p-1.5 rounded-md bg-gray-100/80 dark:bg-gray-800/80 hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy text-gray-500 dark:text-gray-400"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button><pre class="overflow-x-auto p-4 text-[13px] leading-relaxed"><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">1</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Mount</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">nil</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">2</span><span class="token plain">    WAF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFConfig</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">3</span><span class="token plain">        Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">4</span><span class="token plain">        Mode</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ModeBlock</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">5</span><span class="token plain">        Rules</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleSet</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">6</span><span class="token plain">            SQLInjection</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">7</span><span class="token plain">            XSS</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">8</span><span class="token plain">            PathTraversal</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">9</span><span class="token plain">            CommandInjection</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">10</span><span class="token plain">            SSRF</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">             sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">11</span><span class="token plain">            XXE</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">12</span><span class="token plain">            LFI</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">              sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleStrict</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">13</span><span class="token plain">            OpenRedirect</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">     sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">RuleMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">14</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">15</span><span class="token plain">        CustomRules</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain">sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">WAFRule</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">16</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">17</span><span class="token plain">                ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-cms-probes&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">18</span><span class="token plain">                Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block CMS admin panel probes&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">19</span><span class="token plain">                Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)/(wp-admin|wp-login\.php|xmlrpc\.php|phpmyadmin)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">20</span><span class="token plain">                AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">21</span><span class="token plain">                Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">22</span><span class="token plain">                Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">23</span><span class="token plain">                Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">24</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">25</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">26</span><span class="token plain">                ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-sensitive-extensions&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">27</span><span class="token plain">                Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block sensitive file extensions&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">28</span><span class="token plain">                Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)\.(env|git|bak|sql|log|swp)$`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">29</span><span class="token plain">                AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;path&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">30</span><span class="token plain">                Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">31</span><span class="token plain">                Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">32</span><span class="token plain">                Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">33</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">34</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">35</span><span class="token plain">                ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block-scanner-agents&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">36</span><span class="token plain">                Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Block scanner user agents&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">37</span><span class="token plain">                Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(sqlmap|nikto|nessus|dirbuster|gobuster|nmap)`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">38</span><span class="token plain">                AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;headers&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">39</span><span class="token plain">                Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityHigh</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">40</span><span class="token plain">                Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;block&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">41</span><span class="token plain">                Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">42</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">43</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">44</span><span class="token plain">                ID</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">        </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;detect-credentials-in-url&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">45</span><span class="token plain">                Name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">      </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;Detect credentials in query string&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">46</span><span class="token plain">                Pattern</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(72, 118, 214)">`(?i)(api[_-]?key|secret|token|password)=[^&amp;]+`</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">47</span><span class="token plain">                AppliesTo</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;query&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">48</span><span class="token plain">                Severity</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">  sentinel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">SeverityMedium</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">49</span><span class="token plain">                Action</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;log&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">50</span><span class="token plain">                Enabled</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">   </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">51</span><span class="token plain">            </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">52</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">53</span><span class="token plain">        ExcludeRoutes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/health&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/readiness&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;/metrics&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">54</span><span class="token plain">        ExcludeIPs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">:</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token builtin" style="color:rgb(72, 118, 214)">string</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token string" style="color:rgb(72, 118, 214)">&quot;10.0.0.0/8&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&quot;172.16.0.0/12&quot;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">55</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#403f53"><span class="inline-block w-8 text-right mr-4 text-gray-400 dark:text-gray-600 select-none text-xs">56</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span></div></pre></div></div><h2 id="dashboard">WAF Dashboard</h2><p>The Sentinel dashboard includes a dedicated WAF page that provides a visual interface for managing and monitoring the Web Application Firewall.</p><h3>Dashboard Capabilities</h3><ul><li><strong>Rule Management</strong> — View all active built-in and custom rules. Enable or disable individual rules, and adjust strictness levels without restarting the application.</li><li><strong>Live Input Testing</strong> — Test arbitrary input strings against the active rule set directly from the dashboard. The tester shows which rules would match, the severity, and what action would be taken.</li><li><strong>Detection Statistics</strong> — View real-time stats on total detections, detections by category, top blocked IPs, most targeted routes, and detection trends over time.</li><li><strong>Event Log</strong> — Browse all WAF events with filtering by category, severity, IP, time range, and rule ID. Each event shows the full request details and matched pattern.</li><li><strong>Custom Rule Editor</strong> — Create, edit, and test custom rules directly from the dashboard UI without modifying Go code.</li></ul><p>Access the WAF dashboard page at<!-- --> <code>http://localhost:8080/sentinel/ui</code> and navigate to the WAF section.</p><div class="my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div><p class="font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300">Dashboard Rule Changes</p><div class="text-sm text-gray-700 dark:text-gray-300">Rules created or modified via the dashboard are persisted to storage and take effect immediately. They are evaluated alongside rules defined in your Go configuration. If you restart the application, rules from the Go config are always re-applied, while dashboard-created rules are loaded from storage.</div></div></div></div><h2>Next Steps</h2><ul><li><a href="/docs/rate-limiting">Rate Limiting</a> — Layer rate limiting on top of WAF protection</li><li><a href="/docs/auth-shield">Auth Shield</a> — Protect authentication endpoints from brute force attacks</li><li><a href="/docs/anomaly-detection">Anomaly Detection</a> — Add behavioral analysis for advanced threat detection</li><li><a href="/docs/alerting">Alerting</a> — Get notified when the WAF detects high-severity threats</li><li><a href="/docs/the-dashboard">Dashboard</a> — Explore the full security dashboard</li></ul><!--$--><!--/$--></main></div></div><script src="/_next/static/chunks/a339dcc3b98340b3.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[82031,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"ThemeProvider\"]\n3:I[95401,[\"/_next/static/chunks/4cc5a908347f559b.js\"],\"default\"]\n4:I[45121,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n5:I[60512,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n6:I[99113,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ClientSegmentRoot\"]\n7:I[45693,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\"],\"default\"]\n67:I[50025,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"default\"]\n:HL[\"/_next/static/chunks/a68d47cca58670f5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"5Swj18oapgqGqSZX8fol6\",\"c\":[\"\",\"docs\",\"waf\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[\"waf\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/a68d47cca58670f5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/4cc5a908347f559b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"min-h-screen antialiased\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/c23263069b7f7ba3.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"Component\":\"$7\",\"slots\":{\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"serverProvidedParams\":{\"params\":{},\"promises\":[\"$@8\"]}}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"h1\",null,{\"children\":\"Web Application Firewall (WAF)\"}],[\"$\",\"p\",null,{\"children\":[\"Sentinel includes a built-in Web Application Firewall that inspects every incoming HTTP request for malicious payloads. It provides comprehensive coverage for the\",\" \",[\"$\",\"strong\",null,{\"children\":\"OWASP Top 10\"}],\" attack categories, including SQL injection, cross-site scripting (XSS), path traversal, command injection, server-side request forgery (SSRF), XML external entity injection (XXE), local file inclusion (LFI), and open redirect attacks.\"]}],[\"$\",\"p\",null,{\"children\":[\"The WAF operates as Gin middleware registered by \",[\"$\",\"code\",null,{\"children\":\"sentinel.Mount()\"}],\". It runs before your application handlers, so malicious requests are intercepted before they reach your business logic. All detections are recorded as security events and are visible in the Sentinel dashboard.\"]}],[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Zero False Positives by Default\"}],\"$L9\"]}]]}]}],\"$La\",\"$Lb\",\"$Lc\",\"$Ld\",\"$Le\",\"$Lf\",\"$L10\",\"$L11\",\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\",\"$L17\",\"$L18\",\"$L19\",\"$L1a\",\"$L1b\",\"$L1c\",\"$L1d\",\"$L1e\",\"$L1f\",\"$L20\",\"$L21\",\"$L22\",\"$L23\",\"$L24\",\"$L25\",\"$L26\",\"$L27\",\"$L28\",\"$L29\",\"$L2a\",\"$L2b\",\"$L2c\",\"$L2d\",\"$L2e\",\"$L2f\",\"$L30\",\"$L31\",\"$L32\",\"$L33\",\"$L34\",\"$L35\",\"$L36\",\"$L37\",\"$L38\",\"$L39\",\"$L3a\",\"$L3b\",\"$L3c\",\"$L3d\",\"$L3e\",\"$L3f\",\"$L40\",\"$L41\",\"$L42\",\"$L43\",\"$L44\",\"$L45\",\"$L46\",\"$L47\",\"$L48\",\"$L49\",\"$L4a\",\"$L4b\",\"$L4c\",\"$L4d\",\"$L4e\",\"$L4f\",\"$L50\",\"$L51\",\"$L52\",\"$L53\",\"$L54\",\"$L55\",\"$L56\",\"$L57\",\"$L58\",\"$L59\",\"$L5a\",\"$L5b\",\"$L5c\",\"$L5d\",\"$L5e\",\"$L5f\",\"$L60\",\"$L61\",\"$L62\",\"$L63\"],[\"$L64\"],\"$L65\"]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$L66\",false]],\"m\":\"$undefined\",\"G\":[\"$67\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"68:I[99151,[\"/_next/static/chunks/4cc5a908347f559b.js\",\"/_next/static/chunks/c23263069b7f7ba3.js\",\"/_next/static/chunks/2425b678dfc0c3cf.js\"],\"default\"]\n6c:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"OutletBoundary\"]\n6d:\"$Sreact.suspense\"\n6f:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"ViewportBoundary\"]\n71:I[35417,[\"/_next/static/chunks/26ca110782d86623.js\",\"/_next/static/chunks/81f0f13d25d49d65.js\"],\"MetadataBoundary\"]\n9:[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"Sentinel ships with carefully tuned regex patterns at multiple strictness levels. Start with the defaults, observe traffic in \",[\"$\",\"code\",null,{\"children\":\"ModeLog\"}],\", and adjust sensitivity per category as needed for your application.\"]}]\na:[\"$\",\"h2\",null,{\"id\":\"enabling\",\"children\":\"Enabling the WAF\"}]\nb:[\"$\",\"p\",null,{\"children\":[\"The WAF is disabled by default. To enable it, set \",[\"$\",\"code\",null,{\"children\":\"Enabled: true\"}],\" in your\",\" \",[\"$\",\"code\",null,{\"children\":\"WAFConfig\"}],\" and choose a mode. The simplest configuration enables blocking mode with all default rule sensitivities:\"]}]\nc:[\"$\",\"$L68\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"package main\\n\\nimport (\\n    sentinel \\\"github.com/MUKE-coder/sentinel\\\"\\n    \\\"github.com/gin-gonic/gin\\\"\\n)\\n\\nfunc main() {\\n    r := gin.Default()\\n\\n    sentinel.Mount(r, nil, sentinel.Config{\\n        WAF: sentinel.WAFConfig{\\n            Enabled: true,\\n            Mode:    sentinel.ModeBlock,\\n        },\\n    })\\n\\n    r.GET(\\\"/api/data\\\", func(c *gin.Context) {\\n        c.JSON(200, gin.H{\\\"status\\\": \\\"ok\\\"})\\n    })\\n\\n    r.Run(\\\":8080\\\")\\n}\"}]\nd:[\"$\",\"p\",null,{\"children\":\"With this configuration, Sentinel inspects every request against all built-in rule categories at their default strictness levels. Malicious requests receive an HTTP 403 response and are logged as security events.\"}]\ne:[\"$\",\"h2\",null,{\"id\":\"modes\",\"children\":\"WAF Modes\"}]\nf:[\"$\",\"p\",null,{\"children\":\"The WAF supports two primary operating modes. The mode determines what happens when a malicious payload is detected.\"}]\n10:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Mode\"}],[\"$\",\"th\",null,{\"children\":\"Constant\"}],[\"$\",\"th\",null,{\"children\":\"Behavior\"}],[\"$\",\"th\",null,{\"children\":\"Use Case\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Log\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sentinel.ModeLog\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects and records threats but \",[\"$\",\"strong\",null,{\"children\":\"allows the request to proceed\"}],\". The event is logged and visible in the dashboard.\"]}],[\"$\",\"td\",null,{\"children\":\"Initial rollout, testing, auditing\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Block\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sentinel.ModeBlock\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects threats and \",[\"$\",\"strong\",null,{\"children\":\"rejects the request with HTTP 403 Forbidden\"}],\". The response includes a JSON body with the block reason.\"]}],[\"$\",\"td\",null,{\"children\":\"Production enforcement\"}]]}]]}]]}]\n11:[\"$\",\"h3\",null,{\"children\":\"ModeLog (Detect Only)\"}]\n12:[\"$\",\"p\",null,{\"children\":\"In log mode, the WAF identifies malicious payloads and creates security events, but it does not block the request. This is ideal for initial deployment when you want to observe what the WAF detects without impacting real traffic.\"}]\n13:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"WAF: sentinel.WAFConfig{\\n    Enabled: true,\\n    Mode:    sentinel.ModeLog, // Detect and log, but don't block\\n}\"}]\n14:[\"$\",\"p\",null,{\"children\":\"When a threat is detected in log mode, the request continues to your handler normally. The detection is recorded and appears in the dashboard under the Events page with full details including the matched pattern, severity, and request metadata.\"}]\n15:[\"$\",\"h3\",null,{\"children\":\"ModeBlock (Block Malic"])</script><script>self.__next_f.push([1,"ious Requests)\"}]\n16:[\"$\",\"p\",null,{\"children\":\"In block mode, detected threats are rejected immediately with an HTTP 403 status code. The request never reaches your application handler. The response body contains a JSON object describing the block:\"}]\n17:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"WAF: sentinel.WAFConfig{\\n    Enabled: true,\\n    Mode:    sentinel.ModeBlock, // Detect and block with 403\\n}\"}]\n18:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Example blocked response\\nHTTP/1.1 403 Forbidden\\nContent-Type: application/json\\n\\n{\\n  \\\"error\\\": \\\"Request blocked by WAF\\\",\\n  \\\"reason\\\": \\\"SQL Injection detected\\\",\\n  \\\"request_id\\\": \\\"abc123\\\"\\n}\"}]\n19:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-circle-check-big mt-0.5 flex-shrink-0 text-green-500\",\"children\":[[\"$\",\"path\",\"yps3ct\",{\"d\":\"M21.801 10A10 10 0 1 1 17 3.335\"}],[\"$\",\"path\",\"1pflzl\",{\"d\":\"m9 11 3 3L22 4\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-green-800 dark:text-green-300\",\"children\":\"Recommended Rollout Strategy\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"Start with \",[\"$\",\"code\",null,{\"children\":\"sentinel.ModeLog\"}],\" in production for 1-2 weeks to observe detections and identify any false positives. Review the dashboard, tune rule sensitivities and exclusions, then switch to \",[\"$\",\"code\",null,{\"children\":\"sentinel.ModeBlock\"}],\" when you are confident in the configuration.\"]}]]}]]}]}]\n1a:[\"$\",\"h2\",null,{\"id\":\"built-in-rules\",\"children\":\"Built-in Rules\"}]\n1b:[\"$\",\"p\",null,{\"children\":\"Sentinel ships with eight built-in detection rule categories that cover the most common web attack vectors. Each category has its own set of regex patterns and can be independently configured with a strictness level.\"}]\n1c:[\"$\",\"h3\",null,{\"children\":\"Rule Categories\"}]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Category\"}],[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Default\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"SQL Injection\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"SQLInjection\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":\"Detects SQL injection attempts including UNION-based, boolean-based, time-based blind, and error-based injection patterns.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Cross-Site Scripting\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"XSS\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects XSS payloads including script tags, event handlers (\",[\"$\",\"code\",null,{\"children\":\"onerror\"}],\", \",[\"$\",\"code\",null,{\"children\":\"onload\"}],\"), \",[\"$\",\"code\",null,{\"children\":\"javascript:\"}],\" URIs, and encoded variants.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Path Traversal\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"PathTraversal\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects directory traversal sequences (\",[\"$\",\"code\",null,{\"children\":\"../\"}],\", \",[\"$\",\"code\",null,{\"children\":\"..%2f\"}],\") targeting sensitive system files like \",[\"$\",\"code\",null,{\"children\":\"/etc/passwd\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"web.config\"}],\".\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Command Injection\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"CommandInjection\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects OS command injection via shell metacharacters (\",[\"$\",\"code\",null,{\"children\":\";\"}],\", \",[\"$\",\"code\",null,{\"children\":\"|\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\u0026\u0026\"}],\", backticks) and common commands (\",[\"$\",\"code\",null,{\"children\":\"cat\"}],\", \",[\"$\",\"code\",null,{\"children\":\"wget\"}],\", \",[\"$\",\"code\",null,{\"children\":\"curl\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"SSRF\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"SSRF\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleMedium\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects server-side request forgery attempts targeting internal networks (\",[\"$\",\"code\",null,{\"children\":\"127.0.0.1\"}],\", \",[\"$\",\"code\",null,{\"children\":\"169.254.169.254\"}],\", \",[\"$\",\"code\",null,{\"children\":\"localhost\"}],\", private IP ranges).\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"XXE\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"XXE\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects XML external entity injection via \",[\"$\",\"code\",null,{\"children\":\"DOCTYPE\"}],\" declarations, \",[\"$\",\"code\",null,{\"children\":\"ENTITY\"}],\" definitions, and \",[\"$\",\"code\",null,{\"children\":\"SYSTEM\"}],\" identifiers in request bodies.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"LFI\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"LFI\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects local file inclusion attempts targeting common sensitive paths (\",[\"$\",\"code\",null,{\"children\":\"/etc/shadow\"}],\", \",[\"$\",\"code\",null,{\"children\":\"/proc/self\"}],\", \",[\"$\",\"code\",null,{\"children\":\"php://filter\"}],\").\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Open Redirect\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"OpenRedirect\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"RuleMedium\"}]}],[\"$\",\"td\",null,{\"children\":[\"Detects open redirect attempts via URL parameters containing external URLs or protocol-relative URLs (\",[\"$\",\"code\",null,{\"children\":\"//evil.com\"}],\").\"]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"h3\",null,{\"children\":\"Strictness Levels\"}]\n1f:[\"$\",\"p\",null,{\"children\":\"Each rule category supports three strictness levels that control how aggressively patterns are matched. Higher strictness catches more edge cases but may produce more false positives for certain applications.\"}]\n20:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Level\"}],[\"$\",\"th\",null,{\"children\":\"Constant\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Off\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sentinel.RuleOff\"}]}],[\"$\",\"td\",null,{\"children\":\"Completely disables this rule category. No patterns are evaluated.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Basic\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sentinel.RuleBasic\"}]}],[\"$\",\"td\",null,{\"children\":\"Matches only the most obvious and high-confidence attack patterns. Lowest false positive rate.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"Strict\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sentinel.RuleStrict\"}]}],[\"$\",\"td\",null,{\"children\":\"Matches a comprehensive set of patterns including encoded and obfuscated variants. Highest coverage, but may require exclusions for some applications.\"}]]}]]}]]}]\n21:[\"$\",\"$L68\",null,{\"language\":\"go\",\"filename\":\"config.go\",\"code\":\"WAF: sentinel.WAFConfig{\\n    Enabled: true,\\n    Mode:    sentinel.ModeBlock,\\n    Rules: sentinel.RuleSet{\\n        SQLInjection:     sentinel.RuleStrict,  // Maximum SQL injection coverage\\n        XSS:              sentinel.RuleStrict,  // Maximum XSS coverage\\n        PathTraversal:    sentinel.RuleStrict,  // Catch encoded traversal sequences\\n        CommandInjection: sentinel.RuleBasic,   // Basic only — reduces false positives for CLI tools\\n        SSRF:             sentinel.RuleMedium,  // Balanced SSRF detection\\n        XXE:              sentinel.RuleStrict,  // Full XXE protection\\n        LFI:              sentinel.RuleStrict,  // Full LFI protection\\n        OpenRedirect:     sentinel.RuleOff,     // Disabled — app handles redirects internally\\n    },\\n}\"}]\n22:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300\",\"children\":\"Disabling Rules\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"Setting a rule category to \",[\"$\",\"code\",null,{\"children\":\"sentinel.RuleOff\"}],\" completely disables that detection class. Only do this if you are certain your application is not vulnerable to that attack vector, or if you have other defenses in place (e.g., a cloud WAF handling that category).\"]}]]}]]}]}]\n23:[\"$\",\"h2\",null,{\"id\":\"custom-rules\",\"children\":\"Custom Rules\"}]\n24:[\"$\",\"p\",null,{\"children\":[\"In addition to the built-in rules, you can define custom rules to detect application-specific attack patterns. Custom rules are defined as \",[\"$\",\"code\",null,{\"children\":\"WAFRule\"}],\" structs and are evaluated alongside the built-in rules during request inspection.\"]}]\n25:[\"$\",\"h3\",null,{\"children\":\"WAFRule Struct\"}]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Field\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ID\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Unique identifier for the rule. Used in event logs and the dashboard. Must be unique across all custom rules.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Name\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":\"Human-readable name displayed in the dashboard and event details.\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Pattern\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Go-compatible regular expression. Compiled once at startup for performance. Use raw strings (\",[\"$\",\"code\",null,{\"children\":\"`...`\"}],\") to avoid double-escaping.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"AppliesTo\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"[]string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Which parts of the request to inspect. Valid values: \",[\"$\",\"code\",null,{\"children\":\"\\\"path\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\"query\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\"headers\\\"\"}],\", \",[\"$\",\"code\",null,{\"children\":\"\\\"body\\\"\"}],\". You can specify multiple.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Severity\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Severity\"}]}],[\"$\",\"td\",null,{\"children\":[\"Severity level assigned to matches. Options: \",[\"$\",\"code\",null,{\"children\":\"sentinel.SeverityLow\"}],\", \",[\"$\",\"code\",null,{\"children\":\"sentinel.SeverityMedium\"}],\", \",[\"$\",\"code\",null,{\"children\":\"sentinel.SeverityHigh\"}],\", \",[\"$\",\"code\",null,{\"children\":\"sentinel.SeverityCritical\"}],\".\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Action\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"string\"}]}],[\"$\",\"td\",null,{\"children\":[\"Action to take when the pattern matches: \",[\"$\",\"code\",null,{\"children\":\"\\\"block\\\"\"}],\" (reject with 403) or \",[\"$\",\"code\",null,{\"children\":\"\\\"log\\\"\"}],\" (record but allow). This overrides the global WAF mode for this specific rule.\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Enabled\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"bool\"}]}],[\"$\",\"td\",null,{\"children\":[\"Whether the rule is active. Set to \",[\"$\",\"code\",null,{\"children\":\"false\"}],\" to disable a rule without removing it from the configuration.\"]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"27:[\"$\",\"h3\",null,{\"children\":\"AppliesTo Targets\"}]\n28:[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Target\"}],[\"$\",\"th\",null,{\"children\":\"What Is Inspected\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\\"path\\\"\"}]}],[\"$\",\"td\",null,{\"children\":[\"The URL path (e.g., \",[\"$\",\"code\",null,{\"children\":\"/api/users/123\"}],\")\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\\"query\\\"\"}]}],[\"$\",\"td\",null,{\"children\":[\"The raw query string (e.g., \",[\"$\",\"code\",null,{\"children\":\"id=1\u0026name=test\"}],\")\"]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\\"headers\\\"\"}]}],[\"$\",\"td\",null,{\"children\":\"All HTTP request headers concatenated (key: value pairs)\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\\\"body\\\"\"}]}],[\"$\",\"td\",null,{\"children\":\"The request body (for POST, PUT, PATCH requests)\"}]]}]]}]]}]\n69:T508,CustomRules: []sentinel.WAFRule{\n    {\n        ID:        \"block-wp-admin\",\n        Name:      \"Block WordPress admin probes\",\n        Pattern:   `(?i)/(wp-admin|wp-login\\.php|xmlrpc\\.php|wp-content)`,\n        AppliesTo: []string{\"path\"},\n        Severity:  sentinel.SeverityMedium,\n        Action:    \"block\",\n        Enabled:   true,\n    },\n    {\n        ID:        \"block-sensitive-files\",\n        Name:      \"Block sensitive file access\",\n        Pattern:   `(?i)\\.(env|git|bak|sql|log|ini|cfg|conf|swp)$`,\n        AppliesTo: []string{\"path\"},\n        Severity:  sentinel.SeverityHigh,\n        Action:    \"block\",\n        Enabled:   true,\n    },\n    {\n        ID:        \"block-scanner-bots\",\n        Name:      \"Block known scanner user agents\",\n        Pattern:   `(?i)(sqlmap|nikto|nessus|dirbuster|gobuster|masscan|nmap)`,\n        AppliesTo: []string{\"headers\"},\n        Severity:  sentinel.SeverityHigh,\n        Action:    \"block\",\n        Enabled:   true,\n    },\n    {\n        ID:        \"log-api-key-exposure\",\n        Name:      \"Detect API key in query string\",\n        Pattern:   `(?i)(api[_-]?key|apikey|secret|token|password)=.+`,\n        AppliesTo: []string{\"query\"},\n        Severity:  sentinel.SeverityMedium,\n        Action:    \"log\",\n        Enabled:   true,\n    },\n}29:[\"$\",\"$L68\",null,{\"language\":\"go\",\"filename\":\"config.go\",\"code\":\"$69\"}]\n2a:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Rule Action vs Global Mode\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"Each custom rule has its own \",[\"$\",\"code\",null,{\"children\":\"Action\"}],\" field that overrides the global WAF mode for that specific rule. This means you can set the WAF to \",[\"$\",\"code\",null,{\"children\":\"ModeLog\"}],\" globally but have individual custom rules that block, or vice versa. Built-in rules always follow the global mode.\"]}]]}]]}]}]\n2b:[\"$\",\"h2\",null,{\"id\":\"exclusions\",\"children\":\"Excluding Routes and IPs\"}]\n2c:[\"$\",\"p\",null,{\"children\":\"You can exclude specific routes and IP addresses from WAF inspection. Excluded routes and IPs bypass the WAF entirely — no patterns are evaluated and no events are generated for these requests.\"}]\n2d:[\"$\",\"h3\",null,{\"children\":\"ExcludeRoutes\"}]\n2e:[\"$\",\"p\",null,{\"children\":[\"Use \",[\"$\",\"code\",nu"])</script><script>self.__next_f.push([1,"ll,{\"children\":\"ExcludeRoutes\"}],\" to skip WAF inspection for specific URL paths. This is commonly used for health check endpoints, metrics endpoints, or routes that legitimately handle content that might trigger WAF rules (e.g., a CMS editor).\"]}]\n2f:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"WAF: sentinel.WAFConfig{\\n    Enabled: true,\\n    Mode:    sentinel.ModeBlock,\\n    ExcludeRoutes: []string{\\n        \\\"/health\\\",           // Health check endpoint\\n        \\\"/readiness\\\",        // Kubernetes readiness probe\\n        \\\"/metrics\\\",          // Prometheus metrics\\n        \\\"/api/v1/webhooks\\\",  // Incoming webhooks may contain arbitrary content\\n    },\\n}\"}]\n30:[\"$\",\"h3\",null,{\"children\":\"ExcludeIPs\"}]\n31:[\"$\",\"p\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"ExcludeIPs\"}],\" to skip WAF inspection for trusted IP addresses or CIDR ranges. This is useful for internal services, monitoring systems, or CI/CD pipelines that might trigger false positives.\"]}]\n32:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"WAF: sentinel.WAFConfig{\\n    Enabled: true,\\n    Mode:    sentinel.ModeBlock,\\n    ExcludeIPs: []string{\\n        \\\"127.0.0.1\\\",       // Localhost\\n        \\\"10.0.0.0/8\\\",      // Internal network\\n        \\\"172.16.0.0/12\\\",   // Docker networks\\n        \\\"192.168.0.0/16\\\",  // Private network\\n        \\\"203.0.113.50\\\",    // Monitoring server\\n    },\\n}\"}]\n33:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert mt-0.5 flex-shrink-0 text-amber-500\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-amber-800 dark:text-amber-300\",\"children\":\"Be Careful with IP Exclusions\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":[\"Excluded IPs bypass all WAF rules including custom rules. Only exclude IPs you fully trust. If an attacker can spoof a trusted IP (e.g., via the \",[\"$\",\"code\",null,{\"children\":\"X-Forwarded-For\"}],\" header), they could bypass the WAF. Make sure your reverse proxy sets the client IP correctly and that Gin is configured to trust the right proxy headers.\"]}]]}]]}]}]\n34:[\"$\",\"h2\",null,{\"id\":\"how-detection-works\",\"children\":\"How Detection Works\"}]\n35:[\"$\",\"p\",null,{\"children\":\"Understanding the WAF detection pipeline helps you configure it effectively and debug false positives.\"}]\n36:[\"$\",\"h3\",null,{\"children\":\"Request Inspection Flow\"}]\n"])</script><script>self.__next_f.push([1,"37:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Exclusion Check\"}],\" — The middleware first checks if the request IP or route is in the exclusion lists. If so, the request is passed through without inspection.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Request Decomposition\"}],\" — The classifier extracts four components from the request: the URL \",[\"$\",\"strong\",null,{\"children\":\"path\"}],\", the raw \",[\"$\",\"strong\",null,{\"children\":\"query string\"}],\", all HTTP \",[\"$\",\"strong\",null,{\"children\":\"headers\"}],\" (concatenated), and the request \",[\"$\",\"strong\",null,{\"children\":\"body\"}],\" (if present).\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Pattern Matching\"}],\" — Each extracted component is evaluated against the compiled regex patterns for all enabled rule categories. The patterns are compiled once at startup for performance. Both built-in rules and custom rules are evaluated.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Threat Event Creation\"}],\" — When a pattern matches, a \",[\"$\",\"code\",null,{\"children\":\"ThreatEvent\"}],\" is created containing the rule ID, category, severity, matched pattern, the request component that matched, and full request metadata (IP, user agent, timestamp).\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Async Pipeline\"}],\" — The threat event is sent to the async event pipeline via a non-blocking ring buffer. Worker goroutines pick up the event and persist it to storage, update threat actor profiles, recompute security scores, and dispatch alerts if the severity threshold is met.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Response\"}],\" — Based on the WAF mode (or the custom rule action), the request is either blocked with a 403 response or allowed to proceed to the next handler.\"]}]]}]\n"])</script><script>self.__next_f.push([1,"6a:T525,# The detection flow visualized:\n#\n# Request ──\u003e Exclusion Check ──\u003e Decompose Request ──\u003e Pattern Matching\n#                  │                                         │\n#                  │ (excluded)                    ┌─────────┴─────────┐\n#                  v                               v                   v\n#              Pass Through                  No Match              Match Found\n#                                               │                     │\n#                                               v                     v\n#                                          Pass Through         Create ThreatEvent\n#                                                                     │\n#                                                          ┌──────────┴──────────┐\n#                                                          v                      v\n#                                                      ModeLog              ModeBlock\n#                                                          │                      │\n#                                                          v                      v\n#                                                   Log + Continue          Log + 40338:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"$6a\"}]\n39:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Non-Blocking Event Pipeline\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"The WAF detection and event logging are decoupled. Pattern matching happens synchronously in the request path, but event persistence, threat profiling, score computation, and alerting all happen asynchronously via the pipeline. This means the WAF adds minimal latency to your requests even under heavy attack traffic.\"}]]}]]}]}]\n3a:[\"$\",\"h2\",null,{\"id\":\"testing\",\"children\":\"Testing the WAF\"}]\n3b:[\"$\",\"p\",null,{\"children\":\"After enabling the WAF, you should test it to verify that it correctly detects and handles malicious requests. Below are curl commands you can use to test each major attack category.\"}]\n3c:[\"$\",\"h3\",null,{\"children\":\"Testing SQL Injection\"}]\n3d:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Classic SQL injection in query parameter\\ncurl -v \\\"http://localhost:8080/api/users?id=1'+OR+'1'='1\\\"\\n\\n# UNION-based SQL injection\\ncurl -v \\\"http://localhost:8080/api/users?id=1+UNION+SELECT+username,password+FROM+users--\\\"\\n\\n# Boolean-based blind injection\\ncurl -v \\\"http://localhost:8080/api/users?id=1+AND+1=1\\\"\\n\\n# SQL injection in POST body\\ncurl -v -X POST http://localhost:8080/api/search \\\\\\n  -H \\\"Content-Type: application/json\\\" \\\\\\n  -d '{\\\"query\\\": \\\"test\\\\\\\"; DROP TABLE users; --\\\"}'\"}]\n3e:[\"$\",\"h3\",null,{\"children\":\"Testing XSS\"}]\n3f:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Script tag injection\\ncurl -v \\\"http://localhost:8080/api/search?q=\u003cscript\u003ealert('xss')\u003c/script\u003e\\\"\\n\\n# Event handler injection\\ncurl -v \\\"http://localhost:8080/api/search?q=\u003cimg+src=x+onerror=alert(1)\u003e\\\"\\n\\n# JavaScript URI\\ncurl -v \\\"http://localhost:8080/api/search?q=javascript:alert(document.cookie)\\\"\"}]\n40:[\"$\",\"h3\",null,{\"children\":\"Testing Path Traversal\"}]\n41:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":"])</script><script>self.__next_f.push([1,"false,\"code\":\"# Basic path traversal\\ncurl -v \\\"http://localhost:8080/api/files/../../../../etc/passwd\\\"\\n\\n# URL-encoded traversal\\ncurl -v \\\"http://localhost:8080/api/files/..%2f..%2f..%2fetc%2fpasswd\\\"\\n\\n# Double-encoded traversal\\ncurl -v \\\"http://localhost:8080/api/files/..%252f..%252f..%252fetc%252fpasswd\\\"\"}]\n42:[\"$\",\"h3\",null,{\"children\":\"Testing Command Injection\"}]\n43:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"# Semicolon injection\\ncurl -v \\\"http://localhost:8080/api/ping?host=127.0.0.1;cat+/etc/passwd\\\"\\n\\n# Pipe injection\\ncurl -v \\\"http://localhost:8080/api/ping?host=127.0.0.1|whoami\\\"\\n\\n# Backtick injection\\ncurl -v \\\"http://localhost:8080/api/ping?host=\\\\`whoami\\\\`\\\"\"}]\n44:[\"$\",\"h3\",null,{\"children\":\"Expected Responses\"}]\n45:[\"$\",\"p\",null,{\"children\":\"The response you receive depends on the WAF mode:\"}]\n46:[\"$\",\"h4\",null,{\"children\":\"ModeBlock Response (403 Forbidden)\"}]\n47:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"$$ curl -s \\\"http://localhost:8080/api/users?id=1'+OR+'1'='1\\\" | jq .\\n{\\n  \\\"error\\\": \\\"Request blocked by WAF\\\",\\n  \\\"reason\\\": \\\"SQL Injection detected\\\",\\n  \\\"request_id\\\": \\\"req_abc123def456\\\"\\n}\"}]\n48:[\"$\",\"h4\",null,{\"children\":\"ModeLog Response (200 OK, event logged)\"}]\n49:[\"$\",\"$L68\",null,{\"language\":\"bash\",\"showLineNumbers\":false,\"code\":\"$$ curl -s \\\"http://localhost:8080/api/users?id=1'+OR+'1'='1\\\" | jq .\\n{\\n  \\\"users\\\": []\\n}\\n# The request succeeds, but a WAF event is logged in the dashboard.\\n# Check the Sentinel Events page to see the detection.\"}]\n4a:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-circle-x mt-0.5 flex-shrink-0 text-red-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1uzhvr\",{\"d\":\"m15 9-6 6\"}],[\"$\",\"path\",\"z0biqf\",{\"d\":\"m9 9 6 6\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-red-800 dark:text-red-300\",\"children\":\"Testing in Production\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"Only run these tests against development or staging environments. Running attack payloads against a production system could trigger alerts, IP bans, or lock out your own IP address if Auth Shield or IP reputation features are also enabled.\"}]]}]]}]}]\n4b:[\"$\",\"h2\",null,{\"id\":\"custom-rule-examples\",\"children\":\"Custom Rule Examples\"}]\n4c:[\"$\",\"p\",null,{\"children\":\"Below are practical custom rule examples for common use cases. These demonstrate the flexibility of the WAF rule engine for application-specific security needs.\"}]\n4d:[\"$\",\"h3\",null,{\"children\":\"Block WordPress and CMS Admin Probes\"}]\n4e:[\"$\",\"p\",null,{\"children\":\"Bots constantly scan for common CMS admin panels. If your application is not WordPress, block these immediately to reduce noise.\"}]\n4f:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"{\\n    ID:        \\\"block-cms-probes\\\",\\n    Name:      \\\"Block CMS admin panel probes\\\",\\n    Pattern:   `(?i)/(wp-admin|wp-login\\\\.php|wp-content|wp-includes|xmlrpc\\\\.php|administrator|phpmyadmin|adminer|cgi-bin)`,\\n    AppliesTo: []string{\\\"path\\\"},\\n    Severity:  sentinel.SeverityMedium,\\n    Action:    \\\"block\\\",\\n    Enabled:   true,\\n}\"}]\n50:[\"$\",\"h3\",null,{\"children\":\"Block Sensitive File Extensions\"}]\n51:[\"$\",\"p\",null,{\"children\":\"Prevent access to backup files, configuration files, and version control artifacts that should never be served by your application.\"}]\n52:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"{\\n    ID:        \\\"block-sensitive-extensions\\\",\\n    Name:      \\\"Block sensitive file extensions\\\",\\n    Pattern:   `(?i)\\\\.(env|git|gitignore|bak|sql|log|ini|cfg|conf|swp|old|orig|dist|save|DS_Store|h"])</script><script>self.__next_f.push([1,"taccess|htpasswd)$`,\\n    AppliesTo: []string{\\\"path\\\"},\\n    Severity:  sentinel.SeverityHigh,\\n    Action:    \\\"block\\\",\\n    Enabled:   true,\\n}\"}]\n53:[\"$\",\"h3\",null,{\"children\":\"Block Known Scanner User Agents\"}]\n54:[\"$\",\"p\",null,{\"children\":\"Automated security scanners identify themselves via their User-Agent header. Block known scanner signatures to reduce noise in your security logs.\"}]\n55:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"{\\n    ID:        \\\"block-scanner-agents\\\",\\n    Name:      \\\"Block known vulnerability scanner agents\\\",\\n    Pattern:   `(?i)(sqlmap|nikto|nessus|nmap|masscan|dirbuster|gobuster|wfuzz|ffuf|burpsuite|zap|acunetix|qualys|openvas)`,\\n    AppliesTo: []string{\\\"headers\\\"},\\n    Severity:  sentinel.SeverityHigh,\\n    Action:    \\\"block\\\",\\n    Enabled:   true,\\n}\"}]\n56:[\"$\",\"h3\",null,{\"children\":\"Detect API Keys in Query Strings\"}]\n57:[\"$\",\"p\",null,{\"children\":\"API keys should be sent in headers, not query strings (which appear in logs and browser history). This rule logs a warning when credentials appear in URLs.\"}]\n58:[\"$\",\"$L68\",null,{\"language\":\"go\",\"code\":\"{\\n    ID:        \\\"detect-credentials-in-url\\\",\\n    Name:      \\\"Detect credentials in query string\\\",\\n    Pattern:   `(?i)(api[_-]?key|apikey|secret[_-]?key|access[_-]?token|auth[_-]?token|password|passwd)=[^\u0026]+`,\\n    AppliesTo: []string{\\\"query\\\"},\\n    Severity:  sentinel.SeverityMedium,\\n    Action:    \\\"log\\\",  // Log only — don't block, just alert\\n    Enabled:   true,\\n}\"}]\n59:[\"$\",\"h3\",null,{\"children\":\"Full Custom Rules Configuration\"}]\n5a:[\"$\",\"p\",null,{\"children\":\"Here is a complete example combining multiple custom rules with the built-in rule set:\"}]\n6b:T905,"])</script><script>self.__next_f.push([1,"sentinel.Mount(r, nil, sentinel.Config{\n    WAF: sentinel.WAFConfig{\n        Enabled: true,\n        Mode:    sentinel.ModeBlock,\n        Rules: sentinel.RuleSet{\n            SQLInjection:     sentinel.RuleStrict,\n            XSS:              sentinel.RuleStrict,\n            PathTraversal:    sentinel.RuleStrict,\n            CommandInjection: sentinel.RuleStrict,\n            SSRF:             sentinel.RuleMedium,\n            XXE:              sentinel.RuleStrict,\n            LFI:              sentinel.RuleStrict,\n            OpenRedirect:     sentinel.RuleMedium,\n        },\n        CustomRules: []sentinel.WAFRule{\n            {\n                ID:        \"block-cms-probes\",\n                Name:      \"Block CMS admin panel probes\",\n                Pattern:   `(?i)/(wp-admin|wp-login\\.php|xmlrpc\\.php|phpmyadmin)`,\n                AppliesTo: []string{\"path\"},\n                Severity:  sentinel.SeverityMedium,\n                Action:    \"block\",\n                Enabled:   true,\n            },\n            {\n                ID:        \"block-sensitive-extensions\",\n                Name:      \"Block sensitive file extensions\",\n                Pattern:   `(?i)\\.(env|git|bak|sql|log|swp)$`,\n                AppliesTo: []string{\"path\"},\n                Severity:  sentinel.SeverityHigh,\n                Action:    \"block\",\n                Enabled:   true,\n            },\n            {\n                ID:        \"block-scanner-agents\",\n                Name:      \"Block scanner user agents\",\n                Pattern:   `(?i)(sqlmap|nikto|nessus|dirbuster|gobuster|nmap)`,\n                AppliesTo: []string{\"headers\"},\n                Severity:  sentinel.SeverityHigh,\n                Action:    \"block\",\n                Enabled:   true,\n            },\n            {\n                ID:        \"detect-credentials-in-url\",\n                Name:      \"Detect credentials in query string\",\n                Pattern:   `(?i)(api[_-]?key|secret|token|password)=[^\u0026]+`,\n                AppliesTo: []string{\"query\"},\n                Severity:  sentinel.SeverityMedium,\n                Action:    \"log\",\n                Enabled:   true,\n            },\n        },\n        ExcludeRoutes: []string{\"/health\", \"/readiness\", \"/metrics\"},\n        ExcludeIPs:    []string{\"10.0.0.0/8\", \"172.16.0.0/12\"},\n    },\n})"])</script><script>self.__next_f.push([1,"5b:[\"$\",\"$L68\",null,{\"language\":\"go\",\"filename\":\"main.go\",\"code\":\"$6b\"}]\n5c:[\"$\",\"h2\",null,{\"id\":\"dashboard\",\"children\":\"WAF Dashboard\"}]\n5d:[\"$\",\"p\",null,{\"children\":\"The Sentinel dashboard includes a dedicated WAF page that provides a visual interface for managing and monitoring the Web Application Firewall.\"}]\n5e:[\"$\",\"h3\",null,{\"children\":\"Dashboard Capabilities\"}]\n5f:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Rule Management\"}],\" — View all active built-in and custom rules. Enable or disable individual rules, and adjust strictness levels without restarting the application.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Live Input Testing\"}],\" — Test arbitrary input strings against the active rule set directly from the dashboard. The tester shows which rules would match, the severity, and what action would be taken.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Detection Statistics\"}],\" — View real-time stats on total detections, detections by category, top blocked IPs, most targeted routes, and detection trends over time.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Event Log\"}],\" — Browse all WAF events with filtering by category, severity, IP, time range, and rule ID. Each event shows the full request details and matched pattern.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Custom Rule Editor\"}],\" — Create, edit, and test custom rules directly from the dashboard UI without modifying Go code.\"]}]]}]\n60:[\"$\",\"p\",null,{\"children\":[\"Access the WAF dashboard page at\",\" \",[\"$\",\"code\",null,{\"children\":\"http://localhost:8080/sentinel/ui\"}],\" and navigate to the WAF section.\"]}]\n61:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border p-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-start gap-3\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info mt-0.5 flex-shrink-0 text-blue-500\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"font-semibold text-sm mb-1 text-blue-800 dark:text-blue-300\",\"children\":\"Dashboard Rule Changes\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-700 dark:text-gray-300\",\"children\":\"Rules created or modified via the dashboard are persisted to storage and take effect immediately. They are evaluated alongside rules defined in your Go configuration. If you restart the application, rules from the Go config are always re-applied, while dashboard-created rules are loaded from storage.\"}]]}]]}]}]\n62:[\"$\",\"h2\",null,{\"children\":\"Next Steps\"}]\n63:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/rate-limiting\",\"children\":\"Rate Limiting\"}],\" — Layer rate limiting on top of WAF protection\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/auth-shield\",\"children\":\"Auth Shield\"}],\" — Protect authentication endpoints from brute force attacks\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/anomaly-detection\",\"children\":\"Anomaly Detection\"}],\" — Add behavioral analysis for advanced threat detection\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/alerting\",\"children\":\"Alerting\"}],\" — Get notified when the WAF detects high-severity threats\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"/docs/the-dashboard\",\"children\":\"Dashboard\"}],\" — Explore the full security dashboard\"]}]]}]\n64:[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/2425b678dfc0c3cf.js\",\"async\":true,\"nonce\":\"$undefined\"}]\n65:[\"$\",\"$L6c\",null,{\"children\":[\"$\",\"$6d\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@6e\"}]}]\n66:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L6f\",null,{\"children\":\"$"])</script><script>self.__next_f.push([1,"L70\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L71\",null,{\"children\":[\"$\",\"$6d\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L72\"}]}]}],null]}]\n8:\"$0:f:0:1:1:children:0:props:children:1:props:serverProvidedParams:params\"\n"])</script><script>self.__next_f.push([1,"70:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"6e:null\n72:[[\"$\",\"title\",\"0\",{\"children\":\"WAF - Sentinel Docs\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Production-grade security middleware for Go/Gin applications. WAF, rate limiting, threat detection, AI analysis, and an embedded dashboard.\"}]]\n"])</script></body></html>